(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1542:function(e,t,i){Promise.resolve().then(i.bind(i,6147))},2959:function(e,t,i){"use strict";var l=i(1398);t.Z={postLogin:e=>l.W.post("login",e),getSelfInfo:()=>l.W.get("users/self-info"),getServiceTypes:e=>{let{page:t,size:i,name:n}=e;return l.W.get("service-types?page=".concat(t,"&size=").concat(i),{params:{name:n}})},getBookingTimes:e=>{let{page:t,size:i}=e;return l.W.get("reservation-times?page=".concat(t,"&size=").concat(i))},createBookingTime:e=>{let{time:t,reservation_count:i}=e;return l.W.post("reservation-times",{time:t,reservation_count:i})},updateBookingTime:e=>{let{id:t,time:i,reservation_count:n}=e;return l.W.put("reservation-times/".concat(t),{time:i,reservation_count:n})},updateExpense:e=>{let{id:t,name:i,description:n,amount:s}=e;return l.W.put("expenses/".concat(t),{name:i,description:n,amount:s})},deleteBookingTime:e=>l.W.delete("reservation-times/".concat(e)),deleteExpense:e=>l.W.delete("expenses/".concat(e)),deleteUser:e=>l.W.delete("users/".concat(e)),createUser:e=>l.W.post("users",e),updateUser:e=>{let{name:t,surname:i,email:n,roleId:s,password:r,password_repeat:a,id:o,customer_visible:d,day_off:c}=e;return l.W.put("users/".concat(o),{name:t,surname:i,email:n,role_id:s,password:r,password_repeat:a,customer_visible:d,day_off:c})},updateServiceType:e=>{let{id:t,name:i,price:n,customer_visible:s}=e;return l.W.put("service-types/".concat(t),{name:i,price:n,customer_visible:s})},createServiceType:e=>{let{name:t,price:i,customer_visible:n}=e;return l.W.post("service-types",{name:t,price:i,customer_visible:n})},createExpense:e=>{let{name:t,description:i,amount:n}=e;return l.W.post("expenses",{name:t,description:i,amount:n})},deleteServiceType:e=>l.W.delete("service-types/".concat(e)),getUsers:e=>{let{page:t,size:i}=e;return l.W.get("users?page=".concat(t,"&size=").concat(i))},getBookings:e=>{let{page:t,size:i,status:n,from_date:s,to_date:r,client_name:a,client_phone:o,service_types:d,doctor_id:c}=e;return l.W.get("reservations?&sort=asc&sorted_column=date_time",{params:{status:n,from_date:s,to_date:r,client_name:a,client_phone:o,service_types:d,doctor_id:c}})},getServices:e=>{let{page:t,size:i,status:n,from_date:s,to_date:r,client_name:a,client_phone:o,service_types:d,user_id:c}=e;return l.W.get("services?page=".concat(t,"&size=").concat(i,"&sort=desc"),{params:{status:n,from_date:s,to_date:r,client_name:a,client_phone:o,service_types:d,user_id:c}})},getExpenses:e=>{let{page:t,size:i,from_date:n,to_date:s}=e;return l.W.get("expenses?page=".concat(t,"&size=").concat(i,"&sort=desc"),{params:{from_date:n,to_date:s}})},getExpensesTotal:e=>{let{from_date:t,to_date:i}=e;return l.W.get("expenses/total-amount",{params:{from_date:t,to_date:i}})},getReports:e=>{let{page:t,size:i,from_date:n,to_date:s,client_name:r,client_phone:a,user_id:o}=e;return l.W.get("reports?sort=desc",{params:{from_date:n,to_date:s,client_name:r,client_phone:a,user_id:o}})},getAdvances:e=>{let{page:t,size:i,from_date:n,to_date:s}=e;return l.W.get("advance-transfer?page=".concat(t,"&size=").concat(i,"&sort=desc"),{params:{from_date:n,to_date:s}})},getLogs:e=>{let{from_date:t,to_date:i,page:n}=e;return l.W.get("logs?page=".concat(n,"&size=",10),{params:{from_date:t,to_date:i}})},deleteService:e=>l.W.delete("services/".concat(e)),advanceTransfer:()=>l.W.post("reservations/advance/next-day-transfer"),advanceCancel:e=>l.W.post("reservations/advance/next-day-transfer/cancel",{date:e}),deleteBooking:e=>l.W.delete("reservations/".concat(e)),getBookingDoctors:e=>l.W.get("reservations/users/input-search?date_time=".concat(e)),getAdvanceInfo:e=>l.W.get("services/advance/info?date=".concat(e)),getTotalAmount:e=>{let{status:t,from_date:i,to_date:n,client_name:s,client_phone:r,service_types:a,user_id:o}=e;return l.W.get("services/total-amounts",{params:{status:t,from_date:i,to_date:n,client_name:s,client_phone:r,service_types:a,user_id:o}})},getDoctors:()=>l.W.get("users/input-search"),getDoctorById:e=>l.W.get("users/".concat(e)),getHours:e=>l.W.get("reservation-times/input-search?date=".concat(e)),getInputServices:()=>l.W.get("service-types/input-search"),createService:e=>l.W.post("services",e),createBooking:e=>l.W.post("reservations",e),updateService:e=>l.W.put("services/".concat(e.id),e),updateBooking:e=>l.W.put("reservations/".concat(e.id),e),getDailyReportExcel:async e=>{try{await l.W.get("services/daily-report?excel_export=true&sorted_day=".concat(e),{responseType:"blob"}).then(t=>{{let i=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(i),n=document.createElement("a");n.href=l,n.setAttribute("download","daily_report_".concat(e,".xlsx")),document.body.appendChild(n),n.click(),document.body.removeChild(n)}})}catch(e){console.error("Error downloading the file",e)}},getAllReportsExcel:async e=>{let{status:t,from_date:i,to_date:n,client_name:s,client_phone:r,service_types:a,user_id:o}=e;try{await l.W.get("services/all-reports?excel_export=true&sort=desc",{responseType:"blob",params:{status:t,from_date:i,to_date:n,client_name:s,client_phone:r,service_types:a,user_id:o}}).then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(t),s=document.createElement("a");s.href=l,s.setAttribute("download","general_report_".concat(i,"/").concat(n,".xlsx")),document.body.appendChild(s),s.click(),document.body.removeChild(s)})}catch(e){console.error("Error downloading the file",e)}},getBonuses:e=>{let{from_date:t,to_date:i,user_id:n}=e;return l.W.get("services/bonus-reports",{params:{from_date:t,to_date:i,user_id:n}})},patchBonusCoefficient:e=>l.W.patch("settings/bonus-coefficient",{coefficient:e}),getBonusesCoefficient:()=>l.W.get("settings/bonus-coefficient"),getTimeZone:()=>l.W.get("settings/timezone-date"),getBonusesExcel:async e=>{let{from_date:t,to_date:i,user_id:n}=e;try{await l.W.get("services/bonus-reports?excel_export=true",{responseType:"blob",params:{from_date:t,to_date:i,user_id:n}}).then(e=>{let l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(l),s=document.createElement("a");s.href=n,s.setAttribute("download","bonus_report_".concat(t,"/").concat(i,".xlsx")),document.body.appendChild(s),s.click(),document.body.removeChild(s)})}catch(e){console.error("Error downloading the file",e)}}}},6147:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return ev}});var l=i(7437),n=i(2265),s=i(2102),r=i(2160),a=i(8708),o=i(5012),d=i(6463),c=i(2502),u=i(2959),v=i(8787),m=i(2193),x=i(5472),p=function(e){let{userDeleteDialog:t,setUserDeleteDialog:i,user:s,showSuccess:r,setUsers:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>i(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{o(e=>e.filter(e=>e.id!==(null==s?void 0:s.id)));try{u.Z.deleteUser(null==s?void 0:s.id),i(!1),r("Service type has been successfully deleted")}catch(e){console.error(e)}}})]});return(0,l.jsx)(x.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>i(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),s&&(0,l.jsxs)("span",{children:["Are you sure you want to delete"," ",(0,l.jsxs)("b",{children:[null==s?void 0:s.name," ",null==s?void 0:s.surname]}),"?"]})]})})},h=i(8861),y=i(9343),f=i(4245),j=i(7753),g=i(5313),w=i(6498),_=i(7039),b=i(2163);let S=[{id:2,name:"Admin"},{id:3,name:"Cashier"},{id:4,name:"Doctor"},{id:5,name:"Reserver"}],C=[{id:0,name:"New"},{id:1,name:"Accepted"},,{id:2,name:"Rejected"}],k=[{id:0,name:"Ləğv"},{id:1,name:"Gəldi"},{id:2,name:"G\xf6zlənilir"},{id:3,name:"Qəbul edildi"},{id:4,name:"Online"}],B=[{id:1,name:"Bazar ertəsi"},{id:2,name:"İkinci g\xfcn"},{id:3,name:"\xc7ərşənbə"},{id:4,name:"C\xfcmə axşamı"},{id:5,name:"C\xfcmə"},{id:6,name:"Şənbə"},{id:7,name:"Bazar"}];var Z=function(e){let{user:t,userEditDialog:i,setUserEditDialog:s,setUsers:r,showSuccess:o}=e,d=f.Ry().shape({name:f.Z_().required(),surname:f.Z_().required(),email:f.Z_().email("Invalid email").required(),roleId:f.Rx().required(),password:(null==t?void 0:t.id)?f.Z_():f.Z_().required(),password_repeat:f.Z_().oneOf([f.iH("password")],"Passwords must match"),customer_visible:f.O7(),day_off:f.Rx()}),{control:c,handleSubmit:v,formState:{errors:m},setValue:p,reset:C}=(0,y.cI)({resolver:(0,j.X)(d),defaultValues:{name:void 0,surname:void 0,email:void 0,roleId:void 0,password:(null==t?void 0:t.id)?void 0:"",password_repeat:(null==t?void 0:t.id)?void 0:"",customer_visible:!1,day_off:void 0}}),[k,Z]=(0,n.useState)(void 0),[F,R]=(0,n.useState)(void 0),D=async e=>{try{let{data:i}=(null==t?void 0:t.id)?await u.Z.updateUser({...e,id:t.id}):await u.Z.createUser(e);r(e=>[i,...e]),o("User has been successfully ".concat((null==t?void 0:t.id)?"created":"updated")),s(!1)}catch(e){console.error(e)}};return(0,n.useEffect)(()=>{if(null==t?void 0:t.id){var e,i;p("name",t.name),p("surname",t.surname),p("email",t.email),p("roleId",null===(e=t.role)||void 0===e?void 0:e.id),p("customer_visible",null!==(i=t.customer_visible)&&void 0!==i&&i),p("day_off",t.day_off),Z(S.find(e=>{var i;return e.id===(null===(i=t.role)||void 0===i?void 0:i.id)})),R(B.find(e=>e.id===t.day_off))}},[t,p]),(0,l.jsx)(x.V,{visible:i,style:{width:"328px"},header:"İstifadə\xe7i məlumatları",modal:!0,onHide:()=>{s(!1),C(),Z(void 0),R(void 0)},children:t&&(0,l.jsxs)("form",{onSubmit:v(D),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,l.jsx)(y.Qr,{name:"name",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"name",invalid:!!m.name,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Soyad:"}),(0,l.jsx)(y.Qr,{name:"surname",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"surname",invalid:!!m.surname,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Email:"}),(0,l.jsx)(y.Qr,{name:"email",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"email",invalid:!!m.email,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Rol:"}),(0,l.jsx)(y.Qr,{name:"roleId",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{style:{marginBottom:"10px"},value:k,onChange:e=>{Z(e.value),p("roleId",e.value.id)},options:S,optionLabel:"name",placeholder:"Rol se\xe7in",className:"w-full md:w-14rem",invalid:!!m.roleId})}}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,l.jsx)(y.Qr,{name:"customer_visible",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(b.X,{inputId:"customer_visible",checked:!!t.value,onChange:e=>t.onChange(e.checked)})}}),(0,l.jsx)("label",{style:{marginLeft:"8px"},htmlFor:"customer_visible",children:"G\xf6stərilmə"})]}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"day_off",children:"İstirahət g\xfcn\xfc:"}),(0,l.jsx)(y.Qr,{name:"day_off",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{style:{marginBottom:"10px"},value:F,onChange:e=>{var t;R(e.value),p("day_off",null===(t=e.value)||void 0===t?void 0:t.id)},options:B,optionLabel:"name",placeholder:"İstirahət g\xfcn\xfc se\xe7in",className:"w-full md:w-14rem",showClear:!0})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"password",children:"Şifrə:"}),(0,l.jsx)(y.Qr,{name:"password",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(w.r,{style:{marginBottom:"10px",width:"200px"},id:"password",toggleMask:!0,feedback:!1,invalid:!!m.password,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"password_repeat",children:"Şifrənin təstiqi:"}),(0,l.jsx)(y.Qr,{name:"password_repeat",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(w.r,{style:{marginBottom:"10px",width:"200px"},toggleMask:!0,feedback:!1,id:"password_repeat",invalid:!!m.password_repeat,...t})}}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)("div",{children:m.password_repeat&&(0,l.jsx)(g.v,{style:{maxWidth:"180px",height:"45px"},severity:"error",text:"Şifrələr eyni deyil"})}),(0,l.jsx)(a.z,{label:"Save",type:"submit",style:{display:"flex"}})]})]})})},F=i(5565);let R=e=>{var t;return null===(t=S.find(t=>t.id===e))||void 0===t?void 0:t.name},D=e=>{let t=null==e?void 0:e.getFullYear(),i=String((null==e?void 0:e.getMonth())+1).padStart(2,"0"),l=String(null==e?void 0:e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(i,"-").concat(l)},N=e=>{for(let t of["service.filter.status","service.filter.date","service.filter.client_name","service.filter.client_phone","service.filter.service_type","service.filter.doctor","reservation.filter.status","reservation.filter.date","reservation.filter.client_name","reservation.filter.client_phone","reservation.filter.service_type","reservation.filter.doctor"])if(e.includes(t))return!0;return!1};var z=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)([]),[r,o]=(0,n.useState)(0),[d,x]=(0,n.useState)({}),[h,y]=(0,n.useState)(!1),[f,j]=(0,n.useState)(!1),[g,w]=(0,n.useState)(0),[_,S]=(0,n.useState)(10),[C,k]=(0,n.useState)(1),D=(0,n.useRef)(null),N=e=>{var t;null===(t=D.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},z=e=>{x(e),y(!0)},A=e=>{x(e),j(!0)},E=async e=>{try{let{data:t,meta:i}=await u.Z.getUsers({page:e,size:_});s(t),w(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{E(C)},[]);let T=(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(null==t?void 0:t.includes("user.create"))&&(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>y(!0)})});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.w,{value:i,editMode:"row",dataKey:"id",header:T,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},children:[(0,l.jsx)(v.s,{field:"name",header:"Ad",style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"surname",header:"Soyad",style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"email",header:"Mail",style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"role",body:e=>(0,l.jsx)("div",{children:R(e.role.id)}),header:"Rol",style:{width:"15%"}}),(0,l.jsx)(v.s,{field:"customer_visible",header:"G\xf6stərilmə",body:e=>(0,l.jsx)(b.X,{checked:!!e.customer_visible,disabled:!0}),style:{width:"10%"}}),(0,l.jsx)(v.s,{field:"day_off",header:"İstirahət g\xfcn\xfc",body:e=>{let t=B.find(t=>t.id===e.day_off);return(0,l.jsx)("div",{children:(null==t?void 0:t.name)||"-"})},style:{width:"10%"}}),(0,l.jsx)(v.s,{body:e=>(0,l.jsxs)(n.Fragment,{children:[(null==t?void 0:t.includes("user.update"))&&(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>z(e)}),(null==t?void 0:t.includes("user.delete"))&&(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>A(e)})]}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)(F.D,{first:r,rows:_,totalRecords:g,onPageChange:e=>{E(e.page+1),k(e.page+1),o(e.first)}}),(0,l.jsx)(c.F,{ref:D}),(0,l.jsx)(p,{user:d,userDeleteDialog:f,setUserDeleteDialog:j,setUsers:s,showSuccess:N}),(0,l.jsx)(Z,{user:d,setUsers:s,userEditDialog:h,setUserEditDialog:y,showSuccess:N})]})},A=i(8518),E=i.n(A),T=i(891),I=function(e){let{dialog:t,setDialog:i,showSuccess:n,setServicesTypes:s}=e,{control:r,handleSubmit:o,formState:{errors:d},reset:c}=(0,y.cI)(),v=async e=>{let{name:t,price:l,customer_visible:r}=e;l=l||0;try{let{data:e}=await u.Z.createServiceType({name:t,price:l,customer_visible:r});s(t=>[...t,e]),n("Service type has been successfully created"),i(!1),c()}catch(e){console.error(e)}};return(0,l.jsx)(x.V,{visible:t,style:{width:"25rem"},header:"Xidmət n\xf6v\xfc",modal:!0,onHide:()=>i(!1),children:(0,l.jsxs)("form",{onSubmit:o(v),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,l.jsx)(y.Qr,{name:"name",control:r,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"name",invalid:!!(null==d?void 0:d.name),...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Qiymət:"}),(0,l.jsx)(y.Qr,{name:"price",control:r,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px"},invalid:!!d.price})}}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[(0,l.jsx)(y.Qr,{name:"customer_visible",control:r,defaultValue:!0,render:e=>{let{field:t}=e;return(0,l.jsx)(b.X,{inputId:"customer_visible",checked:t.value,onChange:e=>t.onChange(e.checked)})}}),(0,l.jsx)("label",{htmlFor:"customer_visible",style:{marginLeft:"8px",cursor:"pointer"},children:"M\xfcştəri \xfc\xe7\xfcn g\xf6r\xfcnən"})]}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",type:"submit"})})]})})},W=function(e){let{serviceType:t,deleteDialog:i,setDeleteDialog:s,setServicesTypes:r,showSuccess:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>s(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{r(e=>e.filter(e=>e.id!==(null==t?void 0:t.id)));try{u.Z.deleteServiceType(null==t?void 0:t.id),s(!1),o("Service type has been successfully deleted")}catch(e){console.error(e)}}})]});return(0,l.jsx)(x.V,{visible:i,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>s(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),t&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==t?void 0:t.name}),"?"]})]})})},O=i(1857),M=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)(),[r,o]=(0,n.useState)(!1),[d,x]=(0,n.useState)([]),[p,y]=(0,n.useState)(0),[f,j]=(0,n.useState)(10),[g,w]=(0,n.useState)(!1),_=(0,n.useRef)(null),[S,C]=(0,n.useState)(0),[k,B]=(0,n.useState)(!1),[Z,R,D]=(0,O.Nr)("",400),N=e=>{var t;null===(t=_.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},z=e=>(0,l.jsx)(T.R,{value:e.value,onValueChange:t=>e.editorCallback(t.value),mode:"currency",currency:"AZN",locale:"de-DE"}),A=e=>(console.log(e,"options"),(0,l.jsx)(b.X,{checked:!!e.value,onChange:t=>e.editorCallback(t.checked)})),E=e=>(0,l.jsx)(h.o,{type:"text",value:e.value,onChange:t=>e.editorCallback(t.target.value)}),M=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:i}=await u.Z.getServiceTypes({page:e,size:f,name:R||void 0});x(t),y(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{M()},[R]);let L=e=>{s(e),o(!0)},Q=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>B(e=>!e)}),(null==t?void 0:t.includes("service_type.create"))&&(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>w(!0)})]});return(0,l.jsxs)("div",{children:[(0,l.jsxs)(m.w,{value:d,editMode:"row",dataKey:"id",onRowEditComplete:e=>{let{newData:t}=e,{id:i,name:l,price:n,customer_visible:s}=t;console.log(t,"newData"),console.log(s,"customer_visible"),n=n||0;try{u.Z.updateServiceType({id:i,name:l,price:n,customer_visible:s});let e={...t,name:l,price:n,id:i,customer_visible:s},r=d.map(t=>t.id===e.id?e:t);x(r),N("Service type has been successfully updated")}catch(e){console.error(e)}},tableStyle:{minWidth:"50rem"},header:Q,style:{marginBottom:"10px"},filterDisplay:k?"row":void 0,children:[(0,l.jsx)(v.s,{field:"name",header:"Ad",editor:e=>E(e),style:{width:"40%"},filter:!0,filterElement:()=>(0,l.jsx)(h.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:Z,onChange:e=>D(e.target.value)}),showFilterMenu:!1}),(0,l.jsx)(v.s,{field:"price",header:"Qiymət",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.price),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",s=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(s," ").concat(n)},editor:e=>z(e),style:{width:"40%"}}),(0,l.jsx)(v.s,{field:"customer_visible",header:"G\xf6stərilmə",body:e=>(0,l.jsx)(b.X,{checked:!!e.customer_visible,disabled:!0}),editor:e=>A(e),style:{width:"40%"}}),(null==t?void 0:t.includes("service_type.update"))&&(0,l.jsx)(v.s,{rowEditor:e=>(null==e?void 0:e.name)!=="Blue Band",headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),(null==t?void 0:t.includes("service_type.delete"))&&(0,l.jsx)(v.s,{body:e=>(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>L(e)})}),exportable:!1,style:{width:"1%"}})]}),(0,l.jsx)(F.D,{first:S,rows:f,totalRecords:p,onPageChange:e=>{C(e.first),M(e.page+1)}}),(0,l.jsx)(c.F,{ref:_}),(0,l.jsx)(I,{dialog:g,setDialog:w,showSuccess:N,setServicesTypes:x}),(0,l.jsx)(W,{serviceType:i,deleteDialog:r,setDeleteDialog:o,setServicesTypes:x,showSuccess:N})]})},L=i(9749),Q=i(686),P=i(1572),V=i(1395),q=e=>{var t;let{dialog:i,setDialog:s,userPermissions:r,showSuccess:o,getServices:d,service:c,setService:v,role:m,page:p}=e,[g,w]=(0,n.useState)(),[b,S]=(0,n.useState)(),[k,B]=(0,n.useState)(0),[Z,F]=(0,n.useState)(),[R,D]=(0,n.useState)(),[N,z]=(0,n.useState)(!1),[A,E]=(0,n.useState)(),I=(null==m?void 0:m.id)===4,W=f.Ry().shape({service_types:f.IX().of(f.Ry().shape({id:f.Rx().required()})).required(),client_name:f.Z_().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri adı m\xfctləqdir"),client_phone:r.includes("service.variable.phone")?f.Z_().required():f.Z_().nullable(),user_id:r.includes("service.variable.user_id")?f.Rx().required():f.Rx(),reject_comment:(null==Z?void 0:Z.id)===2&&r.includes("service.variable.reject_comment")?f.Z_().required():f.Z_().nullable()}),{control:O,handleSubmit:M,formState:{errors:L},setValue:q,reset:X}=(0,y.cI)({resolver:(0,j.X)(W)}),H=async e=>{let t=(null==e?void 0:e.amount)||0;z(!0);try{var i,l;(null==c?void 0:c.id)?await u.Z.updateService({...e,id:c.id,amount:t,client_phone:null===(i=e.client_phone)||void 0===i?void 0:i.toString().replace(/[\s-]/g,"")}):await u.Z.createService({...e,amount:t,client_phone:null===(l=e.client_phone)||void 0===l?void 0:l.toString().replace(/[\s-]/g,"")}),o("Service has been successfull created"),d(p),s(!1)}catch(e){console.error(e)}finally{z(!1)}};(0,n.useEffect)(()=>{if(null==c?void 0:c.id){var e,t;q("client_name",c.client_name),q("client_phone",c.client_phone),q("user_id",null===(e=c.user)||void 0===e?void 0:e.id),U({value:null==c?void 0:c.service_types}),q("amount",+c.amount),q("advance_amount",+c.advance_amount),q("reject_comment",c.reject_comment),q("comment",c.comment);let i=()=>0!==c.status?C.find(e=>(null==e?void 0:e.id)===c.status):I?{id:0,name:"New"}:{id:1,name:"Accepted"};q("status",null===(t=i())||void 0===t?void 0:t.id),F(i()),S(null==R?void 0:R.find(e=>{var t;return e.id===(null===(t=c.user)||void 0===t?void 0:t.id)}))}},[c,q,R]),(0,n.useEffect)(()=>{(async()=>{if(r.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();D(e)}if(r.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();E(e)}})()},[]),(0,n.useEffect)(()=>{var e,t;(null==A?void 0:A.length)&&(null==c?void 0:null===(e=c.service_types)||void 0===e?void 0:e.length)&&(w(c.service_types.map(e=>A.find(t=>t.id===e.id)).filter(Boolean)),q("service_types",null===(t=c.service_types)||void 0===t?void 0:t.map(e=>({id:e.id}))))},[A,null==c?void 0:c.service_types]);let U=e=>{let t=e.value;w(t),q("service_types",null==t?void 0:t.map(e=>({id:e.id})));let i=t.reduce((e,t)=>e+ +t.price,0);B(i),q("amount",i-((null==c?void 0:c.advance_amount)||0))};return(0,l.jsx)(x.V,{visible:i,modal:!0,onHide:()=>{s(!1),X(),v(void 0),w(void 0),S(void 0),F(void 0),B(0)},header:"Xidmət",style:{maxWidth:"500px",width:"100%"},children:(0,l.jsxs)("form",{onSubmit:M(H),style:{display:"flex",flexDirection:"column"},children:[r.includes("service.variable.client_name")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"M\xfcştəri adı:"}),(0,l.jsx)(y.Qr,{name:"client_name",control:O,render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{id:"name",invalid:!!L.client_name,...t})}}),(0,l.jsx)("div",{style:{marginBottom:"10px"},children:null==L?void 0:null===(t=L.client_name)||void 0===t?void 0:t.message})]}),r.includes("service.variable.phone")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Telefon:"}),(0,l.jsx)(y.Qr,{name:"client_phone",control:O,rules:{minLength:12},render:e=>{var t;let{field:i}=e;return(0,l.jsx)(Q.v,{style:{marginBottom:"10px"},id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!L.client_phone,...i,value:null!==(t=i.value)&&void 0!==t?t:""})}})]}),r.includes("service.variable.user_id")&&!I&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Həkim:"}),(0,l.jsx)(y.Qr,{name:"user_id",control:O,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{filter:!0,style:{marginBottom:"10px"},value:b,onChange:e=>{S(e.value),q("user_id",e.value.id)},optionLabel:"full_name",options:R,placeholder:"Doktor se\xe7in",invalid:!!L.user_id})}})]}),r.includes("service.variable.service_type_id")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Xidmət:"}),(0,l.jsx)(y.Qr,{name:"service_types",control:O,render:e=>{let{field:t}=e;return(0,l.jsx)(V.N,{filter:!0,style:{marginBottom:"10px"},value:g,onChange:U,options:A,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full md:w-20rem",invalid:!!L.service_types})}})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"20px",width:"206px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",children:"Toplam: "}),(0,l.jsx)(T.R,{disabled:!0,value:k,mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Depozit:"}),(0,l.jsx)(T.R,{disabled:!0,value:(null==c?void 0:c.advance_amount)||0,mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"}})]})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"20px",width:"206px"},children:[!I&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Alınacaq məbləğ:"}),(0,l.jsx)(T.R,{disabled:!0,value:k-((null==c?void 0:c.advance_amount)||0),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"}})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{children:[I?"Alınacaq":"Alındı",":"]}),(0,l.jsx)(y.Qr,{name:"amount",control:O,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>{t.onChange(e)},mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"},invalid:!!L.amount})}})]})]}),r.includes("service.variable.reject_comment")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Comment:"}),(0,l.jsx)(y.Qr,{name:"comment",control:O,rules:{required:!0},render:e=>{var t;let{field:i}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"name",...i,value:null!==(t=i.value)&&void 0!==t?t:""})}})]}),r.includes("service.variable.reject_comment")&&(null==Z?void 0:Z.id)===2&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Reject comment:"}),(0,l.jsx)(y.Qr,{name:"reject_comment",control:O,rules:{required:!0},render:e=>{var t;let{field:i}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"name",invalid:!!L.reject_comment,...i,value:null!==(t=i.value)&&void 0!==t?t:""})}})]}),r.includes("service.variable.status")&&(null==c?void 0:c.id)&&!I&&(0,l.jsx)("div",{style:{display:"flex",marginBottom:"10px"},children:C.map(e=>(null==e?void 0:e.id)!==0&&(0,l.jsxs)("div",{children:[(0,l.jsx)(P.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{F(e.value),q("status",e.value.id)},checked:(null==Z?void 0:Z.id)===(null==e?void 0:e.id)}),(0,l.jsx)("label",{htmlFor:null==e?void 0:e.name,style:{marginRight:"10px",marginLeft:"4px"},children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",disabled:N,type:"submit"})})]})})},X=i(7332),H=e=>{let{dialog:t,setDialog:i}=e,[s,r]=(0,n.useState)(new Date),[o,d]=(0,n.useState)([new Date,new Date]),[c,v]=(0,n.useState)([new Date,new Date]);return(0,l.jsx)(x.V,{header:"Reports",visible:t,onHide:()=>{t&&i(!1)},children:(0,l.jsx)("div",{style:{minWidth:"40vw",display:"flex",flexDirection:"column"},children:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:[(0,l.jsx)(X.f,{value:s,onChange:e=>r(e.value),style:{width:"170px"},showIcon:!0,dateFormat:"dd/mm/yy"}),(0,l.jsx)(a.z,{severity:"success",label:"Export",icon:"pi pi-upload",style:{width:"180px"},onClick:()=>u.Z.getDailyReportExcel(D(s))})]})})})},U=i(8541),Y=function(e){let{deleteDialog:t,setDeleteDialog:i,service:s,showSuccess:r,getServices:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>i(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{u.Z.deleteService(null==s?void 0:s.id).then(()=>{i(!1),o(1),r("Service has been successfully deleted")}).catch(e=>{console.error(e)})}})]});return(0,l.jsx)(x.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>i(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),s&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==s?void 0:s.client_name}),"?"]})]})})},G=function(e){var t,i,s,r;let{userPermissions:o,role:d}=e,[p,y]=(0,n.useState)([]),[f,j]=(0,n.useState)(null),[w,b]=(0,n.useState)(),[S,k]=(0,n.useState)(),[B,Z]=(0,n.useState)(),[R,z]=(0,n.useState)(),[A,E]=(0,n.useState)(!1),[I,W]=(0,n.useState)(!1),[M,Q]=(0,n.useState)(!1),[P,G]=(0,n.useState)(!1),[K,$]=(0,n.useState)(!1),[J,ee,et]=(0,O.Nr)("",400),[ei,el]=(0,n.useState)(1),[en,es]=(0,n.useState)(),[er,ea,eo]=(0,O.Nr)(null,400),[ed,ec]=(0,n.useState)(),[eu,ev]=(0,n.useState)(0),[em,ex]=(0,n.useState)(0),[ep,eh]=(0,n.useState)(10),[ey,ef]=(0,n.useState)(!1),[ej,eg]=(0,n.useState)(),[ew,e_]=(0,n.useState)([new Date,new Date]),eb=(0,n.useRef)(null),eS=(0,n.useRef)(null),[eC,ek]=(0,n.useState)(!1),[eB,eZ]=(0,n.useState)(),[eF,eR]=(0,n.useState)(!1),eD=2===ew.length&&new Date(ew[0]).getTime()===new Date(ew[1]).getTime(),eN=(s=new Date(ew[0]),r=new Date,s.getFullYear()===r.getFullYear()&&s.getMonth()===r.getMonth()&&s.getDate()===r.getDate()),ez=e=>{var t;null===(t=eb.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},eA=e=>{Z(e),E(!0)},eE=e=>{let t=new Date(e),i=new Date;return t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()},eT=async(e,t)=>{ef(!0);try{let{data:t,meta:i}=await u.Z.getServices({page:e,size:ep,status:null==f?void 0:f.id,from_date:D(ew[0]),to_date:D(ew[1]),client_name:ee,client_phone:ea,service_types:null==en?void 0:en.map(e=>e.id),user_id:null==R?void 0:R.id});if(y(t),ex(null==i?void 0:i.total),o.includes("service.get_all.total_amount")){let{data:e}=await u.Z.getAdvanceInfo(D(ew[0]));eZ(e)}if(o.includes("service.advance.info")){let e=await u.Z.getTotalAmount({status:null==f?void 0:f.id,from_date:D(ew[0]),to_date:D(ew[1]),client_name:ee,client_phone:ea,service_types:null==en?void 0:en.map(e=>e.id),user_id:null==R?void 0:R.id});eg(e)}let l=await u.Z.getTimeZone();eR(!eE(l.date_time))}catch(e){console.error(e)}finally{var i;ef(!1),t&&(null===(i=eS.current)||void 0===i||i.scrollIntoView({behavior:"smooth"}))}};(0,n.useEffect)(()=>{ew[1]&&eT(ei)},[null==f?void 0:f.name,ew[1],ee,ea,null==en?void 0:en.length,R]),(0,n.useEffect)(()=>{(async()=>{if(o.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();k(e)}if(o.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();b(e)}})()},[]);let eI=e=>{Z(e),$(!0)},eW=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsxs)("div",{children:[N(o)&&(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>W(e=>!e),style:{marginRight:"20px"}}),(0,l.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>eT(ei)})]}),(0,l.jsxs)("div",{children:[o.includes("service.all_reports")&&!!p.length&&(0,l.jsx)(a.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:()=>{u.Z.getAllReportsExcel({status:null==f?void 0:f.id,from_date:D(ew[0]),to_date:D(ew[1]),client_name:ee,client_phone:ea,service_types:null==en?void 0:en.map(e=>e.id),user_id:null==R?void 0:R.id})},style:{marginRight:"10px"}}),o.includes("service.daily_report")&&(0,l.jsx)(a.z,{label:"G\xfcn sonu",icon:"pi pi-file-excel",severity:"success",onClick:()=>Q(!0),style:{marginRight:"10px"}}),o.includes("service.create")&&(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>E(!0)})]})]}),eO=e=>e?e.startsWith("+")?e:"+".concat(e):"",eM=e=>{switch(e){case"Rejected":return"danger";case"Accepted":return"success";case"New":return"info"}},eL=e=>(0,l.jsx)(L.V,{value:e.name,severity:eM(e.name)}),eQ=(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"ml-2",children:["Depozit: ",null==ej?void 0:ej.advance," AZN"]}),(0,l.jsxs)("div",{className:"ml-2",children:["Xidmətlər: ",null==ej?void 0:ej.amount," AZN"]}),(0,l.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==ej?void 0:ej.total," AZN"]})]}),eP=(0,l.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"ml-2",children:"N\xf6vbə bağlanıb"}),(0,l.jsxs)("div",{className:"ml-2",children:[null==eB?void 0:null===(t=eB.user)||void 0===t?void 0:t.name," ",null==eB?void 0:null===(i=eB.user)||void 0===i?void 0:i.surname]}),(0,l.jsx)("div",{className:"ml-2",children:null==eB?void 0:eB.transferred_at})]}),o.includes("reservation.next_day_transfer.cancel")&&(0,l.jsx)(a.z,{icon:"pi pi-undo",tooltip:"N\xf6vbəni yenidən a\xe7",onClick:()=>{u.Z.advanceCancel(D(ew[0])).then(async()=>{ek(!1);let{data:e}=await u.Z.getAdvanceInfo(D(ew[0]));eZ(e),ez("N\xf6vbə yenidən a\xe7ıldı")}).catch(e=>{console.error(e)})},disabled:!eN})]});return eF?(0,l.jsx)("div",{children:"Ağıllısanda\uD83D\uDE02"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.w,{value:p,dataKey:"id",header:eW,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},filterDisplay:I?"row":void 0,children:[(0,l.jsx)(v.s,{body:(e,t)=>ey?(0,l.jsx)(U.O,{width:"20px"}):(0,l.jsx)("div",{children:em-t.rowIndex-eu}),header:"#",style:{width:"2%"}}),(0,l.jsx)(v.s,{dataType:"date",header:"Tarix",body:e=>ey?(0,l.jsx)(U.O,{width:"100px"}):e.created_at.slice(0,-3),style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>o.includes("service.filter.date")&&(0,l.jsx)(X.f,{value:ew,onChange:e=>e_(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(v.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:()=>o.includes("service.filter.client_name")&&(0,l.jsx)(h.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:J,onChange:e=>et(e.target.value)}),showFilterMenu:!1,body:e=>ey?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_name})}),o.includes("service.variable.select_phone")&&(0,l.jsx)(v.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:()=>o.includes("service.filter.client_phone")&&(0,l.jsx)(T.R,{style:{width:"180px"},id:"client_phone",placeholder:"+994 99 999-99-99",value:er,onChange:e=>eo(e.value),prefix:"+",useGrouping:!1}),showFilterMenu:!1,body:e=>ey?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:eO(e.client_phone)})}),(0,l.jsx)(v.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,filter:o.includes("service.variable.service_type_id"),filterElement:()=>o.includes("service.filter.service_type")&&(0,l.jsx)(V.N,{filter:!0,value:en,onChange:e=>{es(e.value)},options:w,placeholder:"Xidmət se\xe7in",optionLabel:"name",showClear:!0}),body:e=>ey?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.service_types.map(e=>(0,l.jsx)("div",{children:e.name},e.id))})}),(0,l.jsx)(v.s,{header:"Həkim",body:e=>{var t,i;return ey?(0,l.jsx)(U.O,{width:"150px"}):"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},style:{width:"10%"},showFilterMenu:!1,filter:o.includes("service.variable.user_id"),filterElement:()=>o.includes("service.filter.doctor")&&(0,l.jsx)(_.L,{filter:!0,value:R,onChange:e=>{z(e.value)},options:S,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0})}),(0,l.jsx)(v.s,{header:"Məbləğ",body:e=>{var t,i;let n=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+(null==e?void 0:e.amount)?+(null==e?void 0:e.amount)+(null==e?void 0:e.advance_amount):+(null==e?void 0:e.services_total)),s=null!==(i=null===(t=n.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=n.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return ey?(0,l.jsx)(U.O,{width:"100px"}):"".concat(r," ").concat(s)},style:{width:"10%"}}),(0,l.jsx)(v.s,{header:"Status",body:e=>{var t;let i=null===(t=C.find(t=>(null==t?void 0:t.id)===e.status))||void 0===t?void 0:t.name;return ey?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)(L.V,{onClick:()=>{"Rejected"===i&&(ec(e.reject_comment),G(!0))},icon:"Rejected"===i&&"pi pi-info-circle",value:i,severity:eM(i)})},style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>o.includes("service.filter.status")&&(0,l.jsx)(_.L,{value:f,options:C,onChange:e=>{j(e.value)},itemTemplate:eL,placeholder:"Select one",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"})}),(0,l.jsx)(v.s,{body:e=>ey?(0,l.jsx)(U.O,{width:"60px"}):(0,l.jsxs)(n.Fragment,{children:[(null==e?void 0:e.status)===0&&4===d.id&&(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>eA(e)}),4!==d.id&&(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>eA(e)}),(null==o?void 0:o.includes("service.delete"))&&(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>eI(e)})]}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)("div",{ref:eS,children:(0,l.jsx)(F.D,{first:eu,rows:ep,totalRecords:em,onPageChange:e=>{ev(e.first),eT(e.page+1,!0),el(e.page+1)}})}),o.includes("service.get_all.total_amount")&&(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(g.v,{style:{border:"solid #696cff",borderWidth:"0 0 0 6px",marginTop:"20px",marginRight:"20px"},severity:"info",content:eQ}),eD&&!ey&&((null==eB?void 0:eB.id)&&o.includes("service.advance.info")?(0,l.jsx)(g.v,{content:eP,style:{marginTop:"20px"}}):o.includes("reservation.next_day_transfer")&&(0,l.jsx)(a.z,{onClick:()=>ek(!0),disabled:!eN,children:"N\xf6vbəni bağla"}))]}),(0,l.jsx)(c.F,{ref:eb}),(0,l.jsx)(q,{userPermissions:o,dialog:A,setDialog:E,showSuccess:ez,service:B,setService:Z,getServices:eT,role:d,page:ei}),(0,l.jsx)(H,{dialog:M,setDialog:Q}),(0,l.jsx)(x.V,{header:"Reject comment",visible:P,style:{width:"50vw"},onHide:()=>{P&&(G(!1),ec(""))},children:(0,l.jsx)("p",{className:"m-0",children:ed})}),(0,l.jsx)(x.V,{visible:eC,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"N\xf6vbəni bağla",modal:!0,footer:(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"Xeyr",icon:"pi pi-times",outlined:!0,onClick:()=>ek(!1)}),(0,l.jsx)(a.z,{label:"Bəli",icon:"pi pi-check",severity:"danger",onClick:()=>{u.Z.advanceTransfer().then(async()=>{ek(!1);let{data:e}=await u.Z.getAdvanceInfo(D(ew[0]));eZ(e),ez("N\xf6vbə bağlandı")}).catch(e=>{console.error(e)})}})]}),onHide:()=>ek(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),(0,l.jsx)("span",{children:"N\xf6vbənin ba\xf6lanılmasına əminsiz?"})]})}),(0,l.jsx)(Y,{service:B,deleteDialog:K,setDeleteDialog:$,showSuccess:ez,getServices:eT})]})},K=i(1398),$=function(){let[e,t]=(0,n.useState)(),[i,s]=(0,n.useState)([new Date,new Date]),[r,o]=(0,n.useState)(),[d,c]=(0,n.useState)(),[x,p]=(0,n.useState)({}),[h,y]=(0,n.useState)(),f=e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.bonus_per_days),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",s=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(s," ").concat(n)},j=e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}),n=h||1,s=l.formatToParts(+e.bonus_per_days/n),r=null!==(i=null===(t=s.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",a=s.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(a," ").concat(r)},g=async()=>{try{let{data:e}=await u.Z.getBonuses({from_date:D(i[0]),to_date:D(i[1]),user_id:null==d?void 0:d.id}),{data:l}=await u.Z.getBonusesCoefficient();t(e),y(null==l?void 0:l.coefficient)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{i[1]&&g()},[i[1],d]),(0,n.useEffect)(()=>{h&&u.Z.patchBonusCoefficient(h)},[h]),(0,n.useEffect)(()=>{(async()=>{let{data:e}=await u.Z.getDoctors();o(e)})()},[]);let w=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(X.f,{value:i,onChange:e=>s(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px",marginRight:"10px"},dateFormat:"dd/mm/yy"}),(0,l.jsx)(_.L,{filter:!0,style:{marginBottom:"10px"},value:d,onChange:e=>{c(e.value)},options:r,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}),(0,l.jsx)(T.R,{style:{marginLeft:"10px",maxWidth:10},value:h,onValueChange:e=>y(e.value||0)})]}),(0,l.jsx)(a.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:()=>{u.Z.getBonusesExcel({from_date:D(i[0]),to_date:D(i[1]),user_id:null==d?void 0:d.id})},style:{marginRight:"10px"}})]});return(0,l.jsx)("div",{children:(0,l.jsxs)(m.w,{value:e,editMode:"row",dataKey:"user.id",style:{marginBottom:"10px"},header:w,expandedRows:x,onRowToggle:e=>{p(e.data)},rowExpansionTemplate:e=>(0,l.jsx)("div",{children:(0,l.jsxs)(m.w,{value:e.bonus_per_days,children:[(0,l.jsx)(v.s,{field:"date",header:"Tarix",style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"bonus_per_days",header:"Məbləğ",body:f,style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"bonus_per_days",header:"Bonus",body:j,style:{width:"90%"}})]})}),children:[(0,l.jsx)(v.s,{expander:e=>e.bonus_per_days.length>0}),(0,l.jsx)(v.s,{body:e=>{var t,i;return"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},header:"Həkim",style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"total_amount",header:"Toplam məbləğ",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.total_amount),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",s=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(s," ").concat(n)},style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"total_amount",header:"Bonus",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}),n=h||1,s=l.formatToParts(+e.total_amount/n),r=null!==(i=null===(t=s.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",a=s.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(a," ").concat(r)},style:{width:"60%"}})]})})},J=function(e){let{dialog:t,setDialog:i,showSuccess:n,setBookingTimes:s}=e,{control:r,handleSubmit:o,formState:{errors:d},reset:c}=(0,y.cI)(),v=async e=>{let{time:t,reservation_count:l}=e;try{l=l||0;let{data:e}=await u.Z.createBookingTime({reservation_count:l,time:t});s(t=>[...t,e]),n("Rezervasiya saatı uğurla yaradıldı"),i(!1),c()}catch(e){console.error(e)}};return(0,l.jsx)(x.V,{visible:t,style:{width:"25rem"},header:"Rezerv saatı",modal:!0,onHide:()=>i(!1),children:(0,l.jsxs)("form",{onSubmit:o(v),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Saat:"}),(0,l.jsx)(y.Qr,{name:"time",control:r,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(Q.v,{style:{marginBottom:"10px"},id:"time",mask:"99:99",invalid:!!d.time,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Limit:"}),(0,l.jsx)(y.Qr,{name:"reservation_count",control:r,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),style:{marginBottom:"10px"},invalid:!!d.reservation_count})}}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",type:"submit"})})]})})},ee=function(e){let{bookingTime:t,deleteDialog:i,setDeleteDialog:s,setBookingTimes:r,showSuccess:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>s(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{r(e=>e.filter(e=>e.id!==(null==t?void 0:t.id)));try{u.Z.deleteBookingTime(null==t?void 0:t.id),s(!1),o("Rezerv saatı silindi")}catch(e){console.error(e)}}})]});return(0,l.jsx)(x.V,{visible:i,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>s(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),t&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==t?void 0:t.time}),"?"]})]})})},et=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)(),[r,o]=(0,n.useState)(!1),[d,x]=(0,n.useState)([]),[p,h]=(0,n.useState)(0),[y,f]=(0,n.useState)(10),[j,g]=(0,n.useState)(!1),w=(0,n.useRef)(null),_=e=>{var t;null===(t=w.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},b=e=>(0,l.jsx)(T.R,{value:e.value,onValueChange:t=>e.editorCallback(t.value)}),S=e=>(0,l.jsx)(Q.v,{mask:"99:99",value:e.value,onChange:t=>e.editorCallback(t.target.value)}),C=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:i}=await u.Z.getBookingTimes({page:e,size:y});x(null==t?void 0:t.sort((e,t)=>{let i=e.time.split(":").map(Number),l=t.time.split(":").map(Number);return i[0]!==l[0]?i[0]-l[0]:i[1]-l[1]})),h(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{C()},[]);let k=e=>{s(e),o(!0)},B=(null==t?void 0:t.includes("reservation_time.create"))&&(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>g(!0)})});return(0,l.jsxs)("div",{children:[(0,l.jsxs)(m.w,{value:d,editMode:"row",dataKey:"id",onRowEditComplete:e=>{let{newData:t}=e,{id:i,time:l,reservation_count:n}=t;n=n||0;try{u.Z.updateBookingTime({id:i,time:l,reservation_count:n});let e={...t,time:l,reservation_count:n,id:i},s=d.map(t=>t.id===e.id?e:t);x(s),_("Rezerv saatı yeniləndi")}catch(e){console.error(e)}},tableStyle:{minWidth:"50rem"},header:B,style:{marginBottom:"10px"},children:[(0,l.jsx)(v.s,{field:"time",header:"Saat",editor:e=>S(e),style:{width:"40%"}}),(0,l.jsx)(v.s,{field:"reservation_count",header:"Limit",editor:e=>b(e),style:{width:"40%"}}),(null==t?void 0:t.includes("reservation_time.update"))&&(0,l.jsx)(v.s,{rowEditor:e=>(null==e?void 0:e.time)!=="Blue Band",headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),(null==t?void 0:t.includes("reservation_time.delete"))&&(0,l.jsx)(v.s,{body:e=>(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>k(e)})}),exportable:!1,style:{width:"1%"}})]}),(0,l.jsx)(F.D,{rows:y,totalRecords:p,onPageChange:e=>{C(e.page+1)}}),(0,l.jsx)(c.F,{ref:w}),(0,l.jsx)(J,{dialog:j,setDialog:g,showSuccess:_,setBookingTimes:x}),(0,l.jsx)(ee,{bookingTime:i,deleteDialog:r,setDeleteDialog:o,setBookingTimes:x,showSuccess:_})]})},ei=e=>{var t;let{dialog:i,setDialog:s,userPermissions:r,showSuccess:o,getBookings:d,booking:c,setBooking:v}=e,[m,p]=(0,n.useState)(),[w,S]=(0,n.useState)(!1),[C,B]=(0,n.useState)(),[Z,F]=(0,n.useState)(!1),[R,N]=(0,n.useState)(),[z,A]=(0,n.useState)(),[E,I]=(0,n.useState)([]),[W,O]=(0,n.useState)(),[M,L]=(0,n.useState)(!1),[q,H]=(0,n.useState)(),[U,Y]=(0,n.useState)(null),G=f.Ry().shape({service_types:(null==z?void 0:z.id)===3?f.IX().of(f.Ry().shape({id:f.Rx().required()})).min(1).required():f.IX(),client_name:f.Z_().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri adı m\xfctləqdir"),client_phone:r.includes("service.variable.phone")?f.Z_().required():f.Z_(),doctor_id:(null==z?void 0:z.id)===3?f.Rx().required():f.Rx(),hour:f.Z_().required()}),{control:K,handleSubmit:$,formState:{errors:J},setValue:ee,getValues:et,reset:ei}=(0,y.cI)({resolver:(0,j.X)(G)}),el=async e=>{L(!0);let t=(null==e?void 0:e.advance_amount)?null==e?void 0:e.advance_amount:0;try{var i,l;(null==c?void 0:c.id)?await u.Z.updateBooking({...e,client_name:e.client_name,doctor_id:e.doctor_id,advance_amount:t,id:c.id,client_phone:null===(i=e.client_phone)||void 0===i?void 0:i.toString().replace(/[\s-]/g,""),reservation_date:(null==z?void 0:z.id)===2?"".concat(D(U)," ").concat(null==R?void 0:R.time):null==c?void 0:c.reservation_date,status:e.status}):await u.Z.createBooking({...e,advance_amount:t,client_name:e.client_name,doctor_id:e.doctor_id,client_phone:null===(l=e.client_phone)||void 0===l?void 0:l.toString().replace(/[\s-]/g,""),reservation_date:"".concat(D(U)," ").concat(null==R?void 0:R.time)}),o("Reserve has been successfull created"),d(),s(!1)}catch(e){console.error(e)}finally{L(!1)}};(0,n.useEffect)(()=>{if(null==c?void 0:c.id){ee("client_name",c.client_name),ee("client_phone",c.client_phone),ee("is_out_of_turn",c.is_out_of_turn),F(c.is_out_of_turn);let[e,t,i]=c.reservation_date.split("-"),[l,n]=i.split(" "),s=new Date("".concat(l,"-").concat(t,"-").concat(e,"T").concat(n));ee("reservation_date",s),Y(s),ee("status",c.status),ee("advance_amount",c.advance_amount),A(k.find(e=>(null==e?void 0:e.id)===c.status))}},[c,ee]),(0,n.useEffect)(()=>{var e;(null==c?void 0:c.id)&&(null==c?void 0:null===(e=c.doctor)||void 0===e?void 0:e.id)&&(async()=>{var e,t;let{data:i}=await u.Z.getDoctorById(null===(e=c.doctor)||void 0===e?void 0:e.id);ee("doctor_id",null===(t=c.doctor)||void 0===t?void 0:t.id),B({id:i.id,full_name:"".concat(null==i?void 0:i.name," ").concat(null==i?void 0:i.surname)}),(null==E?void 0:E.map(e=>null==e?void 0:e.id).includes((null==C?void 0:C.id)||0))||I(e=>[...e,{id:i.id,full_name:"".concat(null==i?void 0:i.name," ").concat(null==i?void 0:i.surname)}])})()},[null==c?void 0:c.id,null==R?void 0:R.time]),(0,n.useEffect)(()=>{(async()=>{if(r.includes("user.input_search")&&(null==R?void 0:R.time)&&!(null==E?void 0:E.map(e=>null==e?void 0:e.id).includes((null==C?void 0:C.id)||0))){let{data:e}=Z?await u.Z.getDoctors():await u.Z.getBookingDoctors("".concat(D(U)," ").concat(null==R?void 0:R.time));I(e)}else{let{data:e}=await u.Z.getDoctors();I(e),!(null==E?void 0:E.map(e=>null==e?void 0:e.id).includes((null==C?void 0:C.id)||0))&&(null==C?void 0:C.id)&&I(e=>[...e,{id:C.id,full_name:null==C?void 0:C.full_name}])}})()},[null==R?void 0:R.time,Z]),(0,n.useEffect)(()=>{(async()=>{if(r.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();H(e)}})()},[]),(0,n.useEffect)(()=>{var e,t;(null==q?void 0:q.length)&&(null==c?void 0:null===(e=c.service_types)||void 0===e?void 0:e.length)&&(p(c.service_types.map(e=>q.find(t=>t.id===e.id)).filter(Boolean)),ee("service_types",null===(t=c.service_types)||void 0===t?void 0:t.map(e=>({id:e.id}))))},[q,null==c?void 0:c.service_types]),(0,n.useEffect)(()=>{(async()=>{if(U){let{data:t}=await u.Z.getHours(D(U));if(O(t),null==c?void 0:c.id){var e;N(null==t?void 0:t.find(e=>{var t;return e.time===(null==c?void 0:null===(t=c.real_reservation_date)||void 0===t?void 0:t.split(" ")[1].slice(0,-3))})),ee("hour",null==c?void 0:null===(e=c.real_reservation_date)||void 0===e?void 0:e.split(" ")[1].slice(0,-3))}}})()},[D(U)]);let en=e=>{let t=e.value;p(t),ee("service_types",null==t?void 0:t.map(e=>({id:e.id})))};return(0,l.jsx)(x.V,{visible:i,modal:!0,onHide:()=>{s(!1),ei(),v(void 0),p(void 0),B(void 0),A(void 0),N(void 0),Y(void 0),I([]),F(!1),S(!1)},header:"Rezerv",style:{maxWidth:"500px",width:"100%"},children:(0,l.jsxs)("form",{onSubmit:$(el),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"M\xfcştəri adı:"}),(0,l.jsx)(y.Qr,{name:"client_name",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{id:"name",invalid:!!J.client_name,...t})}}),(0,l.jsx)("div",{style:{marginBottom:"10px"},children:null==J?void 0:null===(t=J.client_name)||void 0===t?void 0:t.message})]}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Telefon:"}),(0,l.jsx)(y.Qr,{name:"client_phone",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(Q.v,{style:{marginBottom:"10px"},id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!J.client_phone,...t})}}),(0,l.jsxs)("label",{style:{marginBottom:"5px",display:"flex",justifyContent:"space-between"},htmlFor:"email",children:["Həkim:",(0,l.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"5px"},children:[(0,l.jsx)("label",{htmlFor:"email",children:"N\xf6vbədən kənar:"}),(0,l.jsx)(y.Qr,{name:"is_out_of_turn",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(b.X,{checked:Z,onChange:e=>{var t;F(e=>!e),ee("is_out_of_turn",null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.checked)},children:" "})}})]})]}),(0,l.jsx)(y.Qr,{name:"doctor_id",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{disabled:!R&&((null==z?void 0:z.id)===2||void 0===(null==z?void 0:z.id)),filter:!0,style:{marginBottom:"10px"},value:C,onChange:e=>{B(e.value),ee("doctor_id",e.value.id)},optionLabel:"full_name",options:E,placeholder:"Doktor se\xe7in",invalid:!!J.doctor_id})}}),r.includes("service.variable.service_type_id")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Xidmət:"}),(0,l.jsx)(y.Qr,{name:"service_types",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(V.N,{filter:!0,style:{marginBottom:"10px"},value:m,onChange:en,options:q,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full md:w-20rem",invalid:!!J.service_types})}})]}),(void 0===et().status||2===et().status)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Tarix və saat:"}),(0,l.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,l.jsx)(y.Qr,{name:"reservation_date",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(X.f,{dateFormat:"dd-mm-yy",invalid:!!J.reservation_date,minDate:new Date,readOnlyInput:!0,value:U,onChange:e=>{Y(e.value),ee("reservation_date",e.value)}})}}),(0,l.jsx)(y.Qr,{name:"hour",control:K,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{disabled:!U,style:{marginBottom:"10px",marginLeft:"5px",marginRight:"10px"},value:R,onChange:e=>{N(e.value),ee("hour",e.value.time)},optionLabel:"time",options:W,optionDisabled:e=>!e.active,placeholder:"Saat se\xe7in",invalid:!R})}}),(null==R?void 0:R.remaining_space)&&(0,l.jsx)(g.v,{style:{border:"solid #111827"},severity:"info",content:(0,l.jsxs)("div",{style:{color:"white"},children:["Yer: ",null==R?void 0:R.remaining_space]})})]})]}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{children:"Depozit:"}),(0,l.jsx)(y.Qr,{name:"advance_amount",control:K,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onClick:()=>{S(!0)},onValueChange:e=>{t.onChange(e)},mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"},invalid:!w})}})]}),(null==c?void 0:c.id)&&(0,l.jsx)("div",{style:{display:"flex",marginBottom:"10px"},children:null==k?void 0:k.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsx)(P.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{A(e.value),ee("status",e.value.id)},checked:(null==z?void 0:z.id)===(null==e?void 0:e.id)}),(0,l.jsx)("label",{htmlFor:null==e?void 0:e.name,style:{marginRight:"10px",marginLeft:"4px"},children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",disabled:M||!w,type:"submit"})})]})})},el=function(e){let{deleteDialog:t,setDeleteDialog:i,booking:s,showSuccess:r,getBookings:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>i(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{u.Z.deleteBooking(null==s?void 0:s.id).then(()=>{i(!1),o(),r("Rezerv silindi")}).catch(e=>{console.error(e)})}})]});return(0,l.jsx)(x.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>i(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),s&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==s?void 0:s.client_name}),"?"]})]})})},en=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)([]),[r,o]=(0,n.useState)(null),[d,p]=(0,n.useState)(),[y,f]=(0,n.useState)(!1),[j,g]=(0,n.useState)(!1),[w,b]=(0,n.useState)(!1),[S,C]=(0,n.useState)(!1),[B,Z,F]=(0,O.Nr)("",400),[R,z]=(0,n.useState)(),[A,E,I]=(0,O.Nr)(null,400),[W,M]=(0,n.useState)(),[Q,P]=(0,n.useState)(!1),[V,q]=(0,n.useState)([new Date,new Date]),H=(0,n.useRef)(null),Y=(0,n.useRef)(null),G=e=>{var t;null===(t=H.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},K=e=>{p(e),f(!0)},$=async e=>{P(!0);try{let{data:e,meta:t}=await u.Z.getBookings({status:null==r?void 0:r.id,from_date:D(V[0]),to_date:D(V[1]),client_name:Z,client_phone:E});s(e)}catch(e){console.error(e)}finally{var t;P(!1),e&&(null===(t=Y.current)||void 0===t||t.scrollIntoView({behavior:"smooth"}))}};(0,n.useEffect)(()=>{V[1]&&$()},[null==r?void 0:r.name,V[1],Z,E,null==R?void 0:R.length]);let J=e=>{p(e),C(!0)},ee=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsxs)("div",{children:[N(t)&&(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>g(e=>!e),style:{marginRight:"20px"}}),(0,l.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>$()})]}),(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>f(!0)})]}),et=e=>e?e.startsWith("+")?e:"+".concat(e):"",en=e=>{switch(e){case"Ləğv":return"danger";case"Gəldi":return"warning";case"Qəbul edildi":return"success";case"G\xf6zlənilir":case"Online":return"info"}},es=e=>(0,l.jsx)(L.V,{value:e.name,severity:en(e.name)});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.w,{value:i,dataKey:"id",header:ee,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},filterDisplay:j?"row":void 0,paginator:!0,rows:10,children:[(0,l.jsx)(v.s,{body:(e,t)=>Q?(0,l.jsx)(U.O,{width:"20px"}):(0,l.jsx)("div",{children:r?(null==t?void 0:t.rowIndex)+1:(null==i?void 0:i.length)-(null==t?void 0:t.rowIndex)}),header:"#",style:{width:"2%"}}),(0,l.jsx)(v.s,{dataType:"date",header:"Tarix",body:e=>Q?(0,l.jsx)(U.O,{width:"100px"}):e.reservation_date.slice(0,-3),style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("reservation.filter.date")&&(0,l.jsx)(X.f,{minDate:(null==t?void 0:t.includes("reservation.get_past_data"))?void 0:new Date,value:V,onChange:e=>q(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(v.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("reservation.filter.client_name")&&(0,l.jsx)(h.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:B,onChange:e=>F(e.target.value)}),showFilterMenu:!1,body:e=>Q?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_name})}),(0,l.jsx)(v.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("reservation.filter.client_phone")&&(0,l.jsx)(T.R,{style:{width:"180px"},id:"client_phone",placeholder:"+994 99 999-99-99",value:A,onChange:e=>I(e.value),prefix:"+",useGrouping:!1}),showFilterMenu:!1,body:e=>Q?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:et(e.client_phone)})}),(0,l.jsx)(v.s,{header:"Status",body:e=>{var t;let i=null===(t=k.find(t=>(null==t?void 0:t.id)===e.status))||void 0===t?void 0:t.name;return Q?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)(L.V,{value:i,severity:en(i)})},style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("reservation.filter.status")&&(0,l.jsx)(_.L,{value:r,options:k,onChange:e=>{o(e.value)},itemTemplate:es,placeholder:"Status",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"})}),(0,l.jsx)(v.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,body:e=>Q?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.service_types.map(e=>(0,l.jsx)("div",{children:e.name},e.id))})}),(0,l.jsx)(v.s,{header:"Həkim",body:e=>{var t,i,n;return Q?(0,l.jsx)(U.O,{width:"150px"}):(null===(t=e.doctor)||void 0===t?void 0:t.name)&&"".concat(null===(i=e.doctor)||void 0===i?void 0:i.name," ").concat(null===(n=e.doctor)||void 0===n?void 0:n.surname)},style:{width:"10%"},showFilterMenu:!1}),(0,l.jsx)(v.s,{header:"Depozit",body:e=>{var t,i;let n=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.advance_amount),s=null!==(i=null===(t=n.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=n.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return Q?(0,l.jsx)(U.O,{width:"100px"}):"".concat(r," ").concat(s)},style:{width:"10%"}}),t.includes("reservation.update")&&(0,l.jsx)(v.s,{body:e=>Q?(0,l.jsx)(U.O,{width:"60px"}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>K(e)}),(null==t?void 0:t.includes("reservation.delete"))&&(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>J(e)})]}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)(c.F,{ref:H}),(0,l.jsx)(ei,{userPermissions:t,dialog:y,setDialog:f,showSuccess:G,booking:d,setBooking:p,getBookings:$}),(0,l.jsx)(x.V,{header:"Reject comment",visible:w,style:{width:"50vw"},onHide:()=>{w&&(b(!1),M(""))},children:(0,l.jsx)("p",{className:"m-0",children:W})}),(0,l.jsx)(el,{booking:d,deleteDialog:S,setDeleteDialog:C,showSuccess:G,getBookings:$})]})},es=i(4427),er=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)(),[r,o]=(0,n.useState)(),[d,c]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),[y,f]=(0,n.useState)([new Date,new Date]),[j,g]=(0,n.useState)(0),[w,_]=(0,n.useState)(1),b=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;c(!0);try{let{data:t,meta:i}=await u.Z.getLogs({from_date:D(y[0]),to_date:D(y[1]),page:e});s(t),g(null==i?void 0:i.total)}catch(e){console.error(e)}finally{c(!1)}};(0,n.useEffect)(()=>{y[1]&&b()},[y[1]]);let S=(0,l.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,l.jsx)("div",{children:(0,l.jsx)(X.f,{value:y,onChange:e=>f(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px",marginRight:"10px"},dateFormat:"dd/mm/yy"})})});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.w,{value:i,dataKey:"id",tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},header:S,children:[(0,l.jsx)(v.s,{body:(e,t)=>d?(0,l.jsx)(U.O,{width:"20px"}):(0,l.jsx)("div",{children:j-t.rowIndex-w}),header:"#",style:{width:"2%"}}),(0,l.jsx)(v.s,{dataType:"date",header:"Tarix",body:e=>d?(0,l.jsx)(U.O,{width:"100px"}):e.service.created_at.slice(0,-3),style:{width:"10%"}}),(0,l.jsx)(v.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},body:e=>d?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.service.client_name})}),(0,l.jsx)(v.s,{header:"Xidmət",style:{width:"10%"},body:e=>d?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.service.service_types.map(e=>(0,l.jsx)("div",{children:e.name},e.id))})}),(0,l.jsx)(v.s,{header:"Doktor",body:e=>{var t,i,n,s;return d?(0,l.jsx)(U.O,{width:"150px"}):"".concat(null==e?void 0:null===(i=e.service)||void 0===i?void 0:null===(t=i.user)||void 0===t?void 0:t.name," ").concat(null==e?void 0:null===(s=e.service)||void 0===s?void 0:null===(n=s.user)||void 0===n?void 0:n.surname)},style:{width:"10%"}}),(0,l.jsx)(v.s,{header:"Səbəbkar",body:e=>{var t,i,n;return d?(0,l.jsx)(U.O,{width:"150px"}):"".concat(null===(t=e.price_difference.causer)||void 0===t?void 0:t.name," ").concat(null===(n=e.price_difference)||void 0===n?void 0:null===(i=n.causer)||void 0===i?void 0:i.surname)},style:{width:"10%"}}),(0,l.jsx)(v.s,{header:"Faktiki məbləğ",body:e=>{var t,i,n;let s=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+(null==e?void 0:null===(t=e.price_difference)||void 0===t?void 0:t.service_types_price_sum)),r=null!==(n=null===(i=s.find(e=>"currency"===e.type))||void 0===i?void 0:i.value)&&void 0!==n?n:"AZN",a=s.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return d?(0,l.jsx)(U.O,{width:"100px"}):"".concat(a," ").concat(r)},style:{width:"10%"}}),(0,l.jsx)(v.s,{header:"Alınan məbləğ",body:e=>{var t,i,n;let s=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+(null==e?void 0:null===(t=e.price_difference)||void 0===t?void 0:t.service_price_sum)),r=null!==(n=null===(i=s.find(e=>"currency"===e.type))||void 0===i?void 0:i.value)&&void 0!==n?n:"AZN",a=s.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return d?(0,l.jsx)(U.O,{width:"100px"}):"".concat(a," ").concat(r)},style:{width:"10%"}}),(0,l.jsx)(v.s,{header:"Depozit",body:e=>{var t,i,n;let s=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+(null==e?void 0:null===(t=e.service)||void 0===t?void 0:t.advance_amount)),r=null!==(n=null===(i=s.find(e=>"currency"===e.type))||void 0===i?void 0:i.value)&&void 0!==n?n:"AZN",a=s.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return d?(0,l.jsx)(U.O,{width:"100px"}):"".concat(a," ").concat(r)},style:{width:"10%"}}),(0,l.jsx)(v.s,{body:e=>d?(0,l.jsx)(U.O,{width:"60px"}):(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.z,{icon:"pi pi-question",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>{o(e),h(!0)}})}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)(F.D,{first:w,rows:10,totalRecords:j,onPageChange:e=>{_(e.first),b(e.page+1)}}),(0,l.jsx)(x.V,{header:"Activity logs",visible:p,style:{width:"50vw"},onHide:()=>h(!1),children:(0,l.jsx)("p",{className:"m-0",children:(0,l.jsx)(es.L,{data:null==r?void 0:r.activity_logs})})})]})},ea=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)([]),[r,o]=(0,n.useState)(0),[d,x]=(0,n.useState)(0),[p,h]=(0,n.useState)(10),[y,f]=(0,n.useState)(1),j=(0,n.useRef)(null),[g,w]=(0,n.useState)(!1),_=new Date;_.setDate(_.getDate()-10);let[b,S]=(0,n.useState)([_,new Date]),C=async e=>{try{let{data:t,meta:i}=await u.Z.getAdvances({page:e,size:p,from_date:D(b[0]),to_date:D(b[1])});s(t),x(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{b[1]&&C(y)},[b[1]]);let k=(0,l.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,l.jsx)("div",{children:N(t)&&(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>w(e=>!e),style:{marginRight:"20px"}})})});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.w,{value:i,editMode:"row",dataKey:"id",tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},header:k,filterDisplay:g?"row":void 0,children:[(0,l.jsx)(v.s,{field:"transferred_at",header:"Tarix və saat",style:{width:"20%"},filter:!0,filterElement:()=>t.includes("service.filter.date")&&(0,l.jsx)(X.f,{value:b,onChange:e=>S(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(v.s,{field:"user",header:"Bağlayan şəxs",body:e=>{var t,i;return(0,l.jsx)("div",{children:(null==e?void 0:e.user)?"".concat(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null==e?void 0:null===(i=e.user)||void 0===i?void 0:i.surname):"sistem"})},style:{width:"20%"}}),(0,l.jsx)(v.s,{field:"role",body:e=>{var t,i;return(0,l.jsx)("div",{children:R(null==e?void 0:null===(i=e.user)||void 0===i?void 0:null===(t=i.role)||void 0===t?void 0:t.id)})},header:"Rol",style:{width:"20%"}})]}),(0,l.jsx)(F.D,{first:r,rows:p,totalRecords:d,onPageChange:e=>{C(e.page+1),f(e.page+1),o(e.first)}}),(0,l.jsx)(c.F,{ref:j})]})},eo=function(e){let{userPermissions:t,role:i}=e,[s,r]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),[y,f]=(0,n.useState)(),[j,w]=(0,n.useState)([new Date,new Date]),[b,S]=(0,n.useState)(void 0),[C,k,B]=(0,O.Nr)("",400),[Z,F,R]=(0,O.Nr)(null,400),[z,A]=(0,n.useState)(),[E,I]=(0,n.useState)(),W=(0,n.useRef)(null),M=async e=>{p(!0);try{let{data:e}=await u.Z.getReports({from_date:D(j[0]),to_date:D(j[1]),client_name:k,client_phone:F,user_id:null==E?void 0:E.id});if(r(e),t.includes("service.advance.info")){let e=await u.Z.getTotalAmount({from_date:D(j[0]),to_date:D(j[1]),client_name:k,client_phone:F,user_id:null==E?void 0:E.id});f(e)}}catch(e){console.error(e)}finally{p(!1)}};(0,n.useEffect)(()=>{j[1]&&M()},[j[1],k,F,E]),(0,n.useEffect)(()=>{(async()=>{if(t.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();A(e)}})()},[]);let L=(0,l.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,l.jsxs)("div",{children:[N(t)&&(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>d(e=>!e),style:{marginRight:"20px"}}),(0,l.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>M()})]})}),Q=e=>e?e.startsWith("+")?e:"+".concat(e):"",P=e=>{var t,i;let n=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+(null==e?void 0:e.amount)),s=null!==(i=null===(t=n.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=n.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return x?(0,l.jsx)(U.O,{width:"100px"}):"".concat(r," ").concat(s)},V=(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"ml-2",children:["Depozit: ",null==y?void 0:y.advance," AZN"]}),(0,l.jsxs)("div",{className:"ml-2",children:["Xidmətlər: ",null==y?void 0:y.amount," AZN"]}),(0,l.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==y?void 0:y.total," AZN"]})]}),q=e=>x?(0,l.jsx)(U.O,{width:"100px"}):e.created_at.slice(0,-3),H=e=>{var t,i;return x?(0,l.jsx)(U.O,{width:"150px"}):"".concat(null===(t=e.causer)||void 0===t?void 0:t.name," ").concat(null===(i=e.causer)||void 0===i?void 0:i.surname)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.w,{value:s,dataKey:"id",header:L,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},filterDisplay:o?"row":void 0,paginator:!0,rows:10,expandedRows:b,onRowToggle:e=>{S(e.data)},rowExpansionTemplate:e=>(0,l.jsx)("div",{className:"p-3",children:(0,l.jsxs)(m.w,{value:e.amount_change_history,children:[(0,l.jsx)(v.s,{field:"date",header:"Tarix",body:q}),(0,l.jsx)(v.s,{field:"amount",header:"Məbləğ",body:P}),(0,l.jsx)(v.s,{field:"status",header:"Qəbul edən",body:H})]})}),children:[(0,l.jsx)(v.s,{expander:e=>e.amount_change_history.length>1,style:{width:"2%"}}),(0,l.jsx)(v.s,{body:(e,t)=>x?(0,l.jsx)(U.O,{width:"20px"}):(0,l.jsx)("div",{children:(null==t?void 0:t.rowIndex)+1}),header:"#",style:{width:"2%"}}),(0,l.jsx)(v.s,{dataType:"date",header:"Tarix",body:e=>x?(0,l.jsx)(U.O,{width:"100px"}):e.date_time.slice(0,-3),style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("service.filter.date")&&(0,l.jsx)(X.f,{value:j,onChange:e=>w(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(v.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("service.filter.client_name")&&(0,l.jsx)(h.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:C,onChange:e=>B(e.target.value)}),showFilterMenu:!1,body:e=>x?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_name})}),t.includes("service.variable.select_phone")&&(0,l.jsx)(v.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("service.filter.client_phone")&&(0,l.jsx)(T.R,{style:{width:"180px"},id:"client_phone",placeholder:"+994 99 999-99-99",value:Z,onChange:e=>R(e.value),prefix:"+",useGrouping:!1}),showFilterMenu:!1,body:e=>x?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:Q(e.client_phone)})}),(0,l.jsx)(v.s,{header:"Mənbə",style:{width:"10%"},showFilterMenu:!1,body:e=>x?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:"service"===e.service_type?"xidmət":"depozit"})}),(0,l.jsx)(v.s,{header:"Qəbul edən",body:e=>{var t,i;return x?(0,l.jsx)(U.O,{width:"150px"}):"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},style:{width:"10%"},filter:t.includes("service.variable.user_id"),filterElement:()=>t.includes("service.filter.doctor")&&(0,l.jsx)(_.L,{filter:!0,value:E,onChange:e=>{I(e.value)},options:z,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}),showFilterMenu:!1}),(0,l.jsx)(v.s,{header:"Məbləğ",body:P,style:{width:"10%"}})]}),t.includes("service.get_all.total_amount")&&(0,l.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,l.jsx)(g.v,{style:{border:"solid #696cff",borderWidth:"0 0 0 6px",marginTop:"20px",marginRight:"20px"},severity:"info",content:V})}),(0,l.jsx)(c.F,{ref:W})]})},ed=function(e){let{expense:t,dialog:i,setDialog:s,showSuccess:r,getExpenses:o}=e,{control:d,setValue:c,handleSubmit:v,formState:{errors:m},reset:p}=(0,y.cI)(),f=async e=>{let{name:i,amount:l,description:n}=e;l=l||0;try{let{data:e}=(null==t?void 0:t.id)?await u.Z.updateExpense({name:i,amount:l,description:n,id:t.id}):await u.Z.createExpense({name:i,amount:l,description:n});o(1),r("Xərc ".concat((null==t?void 0:t.id)?"yeniləndi":"əlavə olundu")),s(!1),p()}catch(e){console.error(e)}};return(0,n.useEffect)(()=>{(null==t?void 0:t.id)&&(c("name",t.name),c("amount",t.amount),c("description",t.description))},[t,c]),(0,l.jsx)(x.V,{visible:i,style:{width:"25rem"},header:"Xərc",modal:!0,onHide:()=>{s(!1),p()},children:(0,l.jsxs)("form",{onSubmit:v(f),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,l.jsx)(y.Qr,{name:"name",control:d,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"name",invalid:!!(null==m?void 0:m.name),...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"İzah:"}),(0,l.jsx)(y.Qr,{name:"description",control:d,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(h.o,{style:{marginBottom:"10px"},id:"description",invalid:!!(null==m?void 0:m.description),...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Qiymət:"}),(0,l.jsx)(y.Qr,{name:"amount",control:d,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px"},invalid:!!m.amount})}}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",type:"submit"})})]})})},ec=function(e){let{expense:t,deleteDialog:i,setDeleteDialog:s,setExpenses:r,showSuccess:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>s(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{r(e=>e.filter(e=>e.id!==(null==t?void 0:t.id)));try{u.Z.deleteExpense(null==t?void 0:t.id),s(!1),o("Silindi")}catch(e){console.error(e)}}})]});return(0,l.jsx)(x.V,{visible:i,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>s(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),t&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==t?void 0:t.name}),"?"]})]})})},eu=function(e){let{userPermissions:t}=e,[i,s]=(0,n.useState)(),[r,o]=(0,n.useState)(!1),[d,x]=(0,n.useState)(!1),[p,h]=(0,n.useState)([]),[y,f]=(0,n.useState)(0),[j,w]=(0,n.useState)(10),[_,b]=(0,n.useState)(!1),S=(0,n.useRef)(null),[C,k]=(0,n.useState)([new Date,new Date]),[B,Z]=(0,n.useState)(!1),[R,N]=(0,n.useState)("0"),[z,A]=(0,n.useState)(0),E=e=>{var t;null===(t=S.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},T=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;x(!0);try{let{data:t,meta:i}=await u.Z.getExpenses({page:e,size:j,from_date:D(C[0]),to_date:D(C[1])}),{amount:l}=await u.Z.getExpensesTotal({from_date:D(C[0]),to_date:D(C[1])});N(l),h(t),f(null==i?void 0:i.total)}catch(e){console.error(e)}finally{x(!1)}};(0,n.useEffect)(()=>{C[1]&&T()},[C[1]]);let I=e=>{s(e),o(!0)},W=e=>{s(e),b(!0)},O=(0,l.jsxs)("div",{children:[R," AZN"]}),M=(null==t?void 0:t.includes("expense.create"))&&(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>Z(e=>!e),style:{marginRight:"20px"}}),(0,l.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>T()})]}),(0,l.jsx)(g.v,{style:{border:"solid #696cff",borderWidth:"0 0 0 6px",marginTop:"20px",marginRight:"20px"},severity:"info",content:O}),(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>b(!0)})]});return(0,l.jsxs)("div",{children:[(0,l.jsxs)(m.w,{value:p,dataKey:"id",tableStyle:{minWidth:"50rem"},header:M,style:{marginBottom:"10px"},filterDisplay:B?"row":void 0,children:[(0,l.jsx)(v.s,{dataType:"date",header:"Tarix",body:e=>{var t;return d?(0,l.jsx)(U.O,{width:"100px"}):null===(t=e.created_at)||void 0===t?void 0:t.slice(0,-3)},style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("service.filter.date")&&(0,l.jsx)(X.f,{value:C,onChange:e=>k(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(v.s,{header:"Ad",style:{width:"10%"},showFilterMenu:!1,body:e=>d?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.name})}),(0,l.jsx)(v.s,{header:"Izah",style:{width:"10%"},showFilterMenu:!1,body:e=>d?(0,l.jsx)(U.O,{width:"100px"}):(0,l.jsx)("div",{children:e.description})}),(0,l.jsx)(v.s,{field:"price",header:"Məbləğ",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.amount),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",s=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(s," ").concat(n)},style:{width:"10%"}}),(null==t?void 0:t.includes("expense.delete"))&&(0,l.jsx)(v.s,{body:e=>(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>W(e)}),(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>I(e)})]}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)(F.D,{first:z,rows:j,totalRecords:y,onPageChange:e=>{T(e.page+1),A(e.first)}}),(0,l.jsx)(c.F,{ref:S}),(0,l.jsx)(ed,{expense:i,dialog:_,setDialog:b,showSuccess:E,getExpenses:T}),(0,l.jsx)(ec,{expense:i,deleteDialog:r,setDeleteDialog:o,setExpenses:h,showSuccess:E})]})},ev=function(){var e,t;let[i,v]=(0,n.useState)(),[m,x]=(0,n.useState)(()=>{{let e=localStorage.getItem("activeTabIndex");return e?parseInt(e,10):0}}),p=(0,d.useRouter)(),h=null==i?void 0:i.role.permissions.map(e=>null==e?void 0:e.name),y=e=>{x(e),localStorage.setItem("activeTabIndex",e.toString())};(0,n.useEffect)(()=>{localStorage.getItem("token")||p.push("/login")},[p]),(0,n.useEffect)(()=>{(async()=>{try{var e;let{data:t}=await u.Z.getSelfInfo();(null==t?void 0:null===(e=t.role)||void 0===e?void 0:e.id)!==5||localStorage.getItem("activeTabIndex")||(x(1),localStorage.setItem("activeTabIndex","1")),v(t)}catch(e){console.error(e)}})()},[]);let f=(0,n.useRef)(null);return(0,n.useEffect)(()=>{f.current&&(0,K.x)(f.current)}),(null==i?void 0:i.name)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("header",{className:E().header,children:[(0,l.jsxs)("div",{className:E().info,children:[(0,l.jsx)(r.q,{shape:"circle",label:null==i?void 0:null===(e=i.name[0])||void 0===e?void 0:e.toUpperCase(),style:{backgroundColor:"#60A5FA"}}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{children:"".concat(null==i?void 0:i.name," ").concat(null==i?void 0:i.surname)}),(0,l.jsx)("small",{children:R(null==i?void 0:null===(t=i.role)||void 0===t?void 0:t.id)})]})]}),(0,l.jsx)(a.z,{icon:"pi pi-sign-out",severity:"info","aria-label":"User",onClick:()=>{localStorage.clear(),p.push("/login")}})]}),(0,l.jsx)(s.i,{}),(0,l.jsx)("main",{className:E().main,children:(0,l.jsxs)(o.f,{activeIndex:m,onTabChange:e=>y(e.index),children:[(null==h?void 0:h.includes("service.get_all"))&&(0,l.jsx)(o.x,{header:"Xidmətlər",children:(0,l.jsx)(G,{userPermissions:h,role:null==i?void 0:i.role})}),(null==h?void 0:h.includes("reservation.get_all"))&&(0,l.jsx)(o.x,{header:"Rezervlər",children:(0,l.jsx)(en,{userPermissions:h})}),(null==h?void 0:h.includes("report.get_all"))&&(0,l.jsx)(o.x,{header:"Kassa",children:(0,l.jsx)(eo,{userPermissions:h,role:null==i?void 0:i.role})}),(null==h?void 0:h.includes("reservation_time.get_all"))&&(0,l.jsx)(o.x,{header:"Rezerv saatları",children:(0,l.jsx)(et,{userPermissions:h})}),(null==h?void 0:h.includes("expense.get_all"))&&(0,l.jsx)(o.x,{header:"Xərclər",children:(0,l.jsx)(eu,{userPermissions:h})}),(null==h?void 0:h.includes("advance_transfer.get_all"))&&(0,l.jsx)(o.x,{header:"N\xf6vbələr",children:(0,l.jsx)(ea,{userPermissions:h})}),(null==h?void 0:h.includes("service_type.get_all"))&&(0,l.jsx)(o.x,{header:"Xidmət n\xf6vləri",children:(0,l.jsx)(M,{userPermissions:h})}),(null==h?void 0:h.includes("user.get_all"))&&(0,l.jsx)(o.x,{header:"İstifadə\xe7ilər",children:(0,l.jsx)(z,{userPermissions:h})}),(null==h?void 0:h.includes("service.bonus_reports"))&&(0,l.jsx)(o.x,{header:"Bonuslar",children:(0,l.jsx)($,{})}),(null==h?void 0:h.includes("action_log.get_all"))&&(0,l.jsx)(o.x,{header:"Loglar",children:(0,l.jsx)(er,{userPermissions:h})})]})}),(0,l.jsx)(c.F,{ref:f})]}):(0,l.jsx)(l.Fragment,{})}},1398:function(e,t,i){"use strict";i.d(t,{W:function(){return o},x:function(){return r}});var l=i(2126),n=i(6463);let s=null,r=e=>{s=e},a=l.Z.create({baseURL:"https://api.nargizestetik.az/api"});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),e}),a.interceptors.response.use(e=>null==e?void 0:e.data,async e=>{var t,i,l;return(e.response&&(null===(t=e.response)||void 0===t?void 0:t.data.message)==="USER_NOT_AUTHORIZED"?(localStorage.clear(),(0,n.redirect)("/login")):(e.response&&(null===(i=e.response)||void 0===i?void 0:i.data.message)||e.message)&&s&&s.show({severity:"error",summary:"Error",detail:(null===(l=e.response)||void 0===l?void 0:l.data.message)||e.message,life:3e3}),e&&e.response)?Promise.reject(e):Promise.reject()});let o=a},8518:function(e){e.exports={header:"page_header__oRW75",info:"page_info__8WZDv",main:"page_main__nw1Wk"}}},function(e){e.O(0,[851,651,754,567,666,971,23,744],function(){return e(e.s=1542)}),_N_E=e.O()}]);