(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9913:function(e,t,l){Promise.resolve().then(l.bind(l,7471))},2959:function(e,t,l){"use strict";var i=l(1398);t.Z={postLogin:e=>i.W.post("login",e),getSelfInfo:()=>i.W.get("users/self-info"),getServiceTypes:e=>{let{page:t,size:l}=e;return i.W.get("service-types?page=".concat(t,"&size=").concat(l))},deleteUser:e=>i.W.delete("users/".concat(e)),createUser:e=>i.W.post("users",e),updateUser:e=>{let{name:t,surname:l,email:s,roleId:r,password:n,password_repeat:a,id:o}=e;return i.W.put("users/".concat(o),{name:t,surname:l,email:s,roleId:r,password:n,password_repeat:a})},updateServiceType:e=>{let{id:t,name:l,price:s}=e;return i.W.put("service-types/".concat(t),{name:l,price:s})},createServiceType:e=>{let{name:t,price:l}=e;return i.W.post("service-types",{name:t,price:l})},deleteServiceType:e=>i.W.delete("service-types/".concat(e)),getUsers:e=>{let{page:t,size:l}=e;return i.W.get("users?page=".concat(t,"&size=").concat(l))},getServices:e=>{let{page:t,size:l,status:s,from_date:r,to_date:n,client_name:a,client_phone:o,service_types:d,user_id:c}=e;return i.W.get("services?page=".concat(t,"&size=").concat(l,"&sort=desc"),{params:{status:s,from_date:r,to_date:n,client_name:a,client_phone:o,service_types:d,user_id:c}})},getTotalAmount:e=>{let{status:t,from_date:l,to_date:s,client_name:r,client_phone:n,service_types:a,user_id:o}=e;return i.W.get("services/total-amounts",{params:{status:t,from_date:l,to_date:s,client_name:r,client_phone:n,service_types:a,user_id:o}})},getDoctors:()=>i.W.get("users/input-search"),getInputServices:()=>i.W.get("service-types/input-search"),createService:e=>i.W.post("services",e),updateService:e=>i.W.put("services/".concat(e.id),e),getDailyReportExcel:async e=>{try{await i.W.get("services/daily-report?excel_export=true&sorted_day=".concat(e),{responseType:"blob"}).then(t=>{{let l=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=window.URL.createObjectURL(l),s=document.createElement("a");s.href=i,s.setAttribute("download","daily_report_".concat(e,".xlsx")),document.body.appendChild(s),s.click(),document.body.removeChild(s)}})}catch(e){console.error("Error downloading the file",e)}},getAllReportsExcel:async e=>{let{status:t,from_date:l,to_date:s,client_name:r,client_phone:n,service_types:a,user_id:o}=e;try{await i.W.get("services/all-reports?excel_export=true&sort=desc",{responseType:"blob",params:{status:t,from_date:l,to_date:s,client_name:r,client_phone:n,service_types:a,user_id:o}}).then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=window.URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.setAttribute("download","general_report_".concat(l,"/").concat(s,".xlsx")),document.body.appendChild(r),r.click(),document.body.removeChild(r)})}catch(e){console.error("Error downloading the file",e)}},getBonuses:e=>{let{from_date:t,to_date:l,user_id:s}=e;return i.W.get("services/bonus-reports",{params:{from_date:t,to_date:l,user_id:s}})},getBonusesExcel:async e=>{let{from_date:t,to_date:l,user_id:s}=e;try{await i.W.get("services/bonus-reports?excel_export=true",{responseType:"blob",params:{from_date:t,to_date:l,user_id:s}}).then(e=>{let i=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.setAttribute("download","bonus_report_".concat(t,"/").concat(l,".xlsx")),document.body.appendChild(r),r.click(),document.body.removeChild(r)})}catch(e){console.error("Error downloading the file",e)}}}},7471:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return K}});var i=l(7437),s=l(2265),r=l(2102),n=l(2160),a=l(8708),o=l(5012),d=l(6463),c=l(2502),u=l(2959),m=l(8787),p=l(2193),v=l(5472),h=function(e){let{userDeleteDialog:t,setUserDeleteDialog:l,user:r,showSuccess:n,setUsers:o}=e,d=(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>l(!1)}),(0,i.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{o(e=>e.filter(e=>e.id!==(null==r?void 0:r.id)));try{u.Z.deleteUser(null==r?void 0:r.id),l(!1),n("Service type has been successfully deleted")}catch(e){console.error(e)}}})]});return(0,i.jsx)(v.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>l(!1),children:(0,i.jsxs)("div",{className:"confirmation-content",children:[(0,i.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),r&&(0,i.jsxs)("span",{children:["Are you sure you want to delete"," ",(0,i.jsxs)("b",{children:[null==r?void 0:r.name," ",null==r?void 0:r.surname]}),"?"]})]})})},x=l(8861),y=l(9343),f=l(4245),j=l(7753),g=l(5313),w=l(6498),_=l(7039);let b=[{id:2,name:"Admin"},{id:3,name:"Cashier"},{id:4,name:"Doctor"}],S=[{id:0,name:"Cash"},{id:1,name:"Card"}],C=[{id:0,name:"New"},{id:1,name:"Accepted"},,{id:2,name:"Rejected"}];var R=function(e){let{user:t,userEditDialog:l,setUserEditDialog:r,setUsers:n,showSuccess:o}=e,d=f.Ry().shape({name:f.Z_().required(),surname:f.Z_().required(),email:f.Z_().email("Invalid email").required(),roleId:f.Rx().required(),password:(null==t?void 0:t.id)?f.Z_():f.Z_().required(),password_repeat:f.Z_().oneOf([f.iH("password")],"Passwords must match")}),{control:c,handleSubmit:m,formState:{errors:p},setValue:h,reset:S}=(0,y.cI)({resolver:(0,j.X)(d),defaultValues:{name:void 0,surname:void 0,email:void 0,roleId:void 0,password:(null==t?void 0:t.id)?void 0:"",password_repeat:(null==t?void 0:t.id)?void 0:""}}),[C,R]=(0,s.useState)(void 0),Z=async e=>{try{let{data:l}=(null==t?void 0:t.id)?await u.Z.updateUser({...e,id:t.id}):await u.Z.createUser(e);n(e=>[l,...e]),o("User has been successfully ".concat((null==t?void 0:t.id)?"created":"updated")),r(!1)}catch(e){console.error(e)}};return(0,s.useEffect)(()=>{if(null==t?void 0:t.id){var e;h("name",t.name),h("surname",t.surname),h("email",t.email),h("roleId",null===(e=t.role)||void 0===e?void 0:e.id),R(b.find(e=>{var l;return e.id===(null===(l=t.role)||void 0===l?void 0:l.id)}))}},[t,h]),(0,i.jsx)(v.V,{visible:l,style:{width:"328px"},header:"İstifadə\xe7i məlumatları",modal:!0,onHide:()=>{r(!1),S(),R(void 0)},children:t&&(0,i.jsxs)("form",{onSubmit:m(Z),style:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,i.jsx)(y.Qr,{name:"name",control:c,render:e=>{let{field:t}=e;return(0,i.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!p.name,...t})}}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Soyad:"}),(0,i.jsx)(y.Qr,{name:"surname",control:c,render:e=>{let{field:t}=e;return(0,i.jsx)(x.o,{style:{marginBottom:"10px"},id:"surname",invalid:!!p.surname,...t})}}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Email:"}),(0,i.jsx)(y.Qr,{name:"email",control:c,render:e=>{let{field:t}=e;return(0,i.jsx)(x.o,{style:{marginBottom:"10px"},id:"email",invalid:!!p.email,...t})}}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Rol:"}),(0,i.jsx)(y.Qr,{name:"roleId",control:c,render:e=>{let{field:t}=e;return(0,i.jsx)(_.L,{style:{marginBottom:"10px"},value:C,onChange:e=>{R(e.value),h("roleId",e.value.id)},options:b,optionLabel:"name",placeholder:"Rol se\xe7in",className:"w-full md:w-14rem",invalid:!!p.roleId})}}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"password",children:"Şifrə:"}),(0,i.jsx)(y.Qr,{name:"password",control:c,render:e=>{let{field:t}=e;return(0,i.jsx)(w.r,{style:{marginBottom:"10px",width:"200px"},id:"password",toggleMask:!0,feedback:!1,invalid:!!p.password,...t})}}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"password_repeat",children:"Şifrənin təstiqi:"}),(0,i.jsx)(y.Qr,{name:"password_repeat",control:c,render:e=>{let{field:t}=e;return(0,i.jsx)(w.r,{style:{marginBottom:"10px",width:"200px"},toggleMask:!0,feedback:!1,id:"password_repeat",invalid:!!p.password_repeat,...t})}}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("div",{children:p.password_repeat&&(0,i.jsx)(g.v,{style:{maxWidth:"180px",height:"45px"},severity:"error",text:"Şifrələr eyni deyil"})}),(0,i.jsx)(a.z,{label:"Save",type:"submit",style:{display:"flex"}})]})]})})},Z=l(5565);let B=e=>{var t;return null===(t=b.find(t=>t.id===e))||void 0===t?void 0:t.name},k=e=>{let t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(l,"-").concat(i)};var E=function(e){let{userPermissions:t}=e,[l,r]=(0,s.useState)([]),[n,o]=(0,s.useState)({}),[d,v]=(0,s.useState)(!1),[x,y]=(0,s.useState)(!1),[f,j]=(0,s.useState)(0),[g,w]=(0,s.useState)(10),_=(0,s.useRef)(null),b=e=>{var t;null===(t=_.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},S=e=>{o(e),v(!0)},C=e=>{o(e),y(!0)},k=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:l}=await u.Z.getUsers({page:e,size:g});r(t),j(null==l?void 0:l.total)}catch(e){console.error(e)}};(0,s.useEffect)(()=>{k()},[]);let E=(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(null==t?void 0:t.includes("user.create"))&&(0,i.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>v(!0)})});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(p.w,{value:l,editMode:"row",dataKey:"id",header:E,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},children:[(0,i.jsx)(m.s,{field:"name",header:"Ad",style:{width:"20%"}}),(0,i.jsx)(m.s,{field:"surname",header:"Soyad",style:{width:"20%"}}),(0,i.jsx)(m.s,{field:"email",header:"Mail",style:{width:"20%"}}),(0,i.jsx)(m.s,{field:"role",body:e=>(0,i.jsx)("div",{children:B(e.role.id)}),header:"Rol",style:{width:"20%"}}),(0,i.jsx)(m.s,{body:e=>(0,i.jsxs)(s.Fragment,{children:[(null==t?void 0:t.includes("user.update"))&&(0,i.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>S(e)}),(null==t?void 0:t.includes("user.delete"))&&(0,i.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>C(e)})]}),exportable:!1,style:{width:"20%"}})]}),(0,i.jsx)(Z.D,{rows:g,totalRecords:f,onPageChange:e=>{k(e.page+1)}}),(0,i.jsx)(c.F,{ref:_}),(0,i.jsx)(h,{user:n,userDeleteDialog:x,setUserDeleteDialog:y,setUsers:r,showSuccess:b}),(0,i.jsx)(R,{user:n,setUsers:r,userEditDialog:d,setUserEditDialog:v,showSuccess:b})]})},F=l(8518),D=l.n(F),N=l(891),A=function(e){let{dialog:t,setDialog:l,showSuccess:s,setServicesTypes:r}=e,{control:n,handleSubmit:o,formState:{errors:d},reset:c}=(0,y.cI)(),m=async e=>{let{name:t,price:i}=e;i=i||0;try{let{data:e}=await u.Z.createServiceType({name:t,price:i});r(t=>[...t,e]),s("Service type has been successfully created"),l(!1),c()}catch(e){console.error(e)}};return(0,i.jsx)(v.V,{visible:t,style:{width:"25rem"},header:"Xidmət n\xf6v\xfc",modal:!0,onHide:()=>l(!1),children:(0,i.jsxs)("form",{onSubmit:o(m),style:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,i.jsx)(y.Qr,{name:"name",control:n,rules:{required:!0},render:e=>{let{field:t}=e;return(0,i.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!(null==d?void 0:d.name),...t})}}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Qiymət:"}),(0,i.jsx)(y.Qr,{name:"price",control:n,render:e=>{let{field:t}=e;return(0,i.jsx)(N.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px"},invalid:!!d.price})}}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)(a.z,{label:"Save",type:"submit"})})]})})},z=function(e){let{serviceType:t,deleteDialog:l,setDeleteDialog:r,setServicesTypes:n,showSuccess:o}=e,d=(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>r(!1)}),(0,i.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{n(e=>e.filter(e=>e.id!==(null==t?void 0:t.id)));try{u.Z.deleteServiceType(null==t?void 0:t.id),r(!1),o("Service type has been successfully deleted")}catch(e){console.error(e)}}})]});return(0,i.jsx)(v.V,{visible:l,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>r(!1),children:(0,i.jsxs)("div",{className:"confirmation-content",children:[(0,i.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),t&&(0,i.jsxs)("span",{children:["Are you sure you want to delete ",(0,i.jsx)("b",{children:null==t?void 0:t.name}),"?"]})]})})},W=function(e){let{userPermissions:t}=e,[l,r]=(0,s.useState)(),[n,o]=(0,s.useState)(!1),[d,v]=(0,s.useState)([]),[h,y]=(0,s.useState)(0),[f,j]=(0,s.useState)(10),[g,w]=(0,s.useState)(!1),_=(0,s.useRef)(null),b=e=>{var t;null===(t=_.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},S=e=>(0,i.jsx)(N.R,{value:e.value,onValueChange:t=>e.editorCallback(t.value),mode:"currency",currency:"AZN",locale:"de-DE"}),C=e=>(0,i.jsx)(x.o,{type:"text",value:e.value,onChange:t=>e.editorCallback(t.target.value)}),R=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:l}=await u.Z.getServiceTypes({page:e,size:f});v(t),y(null==l?void 0:l.total)}catch(e){console.error(e)}};(0,s.useEffect)(()=>{R()},[]);let B=e=>{r(e),o(!0)},k=(null==t?void 0:t.includes("service_type.create"))&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>w(!0)})});return(0,i.jsxs)("div",{children:[(0,i.jsxs)(p.w,{value:d,editMode:"row",dataKey:"id",onRowEditComplete:e=>{let{newData:t}=e,{id:l,name:i,price:s}=t;s=s||0;try{u.Z.updateServiceType({id:l,name:i,price:s});let e={...t,name:i,price:s,id:l},r=d.map(t=>t.id===e.id?e:t);v(r),b("Service type has been successfully updated")}catch(e){console.error(e)}},tableStyle:{minWidth:"50rem"},header:k,style:{marginBottom:"10px"},children:[(0,i.jsx)(m.s,{field:"name",header:"Ad",editor:e=>C(e),style:{width:"40%"}}),(0,i.jsx)(m.s,{field:"price",header:"Qiymət",body:e=>{var t,l;let i=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.price),s=null!==(l=null===(t=i.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==l?l:"AZN",r=i.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(s)},editor:e=>S(e),style:{width:"40%"}}),(null==t?void 0:t.includes("service_type.update"))&&(0,i.jsx)(m.s,{rowEditor:e=>(null==e?void 0:e.name)!=="Blue Band",headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),(null==t?void 0:t.includes("service_type.delete"))&&(0,i.jsx)(m.s,{body:e=>(0,i.jsx)(s.Fragment,{children:(0,i.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>B(e)})}),exportable:!1,style:{width:"1%"}})]}),(0,i.jsx)(Z.D,{rows:f,totalRecords:h,onPageChange:e=>{R(e.page+1)}}),(0,i.jsx)(c.F,{ref:_}),(0,i.jsx)(A,{dialog:g,setDialog:w,showSuccess:b,setServicesTypes:v}),(0,i.jsx)(z,{serviceType:l,deleteDialog:n,setDeleteDialog:o,setServicesTypes:v,showSuccess:b})]})},I=l(9749),T=l(686),U=l(1572),L=l(1395),O=e=>{let{dialog:t,setDialog:l,userPermissions:r,showSuccess:n,getServices:o,service:d,setService:c}=e,[m,p]=(0,s.useState)(),[h,g]=(0,s.useState)(),[w,b]=(0,s.useState)(S.find(e=>0===e.id)),[R,Z]=(0,s.useState)(),[B,k]=(0,s.useState)(),[E,F]=(0,s.useState)(!1),[D,A]=(0,s.useState)(),z=f.Ry().shape({service_types:f.IX().of(f.Ry().shape({id:f.Rx().required()})).required(),client_name:f.Z_().required(),client_phone:r.includes("service.variable.phone")?f.Z_().required():f.Z_(),amount:r.includes("service.variable.amount")?f.Rx().required():f.Rx(),payment_type:r.includes("service.variable.payment_type")?f.Rx().required():f.Rx(),user_id:r.includes("service.variable.user_id")?f.Rx().required():f.Rx(),reject_comment:(null==R?void 0:R.id)===2&&r.includes("service.variable.reject_comment")?f.Z_().required():f.Z_().nullable()}),{control:W,handleSubmit:I,formState:{errors:O},setValue:M,reset:q}=(0,y.cI)({resolver:(0,j.X)(z),defaultValues:{payment_type:r.includes("service.variable.payment_type")?0:void 0}}),Q=async e=>{F(!0);try{var t,i;(null==d?void 0:d.id)?await u.Z.updateService({...e,id:d.id,client_phone:null===(t=e.client_phone)||void 0===t?void 0:t.toString().replace(/[\s-]/g,"")}):await u.Z.createService({...e,client_phone:null===(i=e.client_phone)||void 0===i?void 0:i.toString().replace(/[\s-]/g,"")}),n("Service has been successfull created"),o(),l(!1)}catch(e){console.error(e)}finally{F(!1)}};(0,s.useEffect)(()=>{if(null==d?void 0:d.id){var e,t,l;M("client_name",d.client_name),M("client_phone",d.client_phone),M("user_id",null===(e=d.user)||void 0===e?void 0:e.id),M("service_types",null===(t=d.service_types)||void 0===t?void 0:t.map(e=>({id:e.id}))),M("amount",+d.amount),M("payment_type",d.payment_type||0),M("reject_comment",d.reject_comment);let i=()=>0!==d.status?C.find(e=>(null==e?void 0:e.id)===d.status):{id:1,name:"Accepted"};M("status",null===(l=i())||void 0===l?void 0:l.id),Z(i),g(null==B?void 0:B.find(e=>{var t;return e.id===(null===(t=d.user)||void 0===t?void 0:t.id)})),b(S.find(e=>e.id===d.payment_type)),p(d.service_types)}},[d,M,B]),(0,s.useEffect)(()=>{(async()=>{if(r.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();k(e)}if(r.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();A(e)}})()},[]);let V=e=>{let t=e.value;p(t),M("service_types",t.map(e=>({id:e.id}))),M("amount",t.reduce((e,t)=>e+ +t.price,0))};return(0,i.jsx)(v.V,{visible:t,modal:!0,onHide:()=>{l(!1),q(),c(void 0),p(void 0),g(void 0),b(S.find(e=>0===e.id)),Z(void 0)},style:{maxWidth:"500px",width:"100%"},children:(0,i.jsxs)("form",{onSubmit:I(Q),style:{display:"flex",flexDirection:"column"},children:[r.includes("service.variable.client_name")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"M\xfcştəri adı:"}),(0,i.jsx)(y.Qr,{name:"client_name",control:W,render:e=>{let{field:t}=e;return(0,i.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!O.client_name,...t})}})]}),r.includes("service.variable.phone")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Telefon:"}),(0,i.jsx)(y.Qr,{name:"client_phone",control:W,rules:{minLength:12},render:e=>{let{field:t}=e;return(0,i.jsx)(T.v,{style:{marginBottom:"10px"},id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!O.client_phone,...t})}})]}),r.includes("service.variable.user_id")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Həkim:"}),(0,i.jsx)(y.Qr,{name:"user_id",control:W,render:e=>{let{field:t}=e;return(0,i.jsx)(_.L,{filter:!0,style:{marginBottom:"10px"},value:h,onChange:e=>{g(e.value),M("user_id",e.value.id)},optionLabel:"full_name",options:B,placeholder:"Doktor se\xe7in",invalid:!!O.user_id})}})]}),r.includes("service.variable.service_type_id")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Xidmət:"}),(0,i.jsx)(y.Qr,{name:"service_types",control:W,render:e=>{let{field:t}=e;return(0,i.jsx)(L.N,{style:{marginBottom:"10px"},value:m,onChange:V,options:D,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full md:w-20rem",invalid:!!O.service_types})}})]}),(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Məbləğ:"}),(0,i.jsx)(y.Qr,{name:"amount",control:W,render:e=>{let{field:t}=e;return(0,i.jsx)(N.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px"},invalid:!!O.amount})}}),r.includes("service.variable.reject_comment")&&(null==R?void 0:R.id)===2&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Reject comment:"}),(0,i.jsx)(y.Qr,{name:"reject_comment",control:W,rules:{required:!0},render:e=>{var t;let{field:l}=e;return(0,i.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!O.reject_comment,...l,value:null!==(t=l.value)&&void 0!==t?t:""})}})]}),r.includes("service.variable.payment_type")&&(0,i.jsx)("div",{style:{display:"flex",marginBottom:"10px"},children:S.map(e=>(0,i.jsxs)("div",{children:[(0,i.jsx)(U.E,{inputId:null==e?void 0:e.name,name:"payment",value:e,onChange:e=>{b(e.value),M("payment_type",e.value.id)},checked:(null==w?void 0:w.id)===e.id}),(0,i.jsx)("label",{htmlFor:null==e?void 0:e.name,style:{marginRight:"10px",marginLeft:"4px"},children:null==e?void 0:e.name})]},e.id))}),r.includes("service.variable.status")&&(null==d?void 0:d.id)&&(0,i.jsx)("div",{style:{display:"flex",marginBottom:"10px"},children:C.map(e=>(null==e?void 0:e.id)!==0&&(0,i.jsxs)("div",{children:[(0,i.jsx)(U.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{Z(e.value),M("status",e.value.id)},checked:(null==R?void 0:R.id)===(null==e?void 0:e.id)}),(0,i.jsx)("label",{htmlFor:null==e?void 0:e.name,style:{marginRight:"10px",marginLeft:"4px"},children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)(a.z,{label:"Save",disabled:E,type:"submit"})})]})})},M=l(7332),q=e=>{let{dialog:t,setDialog:l}=e,[r,n]=(0,s.useState)(new Date),[o,d]=(0,s.useState)([new Date,new Date]),[c,m]=(0,s.useState)([new Date,new Date]);return(0,i.jsx)(v.V,{header:"Reports",visible:t,onHide:()=>{t&&l(!1)},children:(0,i.jsx)("div",{style:{minWidth:"40vw",display:"flex",flexDirection:"column"},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:[(0,i.jsx)(M.f,{value:r,onChange:e=>n(e.value),style:{width:"170px"},showIcon:!0,dateFormat:"dd/mm/yy"}),(0,i.jsx)(a.z,{severity:"success",label:"Export",icon:"pi pi-upload",style:{width:"180px"},onClick:()=>u.Z.getDailyReportExcel(k(r))})]})})})},Q=l(8541),V=l(1857),H=function(e){let{userPermissions:t}=e,[l,r]=(0,s.useState)([]),[n,o]=(0,s.useState)(null),[d,h]=(0,s.useState)(),[y,f]=(0,s.useState)(),[j,w]=(0,s.useState)(),[b,S]=(0,s.useState)(),[R,B]=(0,s.useState)(!1),[E,F]=(0,s.useState)(!1),[D,A]=(0,s.useState)(!1),[z,W]=(0,s.useState)(!1),[T,U,H]=(0,V.Nr)("",400),[P,X]=(0,s.useState)(),[K,Y,G]=(0,V.Nr)(null,400),[J,$]=(0,s.useState)(),[ee,et]=(0,s.useState)(0),[el,ei]=(0,s.useState)(0),[es,er]=(0,s.useState)(10),[en,ea]=(0,s.useState)(!1),[eo,ed]=(0,s.useState)(),[ec,eu]=(0,s.useState)([new Date,new Date]),em=(0,s.useRef)(null),ep=(0,s.useRef)(null),ev=e=>{w(e),B(!0)},eh=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,l=arguments.length>1?arguments[1]:void 0;ea(!0);try{let{data:l,meta:i}=await u.Z.getServices({page:e,size:es,status:null==n?void 0:n.id,from_date:k(ec[0]),to_date:k(ec[1]),client_name:U,client_phone:Y,service_types:null==P?void 0:P.map(e=>e.id),user_id:null==b?void 0:b.id});if(r(l),ei(null==i?void 0:i.total),t.includes("service.get_all.total_amount")){let e=await u.Z.getTotalAmount({status:null==n?void 0:n.id,from_date:k(ec[0]),to_date:k(ec[1]),client_name:U,client_phone:Y,service_types:null==P?void 0:P.map(e=>e.id),user_id:null==b?void 0:b.id});ed(e)}}catch(e){console.error(e)}finally{var i;ea(!1),l&&(null===(i=ep.current)||void 0===i||i.scrollIntoView({behavior:"smooth"}))}};(0,s.useEffect)(()=>{ec[1]&&eh()},[null==n?void 0:n.name,ec[1],U,Y,null==P?void 0:P.length,b]),(0,s.useEffect)(()=>{(async()=>{if(t.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();f(e)}if(t.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();h(e)}})()},[]);let ex=t.includes("service.create")&&(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsxs)("div",{children:[t.includes("service.all_reports")&&(0,i.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>F(e=>!e),style:{marginRight:"20px"}}),(0,i.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>eh()})]}),(0,i.jsxs)("div",{children:[t.includes("service.all_reports")&&!!l.length&&(0,i.jsx)(a.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:()=>{u.Z.getAllReportsExcel({status:null==n?void 0:n.id,from_date:k(ec[0]),to_date:k(ec[1]),client_name:U,client_phone:Y,service_types:null==P?void 0:P.map(e=>e.id),user_id:null==b?void 0:b.id})},style:{marginRight:"10px"}}),t.includes("service.daily_report")&&(0,i.jsx)(a.z,{label:"G\xfcn sonu",icon:"pi pi-file-excel",severity:"success",onClick:()=>A(!0),style:{marginRight:"10px"}}),(0,i.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>B(!0)})]})]}),ey=e=>{switch(e){case"Rejected":return"danger";case"Accepted":return"success";case"New":return"info"}},ef=e=>(0,i.jsx)(I.V,{value:e.name,severity:ey(e.name)}),ej=(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"ml-2",children:["Nağd: ",null==eo?void 0:eo.cash," AZN"]}),(0,i.jsxs)("div",{className:"ml-2",children:["Kart: ",null==eo?void 0:eo.pos," AZN"]}),(0,i.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==eo?void 0:eo.total," AZN"]})]});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(p.w,{value:l,dataKey:"id",header:ex,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},filterDisplay:E?"row":void 0,children:[(0,i.jsx)(m.s,{body:(e,t)=>en?(0,i.jsx)(Q.O,{width:"20px"}):(0,i.jsx)("div",{children:el-t.rowIndex-ee}),header:"#",style:{width:"2%"}}),(0,i.jsx)(m.s,{dataType:"date",header:"Tarix",body:e=>en?(0,i.jsx)(Q.O,{width:"100px"}):e.created_at.split(" ")[0],style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>(0,i.jsx)(M.f,{value:ec,onChange:e=>eu(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,i.jsx)(m.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:()=>(0,i.jsx)(x.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:T,onChange:e=>H(e.target.value)}),showFilterMenu:!1,body:e=>en?(0,i.jsx)(Q.O,{width:"150px"}):(0,i.jsx)("div",{children:e.client_name})}),t.includes("service.variable.select_phone")&&(0,i.jsx)(m.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:()=>(0,i.jsx)(N.R,{style:{width:"180px"},id:"client_phone",placeholder:"+994 99 999-99-99",value:K,onChange:e=>G(e.value),prefix:"+",useGrouping:!1}),showFilterMenu:!1,body:e=>en?(0,i.jsx)(Q.O,{width:"150px"}):(0,i.jsx)("div",{children:e.client_phone})}),(0,i.jsx)(m.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,filter:t.includes("service.variable.service_type_id"),filterElement:()=>(0,i.jsx)(L.N,{filter:!0,value:P,onChange:e=>{X(e.value)},options:d,placeholder:"Xidmət se\xe7in",optionLabel:"name",showClear:!0}),body:e=>en?(0,i.jsx)(Q.O,{width:"150px"}):(0,i.jsx)("div",{children:e.service_types.map(e=>(0,i.jsx)("div",{children:e.name}))})}),(0,i.jsx)(m.s,{header:"Həkim",body:e=>{var t,l;return en?(0,i.jsx)(Q.O,{width:"150px"}):"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(l=e.user)||void 0===l?void 0:l.surname)},style:{width:"10%"},showFilterMenu:!1,filter:t.includes("service.variable.user_id"),filterElement:()=>(0,i.jsx)(_.L,{filter:!0,value:b,onChange:e=>{S(e.value)},options:y,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0})}),(0,i.jsx)(m.s,{header:"Məbləğ",body:e=>{var t,l;let s=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.amount),r=null!==(l=null===(t=s.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==l?l:"AZN",n=s.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return en?(0,i.jsx)(Q.O,{width:"100px"}):"".concat(n," ").concat(r)},style:{width:"10%"}}),(0,i.jsx)(m.s,{header:"Status",body:e=>{var t;let l=null===(t=C.find(t=>(null==t?void 0:t.id)===e.status))||void 0===t?void 0:t.name;return en?(0,i.jsx)(Q.O,{width:"150px"}):(0,i.jsx)(I.V,{onClick:()=>{"Rejected"===l&&($(e.reject_comment),W(!0))},icon:"Rejected"===l&&"pi pi-info-circle",value:l,severity:ey(l)})},style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>(0,i.jsx)(_.L,{value:n,options:C,onChange:e=>{o(e.value)},itemTemplate:ef,placeholder:"Select one",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"})}),t.includes("service.update")&&(0,i.jsx)(m.s,{body:e=>en?(0,i.jsx)(Q.O,{height:"30px"}):(0,i.jsx)(s.Fragment,{children:(0,i.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>ev(e)})}),exportable:!1,style:{width:"2%"}})]}),(0,i.jsx)("div",{ref:ep,children:(0,i.jsx)(Z.D,{first:ee,rows:es,totalRecords:el,onPageChange:e=>{et(e.first),eh(e.page+1,!0)}})}),t.includes("service.get_all.total_amount")&&(0,i.jsx)(g.v,{style:{border:"solid #696cff",borderWidth:"0 0 0 6px",marginTop:"20px"},severity:"info",content:ej}),(0,i.jsx)(c.F,{ref:em}),(0,i.jsx)(O,{userPermissions:t,dialog:R,setDialog:B,showSuccess:e=>{var t;null===(t=em.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},service:j,setService:w,getServices:eh}),(0,i.jsx)(q,{dialog:D,setDialog:A}),(0,i.jsx)(v.V,{header:"Reject comment",visible:z,style:{width:"50vw"},onHide:()=>{z&&(W(!1),$(""))},children:(0,i.jsx)("p",{className:"m-0",children:J})})]})},P=l(1398),X=function(){let[e,t]=(0,s.useState)(),[l,r]=(0,s.useState)([new Date,new Date]),[n,o]=(0,s.useState)(),[d,c]=(0,s.useState)(),v=async()=>{try{let{data:e}=await u.Z.getBonuses({from_date:k(l[0]),to_date:k(l[1]),user_id:null==d?void 0:d.id});t(e)}catch(e){console.error(e)}};(0,s.useEffect)(()=>{l[1]&&v()},[l[1],d]),(0,s.useEffect)(()=>{(async()=>{let{data:e}=await u.Z.getDoctors();o(e)})()},[]);let h=(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(M.f,{value:l,onChange:e=>r(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px",marginRight:"10px"},dateFormat:"dd/mm/yy"}),(0,i.jsx)(_.L,{filter:!0,style:{marginBottom:"10px"},value:d,onChange:e=>{c(e.value)},options:n,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0})]}),(0,i.jsx)(a.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:()=>{u.Z.getBonusesExcel({from_date:k(l[0]),to_date:k(l[1]),user_id:null==d?void 0:d.id})},style:{marginRight:"10px"}})]});return(0,i.jsx)("div",{children:(0,i.jsxs)(p.w,{value:e,editMode:"row",dataKey:"id",tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},header:h,children:[(0,i.jsx)(m.s,{body:e=>{var t,l;return"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(l=e.user)||void 0===l?void 0:l.surname)},header:"Həkim",style:{width:"40%"}}),(0,i.jsx)(m.s,{field:"total_amount",header:"Toplam məbləğ",body:e=>{var t,l;let i=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.total_amount),s=null!==(l=null===(t=i.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==l?l:"AZN",r=i.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(s)},style:{width:"40%"}})]})})},K=function(){var e,t;let[l,m]=(0,s.useState)(),p=(0,d.useRouter)(),v=null==l?void 0:l.role.permissions.map(e=>null==e?void 0:e.name);(0,s.useEffect)(()=>{localStorage.getItem("token")||p.push("/login")},[p]),(0,s.useEffect)(()=>{(async()=>{try{let{data:e}=await u.Z.getSelfInfo();m(e)}catch(e){console.error(e)}})()},[]);let h=(0,s.useRef)(null);return(0,s.useEffect)(()=>{h.current&&(0,P.x)(h.current)}),(null==l?void 0:l.name)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("header",{className:D().header,children:[(0,i.jsxs)("div",{className:D().info,children:[(0,i.jsx)(n.q,{shape:"circle",label:null==l?void 0:null===(e=l.name[0])||void 0===e?void 0:e.toUpperCase(),style:{backgroundColor:"#60A5FA"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:"".concat(null==l?void 0:l.name," ").concat(null==l?void 0:l.surname)}),(0,i.jsx)("small",{children:B(null==l?void 0:null===(t=l.role)||void 0===t?void 0:t.id)})]})]}),(0,i.jsx)(a.z,{icon:"pi pi-sign-out",severity:"info","aria-label":"User",onClick:()=>{localStorage.clear(),p.push("/login")}})]}),(0,i.jsx)(r.i,{}),(0,i.jsx)("main",{className:D().main,children:(0,i.jsxs)(o.f,{children:[(null==v?void 0:v.includes("service.get_all"))&&(0,i.jsx)(o.x,{header:"Xidmətlər",children:(0,i.jsx)(H,{userPermissions:v})}),(null==v?void 0:v.includes("service_type.get_all"))&&(0,i.jsx)(o.x,{header:"Xidmət n\xf6vləri",children:(0,i.jsx)(W,{userPermissions:v})}),(null==v?void 0:v.includes("user.get_all"))&&(0,i.jsx)(o.x,{header:"İstifadə\xe7ilər",children:(0,i.jsx)(E,{userPermissions:v})}),(null==v?void 0:v.includes("service.bonus_reports"))&&(0,i.jsx)(o.x,{header:"Bonuslar",children:(0,i.jsx)(X,{})})]})}),(0,i.jsx)(c.F,{ref:h})]}):(0,i.jsx)(i.Fragment,{})}},1398:function(e,t,l){"use strict";l.d(t,{W:function(){return o},x:function(){return n}});var i=l(2126),s=l(6463);let r=null,n=e=>{r=e},a=i.Z.create({baseURL:"https://api.nargizestetik.az/api"});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),e}),a.interceptors.response.use(e=>e.data,async e=>(e.response&&"USER_NOT_AUTHORIZED"===e.response.data.message?(localStorage.clear(),(0,s.redirect)("/login")):(e.response&&e.response.data.message||e.message)&&r&&r.show({severity:"error",summary:"Error",detail:e.message||e.response.data.message,life:3e3}),e&&e.response)?Promise.reject(e):Promise.reject());let o=a},8518:function(e){e.exports={header:"page_header__oRW75",info:"page_info__8WZDv",main:"page_main__nw1Wk"}}},function(e){e.O(0,[851,651,754,567,891,971,23,744],function(){return e(e.s=9913)}),_N_E=e.O()}]);