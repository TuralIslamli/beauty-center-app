(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1542:function(e,l,i){Promise.resolve().then(i.bind(i,5447))},5447:function(e,l,i){"use strict";i.r(l),i.d(l,{default:function(){return ed}});var a=i(7437),t=i(2265),s=i(2102),n=i(2160),r=i(8708),d=i(5012),o=i(6463),c=i(2502),u=i(2959),v=i(7126),m=i(1398),h=i(8787),x=i(2193),p=i(5565),f=i(2163),j=i(1780),b=i(323),_=e=>{let{visible:l,onHide:i,user:s,onSuccess:n,setUsers:r}=e,d=(0,t.useCallback)(async()=>{if(null==s?void 0:s.id)try{await u.Z.deleteUser(s.id),r(e=>e.filter(e=>e.id!==s.id)),i(),n("İstifadə\xe7i uğurla silindi")}catch(e){console.error("Failed to delete user:",e)}},[null==s?void 0:s.id,r,i,n]);return(0,a.jsx)(b.QH,{visible:l,onHide:i,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==s?void 0:s.name," ").concat(null==s?void 0:s.surname,'" istifadə\xe7isini silmək istədiyinizə əminsiniz?')})},y=i(5472),g=i(8861),w=i(6498),C=i(7039),k=i(5313),S=i(9343),N=i(4245),F=i(7753),Z=e=>{let{user:l,visible:i,onHide:s,setUsers:n,onSuccess:d}=e,[o,c]=(0,t.useState)(),[v,m]=(0,t.useState)(),h=N.Ry().shape({name:N.Z_().required(),surname:N.Z_().required(),email:N.Z_().email("Yanlış email").required(),roleId:N.Rx().required(),password:(null==l?void 0:l.id)?N.Z_():N.Z_().required(),password_repeat:N.Z_().oneOf([N.iH("password")],"Şifrələr eyni olmalıdır"),customer_visible:N.O7(),day_off:N.Rx()}),{control:x,handleSubmit:p,formState:{errors:_},setValue:Z,reset:E}=(0,S.cI)({resolver:(0,F.X)(h),defaultValues:{name:void 0,surname:void 0,email:void 0,roleId:void 0,password:(null==l?void 0:l.id)?void 0:"",password_repeat:(null==l?void 0:l.id)?void 0:"",customer_visible:!1,day_off:void 0}}),R=(0,t.useCallback)(()=>{s(),E(),c(void 0),m(void 0)},[s,E]),T=(0,t.useCallback)(async e=>{try{let{data:i}=(null==l?void 0:l.id)?await u.Z.updateUser({...e,id:l.id}):await u.Z.createUser(e);n(e=>(null==l?void 0:l.id)?e.map(e=>e.id===i.id?i:e):[i,...e]),d("İstifadə\xe7i uğurla ".concat((null==l?void 0:l.id)?"yeniləndi":"yaradıldı")),R()}catch(e){console.error("Failed to save user:",e)}},[null==l?void 0:l.id,n,d,R]);return(0,t.useEffect)(()=>{if(null==l?void 0:l.id){var e,i;Z("name",l.name),Z("surname",l.surname),Z("email",l.email),Z("roleId",null===(e=l.role)||void 0===e?void 0:e.id),Z("customer_visible",null!==(i=l.customer_visible)&&void 0!==i&&i),Z("day_off",l.day_off),c(j.uJ.find(e=>{var i;return e.id===(null===(i=l.role)||void 0===i?void 0:i.id)})),m(j.en.find(e=>e.id===l.day_off))}},[l,Z]),(0,a.jsx)(y.V,{visible:i,style:{width:"328px"},header:"İstifadə\xe7i məlumatları",modal:!0,onHide:R,children:l&&(0,a.jsxs)("form",{onSubmit:p(T),className:"dialog-form",children:[(0,a.jsx)(b.Wi,{label:"Ad:",htmlFor:"name",children:(0,a.jsx)(S.Qr,{name:"name",control:x,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"name",invalid:!!_.name,...l})}})}),(0,a.jsx)(b.Wi,{label:"Soyad:",htmlFor:"surname",children:(0,a.jsx)(S.Qr,{name:"surname",control:x,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"surname",invalid:!!_.surname,...l})}})}),(0,a.jsx)(b.Wi,{label:"Email:",htmlFor:"email",children:(0,a.jsx)(S.Qr,{name:"email",control:x,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"email",invalid:!!_.email,...l})}})}),(0,a.jsx)(b.Wi,{label:"Rol:",htmlFor:"roleId",children:(0,a.jsx)(S.Qr,{name:"roleId",control:x,render:()=>(0,a.jsx)(C.L,{value:o,onChange:e=>{c(e.value),Z("roleId",e.value.id)},options:j.uJ,optionLabel:"name",placeholder:"Rol se\xe7in",className:"w-full",invalid:!!_.roleId})})}),(0,a.jsx)(b.Wi,{label:"G\xf6stərilmə",htmlFor:"customer_visible",inline:!0,children:(0,a.jsx)(S.Qr,{name:"customer_visible",control:x,render:e=>{let{field:l}=e;return(0,a.jsx)(f.X,{inputId:"customer_visible",checked:!!l.value,onChange:e=>l.onChange(e.checked)})}})}),(0,a.jsx)(b.Wi,{label:"İstirahət g\xfcn\xfc:",htmlFor:"day_off",children:(0,a.jsx)(S.Qr,{name:"day_off",control:x,render:()=>(0,a.jsx)(C.L,{value:v,onChange:e=>{var l;m(e.value),Z("day_off",null===(l=e.value)||void 0===l?void 0:l.id)},options:j.en,optionLabel:"name",placeholder:"İstirahət g\xfcn\xfc se\xe7in",className:"w-full",showClear:!0})})}),(0,a.jsx)(b.Wi,{label:"Şifrə:",htmlFor:"password",children:(0,a.jsx)(S.Qr,{name:"password",control:x,render:e=>{let{field:l}=e;return(0,a.jsx)(w.r,{id:"password",toggleMask:!0,feedback:!1,invalid:!!_.password,...l})}})}),(0,a.jsx)(b.Wi,{label:"Şifrənin təsdiqi:",htmlFor:"password_repeat",children:(0,a.jsx)(S.Qr,{name:"password_repeat",control:x,render:e=>{let{field:l}=e;return(0,a.jsx)(w.r,{id:"password_repeat",toggleMask:!0,feedback:!1,invalid:!!_.password_repeat,...l})}})}),(0,a.jsxs)("div",{className:"dialog-footer-between",children:[(0,a.jsx)("div",{children:_.password_repeat&&(0,a.jsx)(k.v,{style:{maxWidth:"180px",height:"45px"},severity:"error",text:"Şifrələr eyni deyil"})}),(0,a.jsx)(r.z,{label:"Saxla",type:"submit"})]})]})})},E=e=>{let{userPermissions:l=[]}=e,[i,s]=(0,t.useState)([]),[n,d]=(0,t.useState)(0),[o,m]=(0,t.useState)({}),[y,g]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),[k,S]=(0,t.useState)(0),[N]=(0,t.useState)(10),[F,E]=(0,t.useState)(1),R=(0,t.useRef)(null),T=(0,t.useCallback)(e=>l.includes(e),[l]),z=(0,t.useCallback)(e=>{var l;null===(l=R.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),D=(0,t.useCallback)(async e=>{try{let{data:l,meta:i}=await u.Z.getUsers({page:e,size:N});s(l),S(null==i?void 0:i.total)}catch(e){console.error("Failed to fetch users:",e)}},[N]);(0,t.useEffect)(()=>{D(F)},[D,F]);let M=(0,t.useCallback)(e=>{D(e.page+1),E(e.page+1),d(e.first)},[D]),O=(0,t.useCallback)(e=>{m(e),g(!0)},[]),I=(0,t.useCallback)(e=>{m(e),C(!0)},[]),A=(0,t.useCallback)(e=>(0,a.jsx)("div",{children:(0,v.O2)(e.role.id)}),[]),B=(0,t.useCallback)(e=>(0,a.jsx)(f.X,{checked:!!e.customer_visible,disabled:!0}),[]),H=(0,t.useCallback)(e=>{let l=j.en.find(l=>l.id===e.day_off);return(0,a.jsx)("div",{children:(null==l?void 0:l.name)||"-"})},[]),q=(0,t.useCallback)(e=>(0,a.jsxs)(a.Fragment,{children:[T("user.update")&&(0,a.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>O(e)}),T("user.delete")&&(0,a.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>I(e)})]}),[T,O,I]),W=(0,a.jsx)(b.xD,{rightContent:T("user.create")&&(0,a.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>g(!0)})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:i,editMode:"row",dataKey:"id",header:W,tableStyle:{minWidth:"50rem"},className:"table-container",children:[(0,a.jsx)(h.s,{field:"name",header:"Ad",style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"surname",header:"Soyad",style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"email",header:"Mail",style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"role",body:A,header:"Rol",style:{width:"15%"}}),(0,a.jsx)(h.s,{field:"customer_visible",header:"G\xf6stərilmə",body:B,style:{width:"10%"}}),(0,a.jsx)(h.s,{field:"day_off",header:"İstirahət g\xfcn\xfc",body:H,style:{width:"10%"}}),(0,a.jsx)(h.s,{body:q,exportable:!1,style:{width:"10%"}})]})}),(0,a.jsx)(p.D,{first:n,rows:N,totalRecords:k,onPageChange:M}),(0,a.jsx)(c.F,{ref:R}),(0,a.jsx)(_,{user:o,visible:w,onHide:()=>C(!1),setUsers:s,onSuccess:z}),(0,a.jsx)(Z,{user:o,setUsers:s,visible:y,onHide:()=>{g(!1),m({})},onSuccess:z})]})},R=i(891),T=i(1857);let z={name:"",price:0,customer_visible:!1};var D=e=>{let{visible:l,onHide:i,onSuccess:s,setServiceTypes:n}=e,[d,o]=(0,t.useState)(z),[c,v]=(0,t.useState)(!1),m=(0,t.useCallback)(()=>{o(z)},[]),h=(0,t.useCallback)(()=>{m(),i()},[m,i]),x=(0,t.useCallback)(async e=>{if(e.preventDefault(),d.name){v(!0);try{let{data:e}=await u.Z.createServiceType(d);n(l=>[e,...l]),s("Xidmət n\xf6v\xfc uğurla yaradıldı"),h()}catch(e){console.error("Failed to create service type:",e)}finally{v(!1)}}},[d,n,s,h]),p=(0,t.useCallback)(e=>{o(l=>({...l,name:e.target.value}))},[]),j=(0,t.useCallback)(e=>{o(l=>{var i;return{...l,price:null!==(i=e.value)&&void 0!==i?i:0}})},[]),_=(0,t.useCallback)(e=>{o(l=>{var i;return{...l,customer_visible:null!==(i=e.checked)&&void 0!==i&&i}})},[]);return(0,a.jsx)(y.V,{visible:l,modal:!0,onHide:h,header:"Yeni xidmət n\xf6v\xfc",style:{maxWidth:"400px",width:"100%"},children:(0,a.jsxs)("form",{onSubmit:x,className:"dialog-form",children:[(0,a.jsx)(b.Wi,{label:"Ad:",htmlFor:"name",children:(0,a.jsx)(g.o,{id:"name",value:d.name,onChange:p,required:!0})}),(0,a.jsx)(b.Wi,{label:"Qiymət:",htmlFor:"price",children:(0,a.jsx)(R.R,{id:"price",value:d.price,onValueChange:j,mode:"currency",currency:"AZN",locale:"de-DE"})}),(0,a.jsx)(b.Wi,{label:"G\xf6stərilmə",htmlFor:"customer_visible",inline:!0,children:(0,a.jsx)(f.X,{inputId:"customer_visible",checked:d.customer_visible,onChange:_})}),(0,a.jsxs)("div",{className:"dialog-footer",children:[(0,a.jsx)(r.z,{label:"Ləğv et",icon:"pi pi-times",outlined:!0,type:"button",onClick:h}),(0,a.jsx)(r.z,{label:"Saxla",icon:"pi pi-check",type:"submit",disabled:c||!d.name})]})]})})},M=e=>{let{serviceType:l,visible:i,onHide:s,setServiceTypes:n,onSuccess:r}=e,d=(0,t.useCallback)(async()=>{if(null==l?void 0:l.id)try{await u.Z.deleteServiceType(l.id),n(e=>e.filter(e=>e.id!==l.id)),r("Xidmət n\xf6v\xfc uğurla silindi"),s()}catch(e){console.error("Failed to delete service type:",e)}},[null==l?void 0:l.id,n,r,s]);return(0,a.jsx)(b.QH,{visible:i,onHide:s,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==l?void 0:l.name,'" xidmət n\xf6v\xfcn\xfc silmək istədiyinizə əminsiniz?')})},O=e=>{let{userPermissions:l=[]}=e,[i,s]=(0,t.useState)(),[n,d]=(0,t.useState)([]),[o,m]=(0,t.useState)(0),[j]=(0,t.useState)(10),[_,y]=(0,t.useState)(0),[w,C]=(0,t.useState)(!1),[k,S]=(0,t.useState)(!1),[N,F]=(0,t.useState)(!1),[Z,E,z]=(0,T.Nr)("",400),O=(0,t.useRef)(null),I=(0,t.useCallback)(e=>{var l;null===(l=O.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),A=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:l,meta:i}=await u.Z.getServiceTypes({page:e,size:j,name:E||void 0});d(l),m(null==i?void 0:i.total)}catch(e){console.error("Failed to fetch service types:",e)}},[j,E]);(0,t.useEffect)(()=>{A()},[A]);let B=(0,t.useCallback)(e=>{y(e.first),A(e.page+1)},[A]),H=(0,t.useCallback)(async e=>{let{newData:l}=e,{id:i,name:a,price:t=0,customer_visible:s}=l;try{await u.Z.updateServiceType({id:i,name:a,price:t,customer_visible:s}),d(e=>e.map(e=>e.id===i?{...l,name:a,price:t,id:i,customer_visible:s}:e)),I("Xidmət n\xf6v\xfc uğurla yeniləndi")}catch(e){console.error("Failed to update service type:",e)}},[I]),q=(0,t.useCallback)(e=>{s(e),F(!0)},[]),W=(0,t.useCallback)(()=>{C(e=>!e)},[]),Q=(0,t.useCallback)(e=>(0,a.jsx)(g.o,{type:"text",value:e.value,onChange:l=>e.editorCallback(l.target.value)}),[]),X=(0,t.useCallback)(e=>(0,a.jsx)(R.R,{value:e.value,onValueChange:l=>e.editorCallback(l.value),mode:"currency",currency:"AZN",locale:"de-DE"}),[]),V=(0,t.useCallback)(e=>(0,a.jsx)(f.X,{checked:!!e.value,onChange:l=>e.editorCallback(l.checked)}),[]),L=(0,t.useCallback)(e=>(0,v.T4)(e.price),[]),P=(0,t.useCallback)(e=>(0,a.jsx)(f.X,{checked:!!e.customer_visible,disabled:!0}),[]),K=(0,t.useCallback)(e=>(0,a.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>q(e)}),[q]),Y=(0,t.useCallback)(()=>(0,a.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:Z,onChange:e=>z(e.target.value)}),[Z,z]),G=(0,t.useCallback)(e=>(null==e?void 0:e.name)!=="Blue Band",[]),U=(0,t.useCallback)(e=>l.includes(e),[l]),$=(0,a.jsx)(b.xD,{onFilterToggle:W,rightContent:U("service_type.create")&&(0,a.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>S(!0)})});return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:n,editMode:"row",dataKey:"id",onRowEditComplete:H,tableStyle:{minWidth:"50rem"},header:$,className:"table-container",filterDisplay:w?"row":void 0,children:[(0,a.jsx)(h.s,{field:"name",header:"Ad",editor:Q,style:{width:"40%"},filter:!0,filterElement:Y,showFilterMenu:!1}),(0,a.jsx)(h.s,{field:"price",header:"Qiymət",body:L,editor:X,style:{width:"40%"}}),(0,a.jsx)(h.s,{field:"customer_visible",header:"G\xf6stərilmə",body:P,editor:V,style:{width:"40%"}}),U("service_type.update")&&(0,a.jsx)(h.s,{rowEditor:G,headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),U("service_type.delete")&&(0,a.jsx)(h.s,{body:K,exportable:!1,style:{width:"1%"}})]})}),(0,a.jsx)(p.D,{first:_,rows:j,totalRecords:o,onPageChange:B}),(0,a.jsx)(c.F,{ref:O}),(0,a.jsx)(D,{visible:k,onHide:()=>S(!1),onSuccess:I,setServiceTypes:d}),(0,a.jsx)(M,{serviceType:i,visible:N,onHide:()=>F(!1),setServiceTypes:d,onSuccess:I})]})},I=i(9749),A=i(7332),B=i(1395),H=i(8541),q=i(686),W=i(1572),Q=e=>{var l,i;let{visible:s,onHide:n,userPermissions:d,onSuccess:o,getServices:c,service:v,setService:m,role:h,page:x}=e,[p,f]=(0,t.useState)(),[_,w]=(0,t.useState)(),[k,Z]=(0,t.useState)(0),[E,T]=(0,t.useState)(),[z,D]=(0,t.useState)(),[M,O]=(0,t.useState)(!1),[I,A]=(0,t.useState)(),H=(null==h?void 0:h.id)===4,Q=(0,t.useCallback)(e=>d.includes(e),[d]),X=N.Z_().transform(e=>null!=e?e:"").defined(),V=N.Ry().shape({service_types:N.IX().of(N.Ry().shape({id:N.Rx().required()})).required(),client_first_name:Q("service.variable.client_name")?N.Z_().transform(e=>null!=e?e:"").defined().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri adı m\xfctləqdir"):X,client_last_name:Q("service.variable.client_name")?N.Z_().transform(e=>null!=e?e:"").defined().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri soyadı m\xfctləqdir"):X,client_name:X,client_phone:Q("service.variable.phone")?N.Z_().required():N.Z_().nullable(),user_id:Q("service.variable.user_id")?N.Rx().required():N.Rx(),reject_comment:(null==E?void 0:E.id)===2&&Q("service.variable.reject_comment")?N.Z_().required():N.Z_().nullable()}),{control:L,handleSubmit:P,formState:{errors:K},setValue:Y,reset:G}=(0,S.cI)({resolver:(0,F.X)(V),defaultValues:{client_name:"",client_first_name:"",client_last_name:""}}),U=(0,t.useCallback)(e=>{let l=(e||"").trim();if(!l)return{firstName:"",lastName:""};let[i,...a]=l.split(/\s+/);return{firstName:i,lastName:a.join(" ")}},[]),$=(0,S.qo)({control:L,name:"client_first_name"}),J=(0,S.qo)({control:L,name:"client_last_name"});(0,t.useEffect)(()=>{Y("client_name",[$,J].filter(Boolean).join(" ").trim())},[$,J,Y]);let ee=(0,t.useCallback)(()=>{n(),G(),m(void 0),f(void 0),w(void 0),T(void 0),Z(0)},[n,G,m]),el=(0,t.useCallback)(async e=>{let l=(null==e?void 0:e.amount)||0,i=[e.client_first_name,e.client_last_name].filter(Boolean).join(" ").trim();O(!0);try{var a;let t={...e,amount:l,client_name:i,client_phone:null===(a=e.client_phone)||void 0===a?void 0:a.toString().replace(/[\s-]/g,"")};(null==v?void 0:v.id)?await u.Z.updateService({...t,id:v.id}):await u.Z.createService(t),o("Xidmət uğurla saxlanıldı"),c(x),ee()}catch(e){console.error("Failed to save service:",e)}finally{O(!1)}},[null==v?void 0:v.id,o,c,x,ee]);(0,t.useEffect)(()=>{if(null==v?void 0:v.id){var e;let{firstName:l,lastName:i}=U(v.client_name);Y("client_first_name",l),Y("client_last_name",i),Y("client_name",v.client_name),Y("client_phone",v.client_phone),Y("user_id",null===(e=v.user)||void 0===e?void 0:e.id),ei({value:null==v?void 0:v.service_types}),Y("amount",+v.amount),Y("advance_amount",+v.advance_amount),Y("reject_comment",v.reject_comment),Y("comment",v.comment);let a=0!==v.status?j.au.find(e=>(null==e?void 0:e.id)===v.status):H?{id:0,name:"New"}:{id:1,name:"Accepted"};Y("status",null==a?void 0:a.id),T(a),w(null==z?void 0:z.find(e=>{var l;return e.id===(null===(l=v.user)||void 0===l?void 0:l.id)}))}},[v,Y,z,H,U]),(0,t.useEffect)(()=>{(async()=>{if(Q("user.input_search")){let{data:e}=await u.Z.getDoctors();D(e)}if(Q("service_type.input_search")){let{data:e}=await u.Z.getInputServices();A(e)}})()},[Q]),(0,t.useEffect)(()=>{var e;(null==I?void 0:I.length)&&(null==v?void 0:null===(e=v.service_types)||void 0===e?void 0:e.length)&&(f(v.service_types.map(e=>I.find(l=>l.id===e.id)).filter(Boolean)),Y("service_types",v.service_types.map(e=>({id:e.id}))))},[I,null==v?void 0:v.service_types,Y]);let ei=(0,t.useCallback)(e=>{let l=e.value;f(l),Y("service_types",null==l?void 0:l.map(e=>({id:e.id})));let i=(null==l?void 0:l.reduce((e,l)=>e+ +l.price,0))||0;Z(i),Y("amount",i-((null==v?void 0:v.advance_amount)||0))},[Y,null==v?void 0:v.advance_amount]);return(0,a.jsx)(y.V,{visible:s,modal:!0,onHide:ee,header:"Xidmət",style:{maxWidth:"500px",width:"100%"},children:(0,a.jsxs)("form",{onSubmit:P(el),className:"dialog-form",children:[Q("service.variable.client_name")&&(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)(b.Wi,{label:"M\xfcştəri adı:",htmlFor:"client_first_name",error:null===(l=K.client_first_name)||void 0===l?void 0:l.message,children:(0,a.jsx)(S.Qr,{name:"client_first_name",control:L,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"client_first_name",invalid:!!K.client_first_name,...l})}})}),(0,a.jsx)(b.Wi,{label:"M\xfcştəri soyadı:",htmlFor:"client_last_name",error:null===(i=K.client_last_name)||void 0===i?void 0:i.message,children:(0,a.jsx)(S.Qr,{name:"client_last_name",control:L,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"client_last_name",invalid:!!K.client_last_name,...l})}})})]}),Q("service.variable.phone")&&(0,a.jsx)(b.Wi,{label:"Telefon:",htmlFor:"client_phone",children:(0,a.jsx)(S.Qr,{name:"client_phone",control:L,rules:{minLength:12},render:e=>{var l;let{field:i}=e;return(0,a.jsx)(q.v,{id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!K.client_phone,...i,value:null!==(l=i.value)&&void 0!==l?l:""})}})}),Q("service.variable.user_id")&&!H&&(0,a.jsx)(b.Wi,{label:"Həkim:",htmlFor:"user_id",children:(0,a.jsx)(S.Qr,{name:"user_id",control:L,render:e=>{let{field:l}=e;return(0,a.jsx)(C.L,{filter:!0,value:_,onChange:e=>{w(e.value),Y("user_id",e.value.id)},optionLabel:"full_name",options:z,placeholder:"Doktor se\xe7in",invalid:!!K.user_id})}})}),Q("service.variable.service_type_id")&&(0,a.jsx)(b.Wi,{label:"Xidmət:",htmlFor:"service_types",children:(0,a.jsx)(S.Qr,{name:"service_types",control:L,render:()=>(0,a.jsx)(B.N,{filter:!0,value:p,onChange:ei,options:I,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full",invalid:!!K.service_types})})}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Toplam:"}),(0,a.jsx)(R.R,{disabled:!0,value:k,mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Depozit:"}),(0,a.jsx)(R.R,{disabled:!0,value:(null==v?void 0:v.advance_amount)||0,mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3"})]})]}),(0,a.jsxs)("div",{className:"form-row",children:[!H&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Alınacaq məbləğ:"}),(0,a.jsx)(R.R,{disabled:!0,value:k-((null==v?void 0:v.advance_amount)||0),mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:[H?"Alınacaq":"Alındı",":"]}),(0,a.jsx)(S.Qr,{name:"amount",control:L,render:e=>{let{field:l}=e;return(0,a.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onValueChange:e=>l.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3",invalid:!!K.amount})}})]})]}),Q("service.variable.reject_comment")&&(0,a.jsx)(b.Wi,{label:"Comment:",htmlFor:"comment",children:(0,a.jsx)(S.Qr,{name:"comment",control:L,render:e=>{var l;let{field:i}=e;return(0,a.jsx)(g.o,{id:"comment",...i,value:null!==(l=i.value)&&void 0!==l?l:""})}})}),Q("service.variable.reject_comment")&&(null==E?void 0:E.id)===2&&(0,a.jsx)(b.Wi,{label:"Reject comment:",htmlFor:"reject_comment",children:(0,a.jsx)(S.Qr,{name:"reject_comment",control:L,rules:{required:!0},render:e=>{var l;let{field:i}=e;return(0,a.jsx)(g.o,{id:"reject_comment",invalid:!!K.reject_comment,...i,value:null!==(l=i.value)&&void 0!==l?l:""})}})}),Q("service.variable.status")&&(null==v?void 0:v.id)&&!H&&(0,a.jsx)("div",{className:"flex mb-3",children:j.au.map(e=>(null==e?void 0:e.id)!==0&&(0,a.jsxs)("div",{className:"flex align-center mr-3",children:[(0,a.jsx)(W.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{T(e.value),Y("status",e.value.id)},checked:(null==E?void 0:E.id)===(null==e?void 0:e.id)}),(0,a.jsx)("label",{htmlFor:null==e?void 0:e.name,className:"ml-2",children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,a.jsx)("div",{className:"dialog-footer",children:(0,a.jsx)(r.z,{label:"Saxla",disabled:M,type:"submit"})})]})})},X=e=>{let{visible:l,onHide:i}=e,[s,n]=(0,t.useState)(new Date),d=(0,t.useCallback)(()=>{s&&u.Z.getDailyReportExcel((0,v.p6)(s))},[s]);return(0,a.jsx)(y.V,{header:"Hesabatlar",visible:l,onHide:i,style:{minWidth:"400px"},children:(0,a.jsx)("div",{className:"flex flex-column gap-4",children:(0,a.jsxs)("div",{className:"flex justify-between align-center gap-4",children:[(0,a.jsx)(A.f,{value:s,onChange:e=>n(e.value),showIcon:!0,dateFormat:"dd/mm/yy"}),(0,a.jsx)(r.z,{severity:"success",label:"Export",icon:"pi pi-upload",onClick:d})]})})})},V=e=>{let{visible:l,onHide:i,service:s,onSuccess:n,getServices:r,currentPage:d,currentCount:o,onPageChange:c}=e,v=(0,t.useCallback)(async()=>{if(null==s?void 0:s.id)try{await u.Z.deleteService(s.id),i();let e=1===o&&d>1?d-1:d;c(e),r(e),n("Xidmət uğurla silindi")}catch(e){console.error("Failed to delete service:",e)}},[null==s?void 0:s.id,i,r,n,o,d,c]);return(0,a.jsx)(b.QH,{visible:l,onHide:i,onConfirm:v,header:"Silmə təsdiqi",message:'"'.concat(null==s?void 0:s.client_name,'" xidmətini silmək istədiyinizə əminsiniz?')})},L=e=>{let{userPermissions:l,role:i}=e,[s,n]=(0,t.useState)([]),[d,o]=(0,t.useState)(null),[m,f]=(0,t.useState)(),[_,w]=(0,t.useState)(),[S,N]=(0,t.useState)(),[F,Z]=(0,t.useState)(),[E,z]=(0,t.useState)(),[D,M]=(0,t.useState)(!1),[O,q]=(0,t.useState)(!1),[W,L]=(0,t.useState)(!1),[P,K]=(0,t.useState)(!1),[Y,G]=(0,t.useState)(!1),[U,$]=(0,t.useState)(!1),[J,ee,el]=(0,T.Nr)("",400),[ei,ea,et]=(0,T.Nr)(null,400),[es,en]=(0,t.useState)([new Date,new Date]),[er,ed]=(0,t.useState)(1),[eo,ec]=(0,t.useState)(0),[eu,ev]=(0,t.useState)(0),[em]=(0,t.useState)(10),[eh,ex]=(0,t.useState)(!1),[ep,ef]=(0,t.useState)(),[ej,eb]=(0,t.useState)(),[e_,ey]=(0,t.useState)(!1),[eg,ew]=(0,t.useState)(),eC=(0,t.useRef)(null),ek=(0,t.useRef)(null),eS=(null==i?void 0:i.id)===4,eN=2===es.length&&(0,v.KC)(new Date(es[0]),new Date(es[1])),eF=(0,v.zk)(new Date(es[0])),eZ=(0,t.useCallback)(e=>l.includes(e),[l]),eE=(0,t.useCallback)(e=>{var l;null===(l=eC.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),eR=(0,t.useCallback)(async function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ex(!0);try{let{data:l,meta:i}=await u.Z.getServices({page:e,size:em,status:null==d?void 0:d.id,from_date:(0,v.p6)(es[0]),to_date:(0,v.p6)(es[1]),client_name:ee,client_phone:ea,service_types:null==E?void 0:E.map(e=>e.id),user_id:null==F?void 0:F.id});if(n(l),ev(null==i?void 0:i.total),eZ("service.get_all.total_amount")){let{data:e}=await u.Z.getAdvanceInfo((0,v.p6)(es[0]));eb(e)}if(eZ("service.advance.info")){let e=await u.Z.getTotalAmount({status:null==d?void 0:d.id,from_date:(0,v.p6)(es[0]),to_date:(0,v.p6)(es[1]),client_name:ee,client_phone:ea,service_types:null==E?void 0:E.map(e=>e.id),user_id:null==F?void 0:F.id});ef(e)}let a=await u.Z.getTimeZone();ey(!(0,v.Yu)(a.date_time))}catch(e){console.error("Failed to fetch services:",e)}finally{if(ex(!1),l){var i;null===(i=ek.current)||void 0===i||i.scrollIntoView({behavior:"smooth"})}}},[em,null==d?void 0:d.id,es,ee,ea,E,null==F?void 0:F.id,eZ]);(0,t.useEffect)(()=>{es[1]&&eR(er)},[null==d?void 0:d.name,es,ee,ea,null==E?void 0:E.length,F]),(0,t.useEffect)(()=>{(async()=>{if(eZ("user.input_search")){let{data:e}=await u.Z.getDoctors();w(e)}if(eZ("service_type.input_search")){let{data:e}=await u.Z.getInputServices();f(e)}})()},[eZ]);let eT=(0,t.useCallback)(e=>{ec(e.first),eR(e.page+1,!0),ed(e.page+1)},[eR]),ez=(0,t.useCallback)(e=>{N(e),M(!0)},[]),eD=(0,t.useCallback)(e=>{N(e),K(!0)},[]),eM=(0,t.useCallback)(()=>{u.Z.getAllReportsExcel({status:null==d?void 0:d.id,from_date:(0,v.p6)(es[0]),to_date:(0,v.p6)(es[1]),client_name:ee,client_phone:ea,service_types:null==E?void 0:E.map(e=>e.id),user_id:null==F?void 0:F.id})},[null==d?void 0:d.id,es,ee,ea,E,null==F?void 0:F.id]),eO=(0,t.useCallback)(async()=>{try{await u.Z.advanceTransfer(),G(!1);let{data:e}=await u.Z.getAdvanceInfo((0,v.p6)(es[0]));eb(e),eE("N\xf6vbə bağlandı")}catch(e){console.error("Failed to transfer advance:",e)}},[es,eE]),eI=(0,t.useCallback)(async()=>{try{await u.Z.advanceCancel((0,v.p6)(es[0]));let{data:e}=await u.Z.getAdvanceInfo((0,v.p6)(es[0]));eb(e),eE("N\xf6vbə yenidən a\xe7ıldı")}catch(e){console.error("Failed to cancel advance:",e)}},[es,eE]),eA=(0,t.useCallback)((e,l)=>eh?(0,a.jsx)(H.O,{width:"20px"}):(0,a.jsx)("div",{children:eu-l.rowIndex-eo}),[eh,eu,eo]),eB=(0,t.useCallback)(e=>eh?(0,a.jsx)(H.O,{width:"100px"}):e.created_at.slice(0,-3),[eh]),eH=(0,t.useCallback)(e=>eh?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.client_name}),[eh]),eq=(0,t.useCallback)(e=>eh?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:(0,v.CN)(e.client_phone)}),[eh]),eW=(0,t.useCallback)(e=>{var l,i;return eh?(0,a.jsx)(H.O,{width:"150px"}):"".concat(null===(l=e.user)||void 0===l?void 0:l.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},[eh]),eQ=(0,t.useCallback)(e=>{let l=+(null==e?void 0:e.amount)?+e.amount+e.advance_amount:+e.services_total;return eh?(0,a.jsx)(H.O,{width:"100px"}):(0,v.T4)(l)},[eh]),eX=(0,t.useCallback)(e=>eh?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.service_types.map(e=>(0,a.jsx)("div",{children:e.name},e.id))}),[eh]),eV=(0,t.useCallback)(e=>{switch(e){case"Rejected":return"danger";case"Accepted":return"success";case"New":return"info";default:return}},[]),eL=(0,t.useCallback)(e=>{var l;let i=null===(l=j.au.find(l=>(null==l?void 0:l.id)===e.status))||void 0===l?void 0:l.name;return eh?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)(I.V,{onClick:()=>{"Rejected"===i&&(ew(e.reject_comment),L(!0))},icon:"Rejected"===i?"pi pi-info-circle":void 0,value:i,severity:eV(i),className:"status-badge"})},[eh,eV]),eP=(0,t.useCallback)(e=>eh?(0,a.jsx)(H.O,{width:"60px"}):(0,a.jsxs)(a.Fragment,{children:[((null==e?void 0:e.status)===0&&eS||!eS)&&(0,a.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>ez(e)}),eZ("service.delete")&&(0,a.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>eD(e)})]}),[eh,eS,eZ,ez,eD]),eK=(0,t.useCallback)(()=>eZ("service.filter.status")?(0,a.jsx)(C.L,{value:d,options:j.au,onChange:e=>o(e.value),itemTemplate:e=>(0,a.jsx)(I.V,{value:e.name,severity:eV(e.name)}),placeholder:"Status",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"}):null,[eZ,d,eV]),eY=(0,t.useCallback)(()=>eZ("service.filter.date")?(0,a.jsx)(A.f,{value:es,onChange:e=>en(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[eZ,es]),eG=(0,t.useCallback)(()=>eZ("service.filter.client_name")?(0,a.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:J,onChange:e=>el(e.target.value)}):null,[eZ,J,el]),eU=(0,t.useCallback)(()=>eZ("service.filter.client_phone")?(0,a.jsx)(R.R,{className:"input-phone-filter",id:"client_phone",placeholder:"+994 99 999-99-99",value:ei,onChange:e=>et(e.value),prefix:"+",useGrouping:!1}):null,[eZ,ei,et]),e$=(0,t.useCallback)(()=>eZ("service.filter.service_type")?(0,a.jsx)(B.N,{filter:!0,value:E,onChange:e=>z(e.value),options:m,placeholder:"Xidmət se\xe7in",optionLabel:"name",showClear:!0}):null,[eZ,E,m]),eJ=(0,t.useCallback)(()=>eZ("service.filter.doctor")?(0,a.jsx)(C.L,{filter:!0,value:F,onChange:e=>Z(e.value),options:_,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}):null,[eZ,F,_]),e0=(0,t.useMemo)(()=>(0,a.jsxs)("div",{className:"total-info-content",children:[(0,a.jsxs)("div",{className:"ml-2",children:["Depozit: ",null==ep?void 0:ep.advance," AZN"]}),(0,a.jsxs)("div",{className:"ml-2",children:["Xidmətlər: ",null==ep?void 0:ep.amount," AZN"]}),(0,a.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==ep?void 0:ep.total," AZN"]})]}),[ep]),e1=(0,t.useMemo)(()=>{var e,l;return(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"ml-2",children:"N\xf6vbə bağlanıb"}),(0,a.jsxs)("div",{className:"ml-2",children:[null==ej?void 0:null===(e=ej.user)||void 0===e?void 0:e.name," ",null==ej?void 0:null===(l=ej.user)||void 0===l?void 0:l.surname]}),(0,a.jsx)("div",{className:"ml-2",children:null==ej?void 0:ej.transferred_at})]}),eZ("reservation.next_day_transfer.cancel")&&(0,a.jsx)(r.z,{icon:"pi pi-undo",tooltip:"N\xf6vbəni yenidən a\xe7",onClick:eI,disabled:!eF})]})},[ej,eZ,eI,eF]),e9=(0,t.useMemo)(()=>(0,a.jsx)(b.xD,{onFilterToggle:(0,v.Bv)(l)?()=>$(e=>!e):void 0,onRefresh:()=>eR(er),rightContent:(0,a.jsxs)(a.Fragment,{children:[eZ("service.all_reports")&&!!s.length&&(0,a.jsx)(r.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:eM}),eZ("service.daily_report")&&(0,a.jsx)(r.z,{label:"G\xfcn sonu",icon:"pi pi-file-excel",severity:"success",onClick:()=>q(!0)}),eZ("service.create")&&(0,a.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>M(!0)})]})}),[l,er,s.length,eZ,eM,eR]);return e_?(0,a.jsx)("div",{children:"Ağıllısanda\uD83D\uDE02"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:s,dataKey:"id",header:e9,tableStyle:{minWidth:"50rem"},className:"table-container",filterDisplay:U?"row":void 0,children:[(0,a.jsx)(h.s,{body:eA,header:"#",style:{width:"2%"}}),(0,a.jsx)(h.s,{dataType:"date",header:"Tarix",body:eB,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:eY}),(0,a.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:eG,showFilterMenu:!1,body:eH}),eZ("service.variable.select_phone")&&(0,a.jsx)(h.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:eU,showFilterMenu:!1,body:eq}),(0,a.jsx)(h.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,filter:eZ("service.variable.service_type_id"),filterElement:e$,body:eX}),(0,a.jsx)(h.s,{header:"Həkim",body:eW,style:{width:"10%"},showFilterMenu:!1,filter:eZ("service.variable.user_id"),filterElement:eJ}),(0,a.jsx)(h.s,{header:"Məbləğ",body:eQ,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Status",body:eL,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:eK}),(0,a.jsx)(h.s,{body:eP,exportable:!1,style:{width:"10%"}})]})}),(0,a.jsx)("div",{ref:ek,children:(0,a.jsx)(p.D,{first:eo,rows:em,totalRecords:eu,onPageChange:eT})}),eZ("service.get_all.total_amount")&&(0,a.jsxs)("div",{className:"total-info",children:[(0,a.jsx)(k.v,{className:"info-message mr-5",severity:"info",content:e0}),eN&&!eh&&((null==ej?void 0:ej.id)&&eZ("service.advance.info")?(0,a.jsx)(k.v,{content:e1}):eZ("reservation.next_day_transfer")&&(0,a.jsx)(r.z,{onClick:()=>G(!0),disabled:!eF,children:"N\xf6vbəni bağla"}))]}),(0,a.jsx)(c.F,{ref:eC}),(0,a.jsx)(Q,{userPermissions:l,visible:D,onHide:()=>{M(!1),N(void 0)},onSuccess:eE,service:S,setService:N,getServices:eR,role:i,page:er}),(0,a.jsx)(X,{visible:O,onHide:()=>q(!1)}),(0,a.jsx)(y.V,{header:"Reject comment",visible:W,style:{width:"50vw"},onHide:()=>{L(!1),ew("")},children:(0,a.jsx)("p",{className:"m-0",children:eg})}),(0,a.jsx)(b.QH,{visible:Y,onHide:()=>G(!1),onConfirm:eO,header:"N\xf6vbəni bağla",message:"N\xf6vbənin bağlanılmasına əminsiniz?"}),(0,a.jsx)(V,{service:S,visible:P,onHide:()=>K(!1),onSuccess:eE,getServices:eR,currentPage:er,currentCount:s.length,onPageChange:e=>{ed(e),ec((e-1)*em)}})]})},P=()=>{let[e,l]=(0,t.useState)(),[i,s]=(0,t.useState)([new Date,new Date]),[n,d]=(0,t.useState)(),[o,c]=(0,t.useState)(),[m,p]=(0,t.useState)({}),[f,j]=(0,t.useState)(),_=(0,t.useCallback)(async()=>{try{let{data:e}=await u.Z.getBonuses({from_date:(0,v.p6)(i[0]),to_date:(0,v.p6)(i[1]),user_id:null==o?void 0:o.id}),{data:a}=await u.Z.getBonusesCoefficient();l(e),j(null==a?void 0:a.coefficient)}catch(e){console.error("Failed to fetch bonuses:",e)}},[i,null==o?void 0:o.id]);(0,t.useEffect)(()=>{i[1]&&_()},[_]),(0,t.useEffect)(()=>{f&&u.Z.patchBonusCoefficient(f)},[f]),(0,t.useEffect)(()=>{(async()=>{let{data:e}=await u.Z.getDoctors();d(e)})()},[]);let y=(0,t.useCallback)(e=>{let l=f||1;return(0,v.T4)(+e/l)},[f]),g=(0,t.useCallback)(e=>{var l,i;return"".concat(null===(l=e.user)||void 0===l?void 0:l.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},[]),w=(0,t.useCallback)(e=>(0,v.T4)(e.total_amount),[]),k=(0,t.useCallback)(e=>y(e.total_amount),[y]),S=(0,t.useCallback)(e=>(0,v.T4)(e.bonus_per_days),[]),N=(0,t.useCallback)(e=>y(e.bonus_per_days),[y]),F=(0,t.useCallback)(()=>{u.Z.getBonusesExcel({from_date:(0,v.p6)(i[0]),to_date:(0,v.p6)(i[1]),user_id:null==o?void 0:o.id})},[i,null==o?void 0:o.id]),Z=(0,t.useCallback)(e=>{var l;return(null===(l=e.bonus_per_days)||void 0===l?void 0:l.length)>0},[]),E=(0,t.useCallback)(e=>(0,a.jsx)("div",{children:(0,a.jsxs)(x.w,{value:e.bonus_per_days,children:[(0,a.jsx)(h.s,{field:"date",header:"Tarix",style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"bonus_per_days",header:"Məbləğ",body:S,style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"bonus_per_days",header:"Bonus",body:N,style:{width:"90%"}})]})}),[S,N]),T=(0,t.useMemo)(()=>(0,a.jsx)(b.xD,{leftContent:(0,a.jsxs)("div",{className:"flex align-center gap-3",children:[(0,a.jsx)(A.f,{value:i,onChange:e=>s(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}),(0,a.jsx)(C.L,{filter:!0,value:o,onChange:e=>c(e.value),options:n,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}),(0,a.jsx)(R.R,{style:{maxWidth:"80px"},value:f,onValueChange:e=>j(e.value||0)})]}),rightContent:(0,a.jsx)(r.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:F})}),[i,o,n,f,F]);return(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:e,editMode:"row",dataKey:"user.id",className:"table-container",header:T,expandedRows:m,onRowToggle:e=>p(e.data),rowExpansionTemplate:E,children:[(0,a.jsx)(h.s,{expander:Z}),(0,a.jsx)(h.s,{body:g,header:"Həkim",style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"total_amount",header:"Toplam məbləğ",body:w,style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"total_amount",header:"Bonus",body:k,style:{width:"60%"}})]})})})},K=e=>{let{visible:l,onHide:i,onSuccess:s,setBookingTimes:n}=e,{control:d,handleSubmit:o,formState:{errors:c},reset:v}=(0,S.cI)(),m=(0,t.useCallback)(()=>{i(),v()},[i,v]),h=(0,t.useCallback)(async e=>{let{time:l,reservation_count:i=0}=e;try{let{data:e}=await u.Z.createBookingTime({reservation_count:i,time:l});n(l=>[...l,e]),s("Rezervasiya saatı uğurla yaradıldı"),m()}catch(e){console.error("Failed to create booking time:",e)}},[n,s,m]);return(0,a.jsx)(y.V,{visible:l,style:{width:"25rem"},header:"Rezerv saatı",modal:!0,onHide:m,children:(0,a.jsxs)("form",{onSubmit:o(h),className:"dialog-form",children:[(0,a.jsx)(b.Wi,{label:"Saat:",htmlFor:"time",children:(0,a.jsx)(S.Qr,{name:"time",control:d,rules:{required:!0},render:e=>{let{field:l}=e;return(0,a.jsx)(q.v,{id:"time",mask:"99:99",invalid:!!c.time,...l})}})}),(0,a.jsx)(b.Wi,{label:"Limit:",htmlFor:"reservation_count",children:(0,a.jsx)(S.Qr,{name:"reservation_count",control:d,render:e=>{let{field:l}=e;return(0,a.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onValueChange:e=>l.onChange(e),invalid:!!c.reservation_count})}})}),(0,a.jsx)("div",{className:"dialog-footer",children:(0,a.jsx)(r.z,{label:"Saxla",type:"submit"})})]})})},Y=e=>{let{bookingTime:l,visible:i,onHide:s,setBookingTimes:n,onSuccess:r}=e,d=(0,t.useCallback)(async()=>{if(null==l?void 0:l.id)try{await u.Z.deleteBookingTime(l.id),n(e=>e.filter(e=>e.id!==l.id)),s(),r("Rezerv saatı uğurla silindi")}catch(e){console.error("Failed to delete booking time:",e)}},[null==l?void 0:l.id,n,s,r]);return(0,a.jsx)(b.QH,{visible:i,onHide:s,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==l?void 0:l.time,'" saatını silmək istədiyinizə əminsiniz?')})},G=e=>{let{userPermissions:l=[]}=e,[i,s]=(0,t.useState)(),[n,d]=(0,t.useState)([]),[o,v]=(0,t.useState)(0),[m]=(0,t.useState)(10),[f,j]=(0,t.useState)(0),[_,y]=(0,t.useState)(!1),[g,w]=(0,t.useState)(!1),C=(0,t.useRef)(null),k=(0,t.useCallback)(e=>l.includes(e),[l]),S=(0,t.useCallback)(e=>{var l;null===(l=C.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),N=(0,t.useCallback)(e=>null==e?void 0:e.sort((e,l)=>{let i=e.time.split(":").map(Number),a=l.time.split(":").map(Number);return i[0]!==a[0]?i[0]-a[0]:i[1]-a[1]}),[]),F=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:l,meta:i}=await u.Z.getBookingTimes({page:e,size:m});d(N(l)),v(null==i?void 0:i.total)}catch(e){console.error("Failed to fetch booking times:",e)}},[m,N]);(0,t.useEffect)(()=>{F()},[F]);let Z=(0,t.useCallback)(e=>{j(e.first),F(e.page+1)},[F]),E=(0,t.useCallback)(async e=>{let{newData:l}=e,{id:i,time:a,reservation_count:t=0}=l;try{await u.Z.updateBookingTime({id:i,time:a,reservation_count:t}),d(e=>e.map(e=>e.id===i?{...l,time:a,reservation_count:t,id:i}:e)),S("Rezerv saatı uğurla yeniləndi")}catch(e){console.error("Failed to update booking time:",e)}},[S]),T=(0,t.useCallback)(e=>{s(e),w(!0)},[]),z=(0,t.useCallback)(e=>(0,a.jsx)(q.v,{mask:"99:99",value:e.value,onChange:l=>e.editorCallback(l.target.value)}),[]),D=(0,t.useCallback)(e=>(0,a.jsx)(R.R,{value:e.value,onValueChange:l=>e.editorCallback(l.value)}),[]),M=(0,t.useCallback)(e=>(null==e?void 0:e.time)!=="Blue Band",[]),O=(0,t.useCallback)(e=>(0,a.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>T(e)}),[T]),I=k("reservation_time.create")?(0,a.jsx)(b.xD,{rightContent:(0,a.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>y(!0)})}):null;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:n,editMode:"row",dataKey:"id",onRowEditComplete:E,tableStyle:{minWidth:"50rem"},header:I,className:"table-container",children:[(0,a.jsx)(h.s,{field:"time",header:"Saat",editor:z,style:{width:"40%"}}),(0,a.jsx)(h.s,{field:"reservation_count",header:"Limit",editor:D,style:{width:"40%"}}),k("reservation_time.update")&&(0,a.jsx)(h.s,{rowEditor:M,headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),k("reservation_time.delete")&&(0,a.jsx)(h.s,{body:O,exportable:!1,style:{width:"1%"}})]})}),(0,a.jsx)(p.D,{first:f,rows:m,totalRecords:o,onPageChange:Z}),(0,a.jsx)(c.F,{ref:C}),(0,a.jsx)(K,{visible:_,onHide:()=>y(!1),onSuccess:S,setBookingTimes:d}),(0,a.jsx)(Y,{bookingTime:i,visible:g,onHide:()=>w(!1),setBookingTimes:d,onSuccess:S})]})},U=e=>{var l,i,s;let{visible:n,onHide:d,userPermissions:o,onSuccess:c,getBookings:m,booking:h,setBooking:x}=e,[p,_]=(0,t.useState)(),[w,Z]=(0,t.useState)(!1),[E,T]=(0,t.useState)(),[z,D]=(0,t.useState)(!1),[M,O]=(0,t.useState)(),[I,H]=(0,t.useState)(),[Q,X]=(0,t.useState)([]),[V,L]=(0,t.useState)(),[P,K]=(0,t.useState)(!1),[Y,G]=(0,t.useState)(),[U,$]=(0,t.useState)(null),J=(0,t.useCallback)(e=>o.includes(e),[o]),ee=N.Ry().shape({service_types:(null==I?void 0:I.id)===3?N.IX().of(N.Ry().shape({id:N.Rx().required()})).min(1).required():N.IX(),client_first_name:N.Z_().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri adı m\xfctləqdir"),client_last_name:N.Z_().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri soyadı m\xfctləqdir"),client_name:N.Z_().required(),client_phone:J("service.variable.phone")?N.Z_().required():N.Z_(),doctor_id:(null==I?void 0:I.id)===3?N.Rx().required():N.Rx(),hour:N.Z_().required()}),{control:el,handleSubmit:ei,formState:{errors:ea},setValue:et,getValues:es,reset:en}=(0,S.cI)({resolver:(0,F.X)(ee),defaultValues:{client_name:"",client_first_name:"",client_last_name:""}}),er=(0,t.useCallback)(e=>{let l=(e||"").trim();if(!l)return{firstName:"",lastName:""};let[i,...a]=l.split(/\s+/);return{firstName:i,lastName:a.join(" ")}},[]),ed=(0,S.qo)({control:el,name:"client_first_name"}),eo=(0,S.qo)({control:el,name:"client_last_name"});(0,t.useEffect)(()=>{et("client_name",[ed,eo].filter(Boolean).join(" ").trim())},[ed,eo,et]);let ec=(0,t.useCallback)(()=>{d(),en(),x(void 0),_(void 0),T(void 0),H(void 0),O(void 0),$(null),X([]),D(!1),Z(!1)},[d,en,x]),eu=(0,t.useCallback)(async e=>{K(!0);let l=(null==e?void 0:e.advance_amount)||0,i=[e.client_first_name,e.client_last_name].filter(Boolean).join(" ").trim();try{var a;let t={...e,advance_amount:l,client_name:i,doctor_id:e.doctor_id,client_phone:null===(a=e.client_phone)||void 0===a?void 0:a.toString().replace(/[\s-]/g,"")};(null==h?void 0:h.id)?await u.Z.updateBooking({...t,id:h.id,reservation_date:(null==I?void 0:I.id)===2?"".concat((0,v.p6)(U)," ").concat(null==M?void 0:M.time):null==h?void 0:h.reservation_date,status:e.status}):await u.Z.createBooking({...t,reservation_date:"".concat((0,v.p6)(U)," ").concat(null==M?void 0:M.time)}),c("Rezerv uğurla saxlanıldı"),m(),ec()}catch(e){console.error("Failed to save booking:",e)}finally{K(!1)}},[null==h?void 0:h.id,null==h?void 0:h.reservation_date,null==I?void 0:I.id,U,null==M?void 0:M.time,c,m,ec]);(0,t.useEffect)(()=>{if(null==h?void 0:h.id){let{firstName:e,lastName:l}=er(h.client_name);et("client_first_name",e),et("client_last_name",l),et("client_name",h.client_name),et("client_phone",h.client_phone),et("is_out_of_turn",h.is_out_of_turn),D(h.is_out_of_turn);let[i,a,t]=h.reservation_date.split("-"),[s,n]=t.split(" "),r=new Date("".concat(s,"-").concat(a,"-").concat(i,"T").concat(n));et("reservation_date",r),$(r),et("status",h.status),et("advance_amount",h.advance_amount),H(j.Yr.find(e=>(null==e?void 0:e.id)===h.status))}},[h,et,er]),(0,t.useEffect)(()=>{var e;(null==h?void 0:h.id)&&(null==h?void 0:null===(e=h.doctor)||void 0===e?void 0:e.id)&&(async()=>{var e;let{data:l}=await u.Z.getDoctorById(h.doctor.id);et("doctor_id",null===(e=h.doctor)||void 0===e?void 0:e.id),T({id:l.id,full_name:"".concat(null==l?void 0:l.name," ").concat(null==l?void 0:l.surname)}),(null==Q?void 0:Q.map(e=>null==e?void 0:e.id).includes((null==E?void 0:E.id)||0))||X(e=>[...e,{id:l.id,full_name:"".concat(null==l?void 0:l.name," ").concat(null==l?void 0:l.surname)}])})()},[null==h?void 0:h.id,null==h?void 0:null===(l=h.doctor)||void 0===l?void 0:l.id,null==M?void 0:M.time]),(0,t.useEffect)(()=>{(async()=>{if(J("user.input_search")&&(null==M?void 0:M.time)&&!(null==Q?void 0:Q.map(e=>null==e?void 0:e.id).includes((null==E?void 0:E.id)||0))){let{data:e}=z?await u.Z.getDoctors():await u.Z.getBookingDoctors("".concat((0,v.p6)(U)," ").concat(null==M?void 0:M.time));X(e)}else{let{data:e}=await u.Z.getDoctors();X(e),!(null==Q?void 0:Q.map(e=>null==e?void 0:e.id).includes((null==E?void 0:E.id)||0))&&(null==E?void 0:E.id)&&X(e=>[...e,{id:E.id,full_name:null==E?void 0:E.full_name}])}})()},[null==M?void 0:M.time,z]),(0,t.useEffect)(()=>{(async()=>{if(J("service_type.input_search")){let{data:e}=await u.Z.getInputServices();G(e)}})()},[J]),(0,t.useEffect)(()=>{var e;(null==Y?void 0:Y.length)&&(null==h?void 0:null===(e=h.service_types)||void 0===e?void 0:e.length)&&(_(h.service_types.map(e=>Y.find(l=>l.id===e.id)).filter(Boolean)),et("service_types",h.service_types.map(e=>({id:e.id}))))},[Y,null==h?void 0:h.service_types,et]),(0,t.useEffect)(()=>{(async()=>{if(U){let{data:l}=await u.Z.getHours((0,v.p6)(U));if(L(l),null==h?void 0:h.id){var e;O(null==l?void 0:l.find(e=>{var l;return e.time===(null==h?void 0:null===(l=h.real_reservation_date)||void 0===l?void 0:l.split(" ")[1].slice(0,-3))})),et("hour",null==h?void 0:null===(e=h.real_reservation_date)||void 0===e?void 0:e.split(" ")[1].slice(0,-3))}}})()},[U,null==h?void 0:h.id,null==h?void 0:h.real_reservation_date,et]);let ev=(0,t.useCallback)(e=>{let l=e.value;_(l),et("service_types",null==l?void 0:l.map(e=>({id:e.id})))},[et]),em=void 0===es().status||2===es().status;return(0,a.jsx)(y.V,{visible:n,modal:!0,onHide:ec,header:"Rezerv",style:{maxWidth:"500px",width:"100%"},children:(0,a.jsxs)("form",{onSubmit:ei(eu),className:"dialog-form",children:[(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)(b.Wi,{label:"M\xfcştəri adı:",htmlFor:"client_first_name",error:null===(i=ea.client_first_name)||void 0===i?void 0:i.message,children:(0,a.jsx)(S.Qr,{name:"client_first_name",control:el,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"client_first_name",invalid:!!ea.client_first_name,...l})}})}),(0,a.jsx)(b.Wi,{label:"M\xfcştəri soyadı:",htmlFor:"client_last_name",error:null===(s=ea.client_last_name)||void 0===s?void 0:s.message,children:(0,a.jsx)(S.Qr,{name:"client_last_name",control:el,render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"client_last_name",invalid:!!ea.client_last_name,...l})}})})]}),(0,a.jsx)(b.Wi,{label:"Telefon:",htmlFor:"client_phone",children:(0,a.jsx)(S.Qr,{name:"client_phone",control:el,render:e=>{let{field:l}=e;return(0,a.jsx)(q.v,{id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!ea.client_phone,...l})}})}),(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("label",{children:"Həkim:"}),(0,a.jsxs)("div",{className:"flex align-center gap-2",children:[(0,a.jsx)("label",{children:"N\xf6vbədən kənar:"}),(0,a.jsx)(S.Qr,{name:"is_out_of_turn",control:el,render:()=>(0,a.jsx)(f.X,{checked:z,onChange:e=>{D(e=>!e),et("is_out_of_turn",e.target.checked)}})})]})]}),(0,a.jsx)(S.Qr,{name:"doctor_id",control:el,render:()=>(0,a.jsx)(C.L,{disabled:!M&&((null==I?void 0:I.id)===2||void 0===(null==I?void 0:I.id)),filter:!0,className:"mb-3",value:E,onChange:e=>{T(e.value),et("doctor_id",e.value.id)},optionLabel:"full_name",options:Q,placeholder:"Doktor se\xe7in",invalid:!!ea.doctor_id})}),J("service.variable.service_type_id")&&(0,a.jsx)(b.Wi,{label:"Xidmət:",htmlFor:"service_types",children:(0,a.jsx)(S.Qr,{name:"service_types",control:el,render:()=>(0,a.jsx)(B.N,{filter:!0,value:p,onChange:ev,options:Y,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full",invalid:!!ea.service_types})})}),em&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{className:"mb-2",children:"Tarix və saat:"}),(0,a.jsxs)("div",{className:"flex align-center gap-2 mb-3",children:[(0,a.jsx)(S.Qr,{name:"reservation_date",control:el,render:()=>(0,a.jsx)(A.f,{dateFormat:"dd-mm-yy",invalid:!!ea.reservation_date,minDate:new Date,readOnlyInput:!0,value:U,onChange:e=>{$(e.value),et("reservation_date",e.value)}})}),(0,a.jsx)(S.Qr,{name:"hour",control:el,rules:{required:!0},render:()=>(0,a.jsx)(C.L,{disabled:!U,value:M,onChange:e=>{O(e.value),et("hour",e.value.time)},optionLabel:"time",options:V,optionDisabled:e=>!e.active,placeholder:"Saat se\xe7in",invalid:!M})}),(null==M?void 0:M.remaining_space)&&(0,a.jsx)(k.v,{severity:"info",content:(0,a.jsxs)("span",{style:{color:"white"},children:["Yer: ",M.remaining_space]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Depozit:"}),(0,a.jsx)(S.Qr,{name:"advance_amount",control:el,render:e=>{let{field:l}=e;return(0,a.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onClick:()=>Z(!0),onValueChange:e=>l.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3 w-full",invalid:!w})}})]}),(null==h?void 0:h.id)&&(0,a.jsx)("div",{className:"flex mb-3 flex-wrap gap-2",children:null===j.Yr||void 0===j.Yr?void 0:j.Yr.map(e=>(0,a.jsxs)("div",{className:"flex align-center",children:[(0,a.jsx)(W.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{H(e.value),et("status",e.value.id)},checked:(null==I?void 0:I.id)===(null==e?void 0:e.id)}),(0,a.jsx)("label",{htmlFor:null==e?void 0:e.name,className:"ml-2",children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,a.jsx)("div",{className:"dialog-footer",children:(0,a.jsx)(r.z,{label:"Saxla",disabled:P||!w,type:"submit"})})]})})},$=e=>{let{visible:l,onHide:i,booking:s,onSuccess:n,getBookings:r}=e,d=(0,t.useCallback)(async()=>{if(null==s?void 0:s.id)try{await u.Z.deleteBooking(s.id),i(),r(),n("Rezerv uğurla silindi")}catch(e){console.error("Failed to delete booking:",e)}},[null==s?void 0:s.id,i,r,n]);return(0,a.jsx)(b.QH,{visible:l,onHide:i,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==s?void 0:s.client_name,'" rezervini silmək istədiyinizə əminsiniz?')})},J=e=>{let{userPermissions:l}=e,[i,s]=(0,t.useState)([]),[n,d]=(0,t.useState)(null),[o,m]=(0,t.useState)(),[p,f]=(0,t.useState)(!1),[_,w]=(0,t.useState)(!1),[k,S]=(0,t.useState)(!1),[N,F]=(0,t.useState)(!1),[Z,E,z]=(0,T.Nr)("",400),[D,M,O]=(0,T.Nr)(null,400),[B,q]=(0,t.useState)(),[W,Q]=(0,t.useState)([new Date,new Date]),[X,V]=(0,t.useState)(!1),[L,P]=(0,t.useState)(),K=(0,t.useRef)(null),Y=(0,t.useRef)(null),G=(0,t.useCallback)(e=>l.includes(e),[l]),J=(0,t.useCallback)(e=>{var l;null===(l=K.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),ee=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];V(!0);try{let{data:e}=await u.Z.getBookings({status:null==n?void 0:n.id,from_date:(0,v.p6)(W[0]),to_date:(0,v.p6)(W[1]),client_name:E,client_phone:M});s(e)}catch(e){console.error("Failed to fetch bookings:",e)}finally{if(V(!1),e){var l;null===(l=Y.current)||void 0===l||l.scrollIntoView({behavior:"smooth"})}}},[null==n?void 0:n.id,W,E,M]);(0,t.useEffect)(()=>{W[1]&&ee()},[null==n?void 0:n.name,W,E,M,null==B?void 0:B.length]);let el=(0,t.useCallback)(e=>{m(e),f(!0)},[]),ei=(0,t.useCallback)(e=>{m(e),S(!0)},[]),ea=(0,t.useCallback)((e,l)=>X?(0,a.jsx)(H.O,{width:"20px"}):(0,a.jsx)("div",{children:n?l.rowIndex+1:i.length-l.rowIndex}),[X,n,i.length]),et=(0,t.useCallback)(e=>X?(0,a.jsx)(H.O,{width:"100px"}):e.reservation_date.slice(0,-3),[X]),es=(0,t.useCallback)(e=>X?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.client_name}),[X]),en=(0,t.useCallback)(e=>X?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:(0,v.CN)(e.client_phone)}),[X]),er=(0,t.useCallback)(e=>{var l;return X?(0,a.jsx)(H.O,{width:"150px"}):(null===(l=e.doctor)||void 0===l?void 0:l.name)&&"".concat(e.doctor.name," ").concat(e.doctor.surname)},[X]),ed=(0,t.useCallback)(e=>X?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.service_types.map(e=>(0,a.jsx)("div",{children:e.name},e.id))}),[X]),eo=(0,t.useCallback)(e=>X?(0,a.jsx)(H.O,{width:"100px"}):(0,v.T4)(e.advance_amount),[X]),ec=(0,t.useCallback)(e=>{switch(e){case"Ləğv":return"danger";case"Gəldi":return"warning";case"Qəbul edildi":return"success";case"G\xf6zlənilir":case"Online":return"info";default:return}},[]),eu=(0,t.useCallback)(e=>{var l;let i=null===(l=j.Yr.find(l=>(null==l?void 0:l.id)===e.status))||void 0===l?void 0:l.name;return X?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)(I.V,{value:i,severity:ec(i)})},[X,ec]),ev=(0,t.useCallback)(e=>X?(0,a.jsx)(H.O,{width:"60px"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>el(e)}),G("reservation.delete")&&(0,a.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>ei(e)})]}),[X,G,el,ei]),em=(0,t.useCallback)(()=>G("reservation.filter.status")?(0,a.jsx)(C.L,{value:n,options:[...j.Yr],onChange:e=>d(e.value),itemTemplate:e=>(0,a.jsx)(I.V,{value:e.name,severity:ec(e.name)}),placeholder:"Status",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"}):null,[G,n,ec]),eh=(0,t.useCallback)(()=>G("reservation.filter.date")?(0,a.jsx)(A.f,{minDate:G("reservation.get_past_data")?void 0:new Date,value:W,onChange:e=>Q(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[G,W]),ex=(0,t.useCallback)(()=>G("reservation.filter.client_name")?(0,a.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:Z,onChange:e=>z(e.target.value)}):null,[G,Z,z]),ep=(0,t.useCallback)(()=>G("reservation.filter.client_phone")?(0,a.jsx)(R.R,{className:"input-phone-filter",id:"client_phone",placeholder:"+994 99 999-99-99",value:D,onChange:e=>O(e.value),prefix:"+",useGrouping:!1}):null,[G,D,O]),ef=(0,t.useMemo)(()=>(0,a.jsx)(b.xD,{onFilterToggle:(0,v.Bv)(l)?()=>F(e=>!e):void 0,onRefresh:()=>ee(),rightContent:(0,a.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>f(!0)})}),[l,ee]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:i,dataKey:"id",header:ef,tableStyle:{minWidth:"50rem"},className:"table-container",filterDisplay:N?"row":void 0,paginator:!0,rows:10,children:[(0,a.jsx)(h.s,{body:ea,header:"#",style:{width:"2%"}}),(0,a.jsx)(h.s,{dataType:"date",header:"Tarix",body:et,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:eh}),(0,a.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:ex,showFilterMenu:!1,body:es}),(0,a.jsx)(h.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:ep,showFilterMenu:!1,body:en}),(0,a.jsx)(h.s,{header:"Status",body:eu,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:em}),(0,a.jsx)(h.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,body:ed}),(0,a.jsx)(h.s,{header:"Həkim",body:er,style:{width:"10%"},showFilterMenu:!1}),(0,a.jsx)(h.s,{header:"Depozit",body:eo,style:{width:"10%"}}),G("reservation.update")&&(0,a.jsx)(h.s,{body:ev,exportable:!1,style:{width:"10%"}})]})}),(0,a.jsx)(c.F,{ref:K}),(0,a.jsx)(U,{userPermissions:l,visible:p,onHide:()=>{f(!1),m(void 0)},onSuccess:J,booking:o,setBooking:m,getBookings:ee}),(0,a.jsx)(y.V,{header:"Reject comment",visible:_,style:{width:"50vw"},onHide:()=>{w(!1),P("")},children:(0,a.jsx)("p",{className:"m-0",children:L})}),(0,a.jsx)($,{booking:o,visible:k,onHide:()=>S(!1),onSuccess:J,getBookings:ee})]})},ee=i(4427),el=e=>{var l,i;let{userPermissions:s}=e,[n,d]=(0,t.useState)(),[o,c]=(0,t.useState)(),[m,f]=(0,t.useState)(!1),[j,_]=(0,t.useState)(!1),[g,w]=(0,t.useState)([new Date,new Date]),[C,k]=(0,t.useState)(0),[S,N]=(0,t.useState)(0),F=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;f(!0);try{let{data:l,meta:i}=await u.Z.getLogs({from_date:(0,v.p6)(g[0]),to_date:(0,v.p6)(g[1]),page:e});d(l),k(null==i?void 0:i.total)}catch(e){console.error("Failed to fetch logs:",e)}finally{f(!1)}},[g]);(0,t.useEffect)(()=>{g[1]&&F()},[F]);let Z=(0,t.useCallback)(e=>{N(e.first),F(e.page+1)},[F]),E=(0,t.useCallback)(e=>{c(e),_(!0)},[]),R=(0,t.useCallback)((e,l)=>m?(0,a.jsx)(H.O,{width:"20px"}):(0,a.jsx)("div",{children:C-l.rowIndex-S}),[m,C,S]),T=(0,t.useCallback)(e=>m?(0,a.jsx)(H.O,{width:"100px"}):e.service.created_at.slice(0,-3),[m]),z=(0,t.useCallback)(e=>m?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.service.client_name}),[m]),D=(0,t.useCallback)(e=>{var l,i,t,s;return m?(0,a.jsx)(H.O,{width:"150px"}):"".concat(null===(i=e.service)||void 0===i?void 0:null===(l=i.user)||void 0===l?void 0:l.name," ").concat(null===(s=e.service)||void 0===s?void 0:null===(t=s.user)||void 0===t?void 0:t.surname)},[m]),M=(0,t.useCallback)(e=>{var l,i,t;return m?(0,a.jsx)(H.O,{width:"150px"}):"".concat(null===(l=e.price_difference.causer)||void 0===l?void 0:l.name," ").concat(null===(t=e.price_difference)||void 0===t?void 0:null===(i=t.causer)||void 0===i?void 0:i.surname)},[m]),O=(0,t.useCallback)(e=>m?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.service.service_types.map(e=>(0,a.jsx)("div",{children:e.name},e.id))}),[m]),I=(0,t.useCallback)(e=>{var l;return m?(0,a.jsx)(H.O,{width:"100px"}):(0,v.T4)(null===(l=e.price_difference)||void 0===l?void 0:l.service_types_price_sum)},[m]),B=(0,t.useCallback)(e=>{var l;return m?(0,a.jsx)(H.O,{width:"100px"}):(0,v.T4)(null===(l=e.price_difference)||void 0===l?void 0:l.service_price_sum)},[m]),q=(0,t.useCallback)(e=>{var l;return m?(0,a.jsx)(H.O,{width:"100px"}):(0,v.T4)(null===(l=e.service)||void 0===l?void 0:l.advance_amount)},[m]),W=(0,t.useCallback)(e=>m?(0,a.jsx)(H.O,{width:"60px"}):(0,a.jsx)(r.z,{icon:"pi pi-question",rounded:!0,text:!0,severity:"secondary",onClick:()=>E(e)}),[m,E]),Q=(0,t.useMemo)(()=>(0,a.jsx)(b.xD,{leftContent:(0,a.jsx)(A.f,{value:g,onChange:e=>w(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"})}),[g]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:n,dataKey:"id",tableStyle:{minWidth:"50rem"},className:"table-container",header:Q,children:[(0,a.jsx)(h.s,{body:R,header:"#",style:{width:"2%"}}),(0,a.jsx)(h.s,{dataType:"date",header:"Tarix",body:T,style:{width:"10%"}}),(0,a.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",body:z,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Xidmət",body:O,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Doktor",body:D,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Səbəbkar",body:M,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Faktiki məbləğ",body:I,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Alınan məbləğ",body:B,style:{width:"10%"}}),(0,a.jsx)(h.s,{header:"Depozit",body:q,style:{width:"10%"}}),(0,a.jsx)(h.s,{body:W,exportable:!1,style:{width:"10%"}})]})}),(0,a.jsx)(p.D,{first:S,rows:10,totalRecords:C,onPageChange:Z}),(0,a.jsx)(y.V,{header:"Activity logs",visible:j,style:{width:"50vw"},onHide:()=>_(!1),children:(0,a.jsxs)("div",{className:"m-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Comment:"})," ",(null==o?void 0:null===(l=o.service)||void 0===l?void 0:l.comment)||"-"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Reject comment:"})," ",(null==o?void 0:null===(i=o.service)||void 0===i?void 0:i.reject_comment)||"-"]}),(0,a.jsx)(ee.L,{data:null==o?void 0:o.activity_logs})]})})]})},ei=e=>{let{userPermissions:l}=e,[i,s]=(0,t.useState)([]),[n,r]=(0,t.useState)(0),[d,o]=(0,t.useState)(0),[m]=(0,t.useState)(10),[f,j]=(0,t.useState)(1),[_,y]=(0,t.useState)(!1),[g,w]=(0,t.useState)([(0,v.Ur)(10),new Date]),C=(0,t.useRef)(null),k=(0,t.useCallback)(e=>l.includes(e),[l]),S=(0,t.useCallback)(async e=>{try{let{data:l,meta:i}=await u.Z.getAdvances({page:e,size:m,from_date:(0,v.p6)(g[0]),to_date:(0,v.p6)(g[1])});s(l),o(null==i?void 0:i.total)}catch(e){console.error("Failed to fetch advance transfers:",e)}},[m,g]);(0,t.useEffect)(()=>{g[1]&&S(f)},[S,g,f]);let N=(0,t.useCallback)(e=>{S(e.page+1),j(e.page+1),r(e.first)},[S]),F=(0,t.useCallback)(e=>(0,a.jsx)("div",{children:(null==e?void 0:e.user)?"".concat(e.user.name," ").concat(e.user.surname):"sistem"}),[]),Z=(0,t.useCallback)(e=>{var l,i;return(0,a.jsx)("div",{children:(0,v.O2)(null==e?void 0:null===(i=e.user)||void 0===i?void 0:null===(l=i.role)||void 0===l?void 0:l.id)})},[]),E=(0,t.useCallback)(()=>k("service.filter.date")?(0,a.jsx)(A.f,{value:g,onChange:e=>w(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[k,g]),R=(0,t.useMemo)(()=>(0,a.jsx)(b.xD,{onFilterToggle:(0,v.Bv)(l)?()=>y(e=>!e):void 0}),[l]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:i,editMode:"row",dataKey:"id",tableStyle:{minWidth:"50rem"},className:"table-container",header:R,filterDisplay:_?"row":void 0,children:[(0,a.jsx)(h.s,{field:"transferred_at",header:"Tarix və saat",style:{width:"20%"},filter:!0,filterElement:E}),(0,a.jsx)(h.s,{field:"user",header:"Bağlayan şəxs",body:F,style:{width:"20%"}}),(0,a.jsx)(h.s,{field:"role",body:Z,header:"Rol",style:{width:"20%"}})]})}),(0,a.jsx)(p.D,{first:n,rows:m,totalRecords:d,onPageChange:N}),(0,a.jsx)(c.F,{ref:C})]})},ea=e=>{let{userPermissions:l}=e,[i,s]=(0,t.useState)([]),[n,r]=(0,t.useState)(!1),[d,o]=(0,t.useState)(!1),[m,p]=(0,t.useState)(),[f,j]=(0,t.useState)([new Date,new Date]),[_,y]=(0,t.useState)(),[w,S,N]=(0,T.Nr)("",400),[F,Z,E]=(0,T.Nr)(null,400),[z,D]=(0,t.useState)(),[M,O]=(0,t.useState)(),I=(0,t.useRef)(null),B=(0,t.useCallback)(e=>l.includes(e),[l]),q=(0,t.useCallback)(async()=>{o(!0);try{let{data:e}=await u.Z.getReports({from_date:(0,v.p6)(f[0]),to_date:(0,v.p6)(f[1]),client_name:S,client_phone:Z,user_id:null==M?void 0:M.id});if(s(e),B("service.advance.info")){let e=await u.Z.getTotalAmount({from_date:(0,v.p6)(f[0]),to_date:(0,v.p6)(f[1]),client_name:S,client_phone:Z,user_id:null==M?void 0:M.id});p(e)}}catch(e){console.error("Failed to fetch reports:",e)}finally{o(!1)}},[f,S,Z,null==M?void 0:M.id,B]);(0,t.useEffect)(()=>{f[1]&&q()},[q]),(0,t.useEffect)(()=>{(async()=>{if(B("user.input_search")){let{data:e}=await u.Z.getDoctors();D(e)}})()},[B]);let W=(0,t.useCallback)((e,l)=>d?(0,a.jsx)(H.O,{width:"20px"}):(0,a.jsx)("div",{children:l.rowIndex+1}),[d]),Q=(0,t.useCallback)(e=>d?(0,a.jsx)(H.O,{width:"100px"}):e.date_time.slice(0,-3),[d]),X=(0,t.useCallback)(e=>d?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.client_name}),[d]),V=(0,t.useCallback)(e=>d?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:(0,v.CN)(e.client_phone)}),[d]),L=(0,t.useCallback)(e=>{var l,i;return d?(0,a.jsx)(H.O,{width:"150px"}):"".concat(null===(l=e.user)||void 0===l?void 0:l.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},[d]),P=(0,t.useCallback)(e=>d?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:"service"===e.service_type?"xidmət":"depozit"}),[d]),K=(0,t.useCallback)(e=>d?(0,a.jsx)(H.O,{width:"100px"}):(0,v.T4)(e.amount),[d]),Y=(0,t.useCallback)(()=>B("service.filter.date")?(0,a.jsx)(A.f,{value:f,onChange:e=>j(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[B,f]),G=(0,t.useCallback)(()=>B("service.filter.client_name")?(0,a.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:w,onChange:e=>N(e.target.value)}):null,[B,w,N]),U=(0,t.useCallback)(()=>B("service.filter.client_phone")?(0,a.jsx)(R.R,{className:"input-phone-filter",id:"client_phone",placeholder:"+994 99 999-99-99",value:F,onChange:e=>E(e.value),prefix:"+",useGrouping:!1}):null,[B,F,E]),$=(0,t.useCallback)(()=>B("service.filter.doctor")?(0,a.jsx)(C.L,{filter:!0,value:M,onChange:e=>O(e.value),options:z,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}):null,[B,M,z]),J=(0,t.useCallback)(e=>{var l,i;return(null!==(i=null===(l=e.amount_change_history)||void 0===l?void 0:l.length)&&void 0!==i?i:0)>1},[]),ee=(0,t.useCallback)(e=>d?(0,a.jsx)(H.O,{width:"100px"}):e.created_at.slice(0,-3),[d]),el=(0,t.useCallback)(e=>{var l,i;return d?(0,a.jsx)(H.O,{width:"150px"}):"".concat(null===(l=e.causer)||void 0===l?void 0:l.name," ").concat(null===(i=e.causer)||void 0===i?void 0:i.surname)},[d]),ei=(0,t.useCallback)(e=>(0,a.jsx)("div",{className:"p-3",children:(0,a.jsxs)(x.w,{value:e.amount_change_history,children:[(0,a.jsx)(h.s,{field:"date",header:"Tarix",body:ee}),(0,a.jsx)(h.s,{field:"amount",header:"Məbləğ",body:K}),(0,a.jsx)(h.s,{field:"status",header:"Qəbul edən",body:el})]})}),[ee,K,el]),ea=(0,t.useMemo)(()=>(0,a.jsxs)("div",{className:"total-info-content",children:[(0,a.jsxs)("div",{className:"ml-2",children:["Depozit: ",null==m?void 0:m.advance," AZN"]}),(0,a.jsxs)("div",{className:"ml-2",children:["Xidmətlər: ",null==m?void 0:m.amount," AZN"]}),(0,a.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==m?void 0:m.total," AZN"]})]}),[m]),et=(0,t.useMemo)(()=>(0,a.jsx)(b.xD,{onFilterToggle:(0,v.Bv)(l)?()=>r(e=>!e):void 0,onRefresh:q}),[l,q]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:i,dataKey:"id",header:et,tableStyle:{minWidth:"50rem"},className:"table-container",filterDisplay:n?"row":void 0,paginator:!0,rows:10,expandedRows:_,onRowToggle:e=>y(e.data),rowExpansionTemplate:ei,children:[(0,a.jsx)(h.s,{expander:J,style:{width:"2%"}}),(0,a.jsx)(h.s,{body:W,header:"#",style:{width:"2%"}}),(0,a.jsx)(h.s,{dataType:"date",header:"Tarix",body:Q,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:Y}),(0,a.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:G,showFilterMenu:!1,body:X}),B("service.variable.select_phone")&&(0,a.jsx)(h.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:U,showFilterMenu:!1,body:V}),(0,a.jsx)(h.s,{header:"Mənbə",style:{width:"10%"},showFilterMenu:!1,body:P}),(0,a.jsx)(h.s,{header:"Qəbul edən",body:L,style:{width:"10%"},filter:B("service.variable.user_id"),filterElement:$,showFilterMenu:!1}),(0,a.jsx)(h.s,{header:"Məbləğ",body:K,style:{width:"10%"}})]})}),B("service.get_all.total_amount")&&(0,a.jsx)("div",{className:"total-info",children:(0,a.jsx)(k.v,{className:"info-message",severity:"info",content:ea})}),(0,a.jsx)(c.F,{ref:I})]})},et=e=>{let{expense:l,visible:i,onHide:s,onSuccess:n,getExpenses:d}=e,{control:o,setValue:c,handleSubmit:v,formState:{errors:m},reset:h}=(0,S.cI)(),x=(0,t.useCallback)(()=>{s(),h()},[s,h]),p=(0,t.useCallback)(async e=>{let{name:i,amount:a=0,description:t}=e;try{(null==l?void 0:l.id)?await u.Z.updateExpense({name:i,amount:a,description:t,id:l.id}):await u.Z.createExpense({name:i,amount:a,description:t}),d(1),n("Xərc ".concat((null==l?void 0:l.id)?"yeniləndi":"əlavə olundu")),x()}catch(e){console.error("Failed to save expense:",e)}},[null==l?void 0:l.id,d,n,x]);return(0,t.useEffect)(()=>{(null==l?void 0:l.id)&&(c("name",l.name),c("amount",l.amount),c("description",l.description))},[l,c]),(0,a.jsx)(y.V,{visible:i,style:{width:"25rem"},header:"Xərc",modal:!0,onHide:x,children:(0,a.jsxs)("form",{onSubmit:v(p),className:"dialog-form",children:[(0,a.jsx)(b.Wi,{label:"Ad:",htmlFor:"name",children:(0,a.jsx)(S.Qr,{name:"name",control:o,rules:{required:!0},render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"name",invalid:!!(null==m?void 0:m.name),...l})}})}),(0,a.jsx)(b.Wi,{label:"İzah:",htmlFor:"description",children:(0,a.jsx)(S.Qr,{name:"description",control:o,rules:{required:!0},render:e=>{let{field:l}=e;return(0,a.jsx)(g.o,{id:"description",invalid:!!(null==m?void 0:m.description),...l})}})}),(0,a.jsx)(b.Wi,{label:"Qiymət:",htmlFor:"amount",children:(0,a.jsx)(S.Qr,{name:"amount",control:o,render:e=>{let{field:l}=e;return(0,a.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onValueChange:e=>l.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",invalid:!!m.amount})}})}),(0,a.jsx)("div",{className:"dialog-footer",children:(0,a.jsx)(r.z,{label:"Saxla",type:"submit"})})]})})},es=e=>{let{expense:l,visible:i,onHide:s,setExpenses:n,onSuccess:r}=e,d=(0,t.useCallback)(async()=>{if(null==l?void 0:l.id)try{await u.Z.deleteExpense(l.id),n(e=>e.filter(e=>e.id!==l.id)),s(),r("Xərc uğurla silindi")}catch(e){console.error("Failed to delete expense:",e)}},[null==l?void 0:l.id,n,s,r]);return(0,a.jsx)(b.QH,{visible:i,onHide:s,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==l?void 0:l.name,'" xərcini silmək istədiyinizə əminsiniz?')})},en=e=>{let{userPermissions:l}=e,[i,s]=(0,t.useState)(),[n,d]=(0,t.useState)([]),[o,m]=(0,t.useState)(0),[f]=(0,t.useState)(10),[j,_]=(0,t.useState)(0),[y,g]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),[S,N]=(0,t.useState)("0"),[F,Z]=(0,t.useState)([new Date,new Date]),[E,R]=(0,t.useState)(!1),[T,z]=(0,t.useState)(!1),D=(0,t.useRef)(null),M=(0,t.useCallback)(e=>l.includes(e),[l]),O=(0,t.useCallback)(e=>{var l;null===(l=D.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),I=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;C(!0);try{let{data:l,meta:i}=await u.Z.getExpenses({page:e,size:f,from_date:(0,v.p6)(F[0]),to_date:(0,v.p6)(F[1])}),{amount:a}=await u.Z.getExpensesTotal({from_date:(0,v.p6)(F[0]),to_date:(0,v.p6)(F[1])});N(a),d(l),m(null==i?void 0:i.total)}catch(e){console.error("Failed to fetch expenses:",e)}finally{C(!1)}},[f,F]);(0,t.useEffect)(()=>{F[1]&&I()},[I]);let B=(0,t.useCallback)(e=>{I(e.page+1),_(e.first)},[I]),q=(0,t.useCallback)(e=>{s(e),R(!0)},[]),W=(0,t.useCallback)(e=>{s(e),z(!0)},[]),Q=(0,t.useCallback)(e=>{var l;return w?(0,a.jsx)(H.O,{width:"100px"}):null===(l=e.created_at)||void 0===l?void 0:l.slice(0,-3)},[w]),X=(0,t.useCallback)(e=>w?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.name}),[w]),V=(0,t.useCallback)(e=>w?(0,a.jsx)(H.O,{width:"100px"}):(0,a.jsx)("div",{children:e.description}),[w]),L=(0,t.useCallback)(e=>(0,v.T4)(e.amount),[]),P=(0,t.useCallback)(e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>q(e)}),(0,a.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>W(e)})]}),[q,W]),K=(0,t.useCallback)(()=>M("service.filter.date")?(0,a.jsx)(A.f,{value:F,onChange:e=>Z(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[M,F]),Y=(0,t.useMemo)(()=>M("expense.create")?(0,a.jsx)(b.xD,{onFilterToggle:()=>g(e=>!e),onRefresh:()=>I(),leftContent:(0,a.jsx)(k.v,{className:"info-message",severity:"info",content:(0,a.jsxs)("div",{children:[S," AZN"]})}),rightContent:(0,a.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>R(!0)})}):null,[M,I,S]);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(x.w,{value:n,dataKey:"id",tableStyle:{minWidth:"50rem"},header:Y,className:"table-container",filterDisplay:y?"row":void 0,children:[(0,a.jsx)(h.s,{dataType:"date",header:"Tarix",body:Q,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:K}),(0,a.jsx)(h.s,{header:"Ad",body:X,style:{width:"10%"},showFilterMenu:!1}),(0,a.jsx)(h.s,{header:"Izah",body:V,style:{width:"10%"},showFilterMenu:!1}),(0,a.jsx)(h.s,{field:"price",header:"Məbləğ",body:L,style:{width:"10%"}}),M("expense.delete")&&(0,a.jsx)(h.s,{body:P,exportable:!1,style:{width:"10%"}})]})}),(0,a.jsx)(p.D,{first:j,rows:f,totalRecords:o,onPageChange:B}),(0,a.jsx)(c.F,{ref:D}),(0,a.jsx)(et,{expense:i,visible:E,onHide:()=>{R(!1),s(void 0)},onSuccess:O,getExpenses:I}),(0,a.jsx)(es,{expense:i,visible:T,onHide:()=>z(!1),setExpenses:d,onSuccess:O})]})};let er={TOKEN:"token",ACTIVE_TAB:"activeTabIndex"};var ed=function(){var e,l;let[i,h]=(0,t.useState)(),[x,p]=(0,t.useState)(()=>{{let e=localStorage.getItem(er.ACTIVE_TAB);return e?parseInt(e,10):0}}),f=(0,o.useRouter)(),j=(0,t.useRef)(null),b=(0,t.useMemo)(()=>{var e;return null!==(e=null==i?void 0:i.role.permissions.map(e=>null==e?void 0:e.name))&&void 0!==e?e:[]},[null==i?void 0:i.role.permissions]),_=(0,t.useCallback)(()=>{localStorage.clear(),f.push("/login")},[f]),y=(0,t.useCallback)(e=>{p(e),localStorage.setItem(er.ACTIVE_TAB,e.toString())},[]);(0,t.useEffect)(()=>{localStorage.getItem(er.TOKEN)||f.push("/login")},[f]),(0,t.useEffect)(()=>{(async()=>{try{var e;let{data:l}=await u.Z.getSelfInfo();(null==l?void 0:null===(e=l.role)||void 0===e?void 0:e.id)!==5||localStorage.getItem(er.ACTIVE_TAB)||(p(1),localStorage.setItem(er.ACTIVE_TAB,"1")),h(l)}catch(e){console.error("Failed to fetch user data:",e)}})()},[]),(0,t.useEffect)(()=>{j.current&&(0,m.x)(j.current)},[]);let g=(0,t.useCallback)(e=>b.includes(e),[b]);return(null==i?void 0:i.name)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("header",{className:"app-header",children:[(0,a.jsxs)("div",{className:"app-header-info",children:[(0,a.jsx)(n.q,{shape:"circle",label:null===(e=i.name[0])||void 0===e?void 0:e.toUpperCase(),className:"avatar-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"".concat(i.name," ").concat(i.surname)}),(0,a.jsx)("small",{children:(0,v.O2)(null===(l=i.role)||void 0===l?void 0:l.id)})]})]}),(0,a.jsx)(r.z,{icon:"pi pi-sign-out",severity:"info","aria-label":"Выход",onClick:_})]}),(0,a.jsx)(s.i,{}),(0,a.jsx)("main",{className:"app-main",children:(0,a.jsxs)(d.f,{activeIndex:x,onTabChange:e=>y(e.index),children:[g("service.get_all")&&(0,a.jsx)(d.x,{header:"Xidmətlər",children:(0,a.jsx)(L,{userPermissions:b,role:i.role})}),g("reservation.get_all")&&(0,a.jsx)(d.x,{header:"Rezervlər",children:(0,a.jsx)(J,{userPermissions:b})}),g("report.get_all")&&(0,a.jsx)(d.x,{header:"Kassa",children:(0,a.jsx)(ea,{userPermissions:b,role:i.role})}),g("reservation_time.get_all")&&(0,a.jsx)(d.x,{header:"Rezerv saatları",children:(0,a.jsx)(G,{userPermissions:b})}),g("expense.get_all")&&(0,a.jsx)(d.x,{header:"Xərclər",children:(0,a.jsx)(en,{userPermissions:b})}),g("advance_transfer.get_all")&&(0,a.jsx)(d.x,{header:"N\xf6vbələr",children:(0,a.jsx)(ei,{userPermissions:b})}),g("service_type.get_all")&&(0,a.jsx)(d.x,{header:"Xidmət n\xf6vləri",children:(0,a.jsx)(O,{userPermissions:b})}),g("user.get_all")&&(0,a.jsx)(d.x,{header:"İstifadə\xe7ilər",children:(0,a.jsx)(E,{userPermissions:b})}),g("service.bonus_reports")&&(0,a.jsx)(d.x,{header:"Bonuslar",children:(0,a.jsx)(P,{})}),g("action_log.get_all")&&(0,a.jsx)(d.x,{header:"Loglar",children:(0,a.jsx)(el,{userPermissions:b})})]})}),(0,a.jsx)(c.F,{ref:j})]}):null}}},function(e){e.O(0,[651,754,580,83,39,971,23,744],function(){return e(e.s=1542)}),_N_E=e.O()}]);