(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1542:function(e,l,a){Promise.resolve().then(a.bind(a,5447))},5447:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return ed}});var i=a(7437),t=a(2265),s=a(2102),n=a(2160),r=a(8708),d=a(5012),o=a(6463),c=a(2502),u=a(2959),v=a(7126),m=a(1398),h=a(8787),x=a(2193),p=a(5565),b=a(2163),j=a(1780),f=a(323),y=e=>{let{visible:l,onHide:a,user:s,onSuccess:n,setUsers:r}=e,d=(0,t.useCallback)(async()=>{if(null==s?void 0:s.id)try{await u.Z.deleteUser(s.id),r(e=>e.filter(e=>e.id!==s.id)),a(),n("İstifadə\xe7i uğurla silindi")}catch(e){console.error("Failed to delete user:",e)}},[null==s?void 0:s.id,r,a,n]);return(0,i.jsx)(f.QH,{visible:l,onHide:a,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==s?void 0:s.name," ").concat(null==s?void 0:s.surname,'" istifadə\xe7isini silmək istədiyinizə əminsiniz?')})},_=a(5472),g=a(8861),w=a(6498),C=a(7039),k=a(5313),S=a(9343),N=a(4245),F=a(7753),Z=e=>{let{user:l,visible:a,onHide:s,setUsers:n,onSuccess:d}=e,[o,c]=(0,t.useState)(),[v,m]=(0,t.useState)(),h=N.Ry().shape({name:N.Z_().required(),surname:N.Z_().required(),email:N.Z_().email("Yanlış email").required(),roleId:N.Rx().required(),password:(null==l?void 0:l.id)?N.Z_():N.Z_().required(),password_repeat:N.Z_().oneOf([N.iH("password")],"Şifrələr eyni olmalıdır"),customer_visible:N.O7(),day_off:N.Rx()}),{control:x,handleSubmit:p,formState:{errors:y},setValue:Z,reset:E}=(0,S.cI)({resolver:(0,F.X)(h),defaultValues:{name:void 0,surname:void 0,email:void 0,roleId:void 0,password:(null==l?void 0:l.id)?void 0:"",password_repeat:(null==l?void 0:l.id)?void 0:"",customer_visible:!1,day_off:void 0}}),R=(0,t.useCallback)(()=>{s(),E(),c(void 0),m(void 0)},[s,E]),T=(0,t.useCallback)(async e=>{try{let{data:a}=(null==l?void 0:l.id)?await u.Z.updateUser({...e,id:l.id}):await u.Z.createUser(e);n(e=>(null==l?void 0:l.id)?e.map(e=>e.id===a.id?a:e):[a,...e]),d("İstifadə\xe7i uğurla ".concat((null==l?void 0:l.id)?"yeniləndi":"yaradıldı")),R()}catch(e){console.error("Failed to save user:",e)}},[null==l?void 0:l.id,n,d,R]);return(0,t.useEffect)(()=>{if(null==l?void 0:l.id){var e,a;Z("name",l.name),Z("surname",l.surname),Z("email",l.email),Z("roleId",null===(e=l.role)||void 0===e?void 0:e.id),Z("customer_visible",null!==(a=l.customer_visible)&&void 0!==a&&a),Z("day_off",l.day_off),c(j.uJ.find(e=>{var a;return e.id===(null===(a=l.role)||void 0===a?void 0:a.id)})),m(j.en.find(e=>e.id===l.day_off))}},[l,Z]),(0,i.jsx)(_.V,{visible:a,style:{width:"328px"},header:"İstifadə\xe7i məlumatları",modal:!0,onHide:R,children:l&&(0,i.jsxs)("form",{onSubmit:p(T),className:"dialog-form",children:[(0,i.jsx)(f.Wi,{label:"Ad:",htmlFor:"name",children:(0,i.jsx)(S.Qr,{name:"name",control:x,render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"name",invalid:!!y.name,...l})}})}),(0,i.jsx)(f.Wi,{label:"Soyad:",htmlFor:"surname",children:(0,i.jsx)(S.Qr,{name:"surname",control:x,render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"surname",invalid:!!y.surname,...l})}})}),(0,i.jsx)(f.Wi,{label:"Email:",htmlFor:"email",children:(0,i.jsx)(S.Qr,{name:"email",control:x,render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"email",invalid:!!y.email,...l})}})}),(0,i.jsx)(f.Wi,{label:"Rol:",htmlFor:"roleId",children:(0,i.jsx)(S.Qr,{name:"roleId",control:x,render:()=>(0,i.jsx)(C.L,{value:o,onChange:e=>{c(e.value),Z("roleId",e.value.id)},options:j.uJ,optionLabel:"name",placeholder:"Rol se\xe7in",className:"w-full",invalid:!!y.roleId})})}),(0,i.jsx)(f.Wi,{label:"G\xf6stərilmə",htmlFor:"customer_visible",inline:!0,children:(0,i.jsx)(S.Qr,{name:"customer_visible",control:x,render:e=>{let{field:l}=e;return(0,i.jsx)(b.X,{inputId:"customer_visible",checked:!!l.value,onChange:e=>l.onChange(e.checked)})}})}),(0,i.jsx)(f.Wi,{label:"İstirahət g\xfcn\xfc:",htmlFor:"day_off",children:(0,i.jsx)(S.Qr,{name:"day_off",control:x,render:()=>(0,i.jsx)(C.L,{value:v,onChange:e=>{var l;m(e.value),Z("day_off",null===(l=e.value)||void 0===l?void 0:l.id)},options:j.en,optionLabel:"name",placeholder:"İstirahət g\xfcn\xfc se\xe7in",className:"w-full",showClear:!0})})}),(0,i.jsx)(f.Wi,{label:"Şifrə:",htmlFor:"password",children:(0,i.jsx)(S.Qr,{name:"password",control:x,render:e=>{let{field:l}=e;return(0,i.jsx)(w.r,{id:"password",toggleMask:!0,feedback:!1,invalid:!!y.password,...l})}})}),(0,i.jsx)(f.Wi,{label:"Şifrənin təsdiqi:",htmlFor:"password_repeat",children:(0,i.jsx)(S.Qr,{name:"password_repeat",control:x,render:e=>{let{field:l}=e;return(0,i.jsx)(w.r,{id:"password_repeat",toggleMask:!0,feedback:!1,invalid:!!y.password_repeat,...l})}})}),(0,i.jsxs)("div",{className:"dialog-footer-between",children:[(0,i.jsx)("div",{children:y.password_repeat&&(0,i.jsx)(k.v,{style:{maxWidth:"180px",height:"45px"},severity:"error",text:"Şifrələr eyni deyil"})}),(0,i.jsx)(r.z,{label:"Saxla",type:"submit"})]})]})})},E=e=>{let{userPermissions:l=[]}=e,[a,s]=(0,t.useState)([]),[n,d]=(0,t.useState)(0),[o,m]=(0,t.useState)({}),[_,g]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),[k,S]=(0,t.useState)(0),[N]=(0,t.useState)(10),[F,E]=(0,t.useState)(1),R=(0,t.useRef)(null),T=(0,t.useCallback)(e=>l.includes(e),[l]),D=(0,t.useCallback)(e=>{var l;null===(l=R.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),z=(0,t.useCallback)(async e=>{try{let{data:l,meta:a}=await u.Z.getUsers({page:e,size:N});s(l),S(null==a?void 0:a.total)}catch(e){console.error("Failed to fetch users:",e)}},[N]);(0,t.useEffect)(()=>{z(F)},[z,F]);let O=(0,t.useCallback)(e=>{z(e.page+1),E(e.page+1),d(e.first)},[z]),M=(0,t.useCallback)(e=>{m(e),g(!0)},[]),I=(0,t.useCallback)(e=>{m(e),C(!0)},[]),A=(0,t.useCallback)(e=>(0,i.jsx)("div",{children:(0,v.O2)(e.role.id)}),[]),H=(0,t.useCallback)(e=>(0,i.jsx)(b.X,{checked:!!e.customer_visible,disabled:!0}),[]),B=(0,t.useCallback)(e=>{let l=j.en.find(l=>l.id===e.day_off);return(0,i.jsx)("div",{children:(null==l?void 0:l.name)||"-"})},[]),W=(0,t.useCallback)(e=>(0,i.jsxs)(i.Fragment,{children:[T("user.update")&&(0,i.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>M(e)}),T("user.delete")&&(0,i.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>I(e)})]}),[T,M,I]),Q=(0,i.jsx)(f.xD,{rightContent:T("user.create")&&(0,i.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>g(!0)})});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:a,editMode:"row",dataKey:"id",header:Q,tableStyle:{minWidth:"50rem"},className:"table-container",children:[(0,i.jsx)(h.s,{field:"name",header:"Ad",style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"surname",header:"Soyad",style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"email",header:"Mail",style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"role",body:A,header:"Rol",style:{width:"15%"}}),(0,i.jsx)(h.s,{field:"customer_visible",header:"G\xf6stərilmə",body:H,style:{width:"10%"}}),(0,i.jsx)(h.s,{field:"day_off",header:"İstirahət g\xfcn\xfc",body:B,style:{width:"10%"}}),(0,i.jsx)(h.s,{body:W,exportable:!1,style:{width:"10%"}})]})}),(0,i.jsx)(p.D,{first:n,rows:N,totalRecords:k,onPageChange:O}),(0,i.jsx)(c.F,{ref:R}),(0,i.jsx)(y,{user:o,visible:w,onHide:()=>C(!1),setUsers:s,onSuccess:D}),(0,i.jsx)(Z,{user:o,setUsers:s,visible:_,onHide:()=>{g(!1),m({})},onSuccess:D})]})},R=a(891),T=a(1857);let D={name:"",price:0,customer_visible:!1};var z=e=>{let{visible:l,onHide:a,onSuccess:s,setServiceTypes:n}=e,[d,o]=(0,t.useState)(D),[c,v]=(0,t.useState)(!1),m=(0,t.useCallback)(()=>{o(D)},[]),h=(0,t.useCallback)(()=>{m(),a()},[m,a]),x=(0,t.useCallback)(async e=>{if(e.preventDefault(),d.name){v(!0);try{let{data:e}=await u.Z.createServiceType(d);n(l=>[e,...l]),s("Xidmət n\xf6v\xfc uğurla yaradıldı"),h()}catch(e){console.error("Failed to create service type:",e)}finally{v(!1)}}},[d,n,s,h]),p=(0,t.useCallback)(e=>{o(l=>({...l,name:e.target.value}))},[]),j=(0,t.useCallback)(e=>{o(l=>{var a;return{...l,price:null!==(a=e.value)&&void 0!==a?a:0}})},[]),y=(0,t.useCallback)(e=>{o(l=>{var a;return{...l,customer_visible:null!==(a=e.checked)&&void 0!==a&&a}})},[]);return(0,i.jsx)(_.V,{visible:l,modal:!0,onHide:h,header:"Yeni xidmət n\xf6v\xfc",style:{maxWidth:"400px",width:"100%"},children:(0,i.jsxs)("form",{onSubmit:x,className:"dialog-form",children:[(0,i.jsx)(f.Wi,{label:"Ad:",htmlFor:"name",children:(0,i.jsx)(g.o,{id:"name",value:d.name,onChange:p,required:!0})}),(0,i.jsx)(f.Wi,{label:"Qiymət:",htmlFor:"price",children:(0,i.jsx)(R.R,{id:"price",value:d.price,onValueChange:j,mode:"currency",currency:"AZN",locale:"de-DE"})}),(0,i.jsx)(f.Wi,{label:"G\xf6stərilmə",htmlFor:"customer_visible",inline:!0,children:(0,i.jsx)(b.X,{inputId:"customer_visible",checked:d.customer_visible,onChange:y})}),(0,i.jsxs)("div",{className:"dialog-footer",children:[(0,i.jsx)(r.z,{label:"Ləğv et",icon:"pi pi-times",outlined:!0,type:"button",onClick:h}),(0,i.jsx)(r.z,{label:"Saxla",icon:"pi pi-check",type:"submit",disabled:c||!d.name})]})]})})},O=e=>{let{serviceType:l,visible:a,onHide:s,setServiceTypes:n,onSuccess:r}=e,d=(0,t.useCallback)(async()=>{if(null==l?void 0:l.id)try{await u.Z.deleteServiceType(l.id),n(e=>e.filter(e=>e.id!==l.id)),r("Xidmət n\xf6v\xfc uğurla silindi"),s()}catch(e){console.error("Failed to delete service type:",e)}},[null==l?void 0:l.id,n,r,s]);return(0,i.jsx)(f.QH,{visible:a,onHide:s,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==l?void 0:l.name,'" xidmət n\xf6v\xfcn\xfc silmək istədiyinizə əminsiniz?')})},M=e=>{let{userPermissions:l=[]}=e,[a,s]=(0,t.useState)(),[n,d]=(0,t.useState)([]),[o,m]=(0,t.useState)(0),[j]=(0,t.useState)(10),[y,_]=(0,t.useState)(0),[w,C]=(0,t.useState)(!1),[k,S]=(0,t.useState)(!1),[N,F]=(0,t.useState)(!1),[Z,E,D]=(0,T.Nr)("",400),M=(0,t.useRef)(null),I=(0,t.useCallback)(e=>{var l;null===(l=M.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),A=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:l,meta:a}=await u.Z.getServiceTypes({page:e,size:j,name:E||void 0});d(l),m(null==a?void 0:a.total)}catch(e){console.error("Failed to fetch service types:",e)}},[j,E]);(0,t.useEffect)(()=>{A()},[A]);let H=(0,t.useCallback)(e=>{_(e.first),A(e.page+1)},[A]),B=(0,t.useCallback)(async e=>{let{newData:l}=e,{id:a,name:i,price:t=0,customer_visible:s}=l;try{await u.Z.updateServiceType({id:a,name:i,price:t,customer_visible:s}),d(e=>e.map(e=>e.id===a?{...l,name:i,price:t,id:a,customer_visible:s}:e)),I("Xidmət n\xf6v\xfc uğurla yeniləndi")}catch(e){console.error("Failed to update service type:",e)}},[I]),W=(0,t.useCallback)(e=>{s(e),F(!0)},[]),Q=(0,t.useCallback)(()=>{C(e=>!e)},[]),q=(0,t.useCallback)(e=>(0,i.jsx)(g.o,{type:"text",value:e.value,onChange:l=>e.editorCallback(l.target.value)}),[]),X=(0,t.useCallback)(e=>(0,i.jsx)(R.R,{value:e.value,onValueChange:l=>e.editorCallback(l.value),mode:"currency",currency:"AZN",locale:"de-DE"}),[]),L=(0,t.useCallback)(e=>(0,i.jsx)(b.X,{checked:!!e.value,onChange:l=>e.editorCallback(l.checked)}),[]),V=(0,t.useCallback)(e=>(0,v.T4)(e.price),[]),P=(0,t.useCallback)(e=>(0,i.jsx)(b.X,{checked:!!e.customer_visible,disabled:!0}),[]),K=(0,t.useCallback)(e=>(0,i.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>W(e)}),[W]),Y=(0,t.useCallback)(()=>(0,i.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:Z,onChange:e=>D(e.target.value)}),[Z,D]),G=(0,t.useCallback)(e=>(null==e?void 0:e.name)!=="Blue Band",[]),U=(0,t.useCallback)(e=>l.includes(e),[l]),J=(0,i.jsx)(f.xD,{onFilterToggle:Q,rightContent:U("service_type.create")&&(0,i.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>S(!0)})});return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:n,editMode:"row",dataKey:"id",onRowEditComplete:B,tableStyle:{minWidth:"50rem"},header:J,className:"table-container",filterDisplay:w?"row":void 0,children:[(0,i.jsx)(h.s,{field:"name",header:"Ad",editor:q,style:{width:"40%"},filter:!0,filterElement:Y,showFilterMenu:!1}),(0,i.jsx)(h.s,{field:"price",header:"Qiymət",body:V,editor:X,style:{width:"40%"}}),(0,i.jsx)(h.s,{field:"customer_visible",header:"G\xf6stərilmə",body:P,editor:L,style:{width:"40%"}}),U("service_type.update")&&(0,i.jsx)(h.s,{rowEditor:G,headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),U("service_type.delete")&&(0,i.jsx)(h.s,{body:K,exportable:!1,style:{width:"1%"}})]})}),(0,i.jsx)(p.D,{first:y,rows:j,totalRecords:o,onPageChange:H}),(0,i.jsx)(c.F,{ref:M}),(0,i.jsx)(z,{visible:k,onHide:()=>S(!1),onSuccess:I,setServiceTypes:d}),(0,i.jsx)(O,{serviceType:a,visible:N,onHide:()=>F(!1),setServiceTypes:d,onSuccess:I})]})},I=a(9749),A=a(7332),H=a(1395),B=a(8541),W=a(686),Q=a(1572),q=e=>{var l;let{visible:a,onHide:s,userPermissions:n,onSuccess:d,getServices:o,service:c,setService:v,role:m,page:h}=e,[x,p]=(0,t.useState)(),[b,y]=(0,t.useState)(),[w,k]=(0,t.useState)(0),[Z,E]=(0,t.useState)(),[T,D]=(0,t.useState)(),[z,O]=(0,t.useState)(!1),[M,I]=(0,t.useState)(),A=(null==m?void 0:m.id)===4,B=(0,t.useCallback)(e=>n.includes(e),[n]),q=N.Ry().shape({service_types:N.IX().of(N.Ry().shape({id:N.Rx().required()})).required(),client_name:N.Z_().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri adı m\xfctləqdir"),client_phone:B("service.variable.phone")?N.Z_().required():N.Z_().nullable(),user_id:B("service.variable.user_id")?N.Rx().required():N.Rx(),reject_comment:(null==Z?void 0:Z.id)===2&&B("service.variable.reject_comment")?N.Z_().required():N.Z_().nullable()}),{control:X,handleSubmit:L,formState:{errors:V},setValue:P,reset:K}=(0,S.cI)({resolver:(0,F.X)(q)}),Y=(0,t.useCallback)(()=>{s(),K(),v(void 0),p(void 0),y(void 0),E(void 0),k(0)},[s,K,v]),G=(0,t.useCallback)(async e=>{let l=(null==e?void 0:e.amount)||0;O(!0);try{var a;let i={...e,amount:l,client_phone:null===(a=e.client_phone)||void 0===a?void 0:a.toString().replace(/[\s-]/g,"")};(null==c?void 0:c.id)?await u.Z.updateService({...i,id:c.id}):await u.Z.createService(i),d("Xidmət uğurla saxlanıldı"),o(h),Y()}catch(e){console.error("Failed to save service:",e)}finally{O(!1)}},[null==c?void 0:c.id,d,o,h,Y]);(0,t.useEffect)(()=>{if(null==c?void 0:c.id){var e;P("client_name",c.client_name),P("client_phone",c.client_phone),P("user_id",null===(e=c.user)||void 0===e?void 0:e.id),U({value:null==c?void 0:c.service_types}),P("amount",+c.amount),P("advance_amount",+c.advance_amount),P("reject_comment",c.reject_comment),P("comment",c.comment);let l=0!==c.status?j.au.find(e=>(null==e?void 0:e.id)===c.status):A?{id:0,name:"New"}:{id:1,name:"Accepted"};P("status",null==l?void 0:l.id),E(l),y(null==T?void 0:T.find(e=>{var l;return e.id===(null===(l=c.user)||void 0===l?void 0:l.id)}))}},[c,P,T,A]),(0,t.useEffect)(()=>{(async()=>{if(B("user.input_search")){let{data:e}=await u.Z.getDoctors();D(e)}if(B("service_type.input_search")){let{data:e}=await u.Z.getInputServices();I(e)}})()},[B]),(0,t.useEffect)(()=>{var e;(null==M?void 0:M.length)&&(null==c?void 0:null===(e=c.service_types)||void 0===e?void 0:e.length)&&(p(c.service_types.map(e=>M.find(l=>l.id===e.id)).filter(Boolean)),P("service_types",c.service_types.map(e=>({id:e.id}))))},[M,null==c?void 0:c.service_types,P]);let U=(0,t.useCallback)(e=>{let l=e.value;p(l),P("service_types",null==l?void 0:l.map(e=>({id:e.id})));let a=(null==l?void 0:l.reduce((e,l)=>e+ +l.price,0))||0;k(a),P("amount",a-((null==c?void 0:c.advance_amount)||0))},[P,null==c?void 0:c.advance_amount]);return(0,i.jsx)(_.V,{visible:a,modal:!0,onHide:Y,header:"Xidmət",style:{maxWidth:"500px",width:"100%"},children:(0,i.jsxs)("form",{onSubmit:L(G),className:"dialog-form",children:[B("service.variable.client_name")&&(0,i.jsx)(f.Wi,{label:"M\xfcştəri adı:",htmlFor:"client_name",error:null===(l=V.client_name)||void 0===l?void 0:l.message,children:(0,i.jsx)(S.Qr,{name:"client_name",control:X,render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"client_name",invalid:!!V.client_name,...l})}})}),B("service.variable.phone")&&(0,i.jsx)(f.Wi,{label:"Telefon:",htmlFor:"client_phone",children:(0,i.jsx)(S.Qr,{name:"client_phone",control:X,rules:{minLength:12},render:e=>{var l;let{field:a}=e;return(0,i.jsx)(W.v,{id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!V.client_phone,...a,value:null!==(l=a.value)&&void 0!==l?l:""})}})}),B("service.variable.user_id")&&!A&&(0,i.jsx)(f.Wi,{label:"Həkim:",htmlFor:"user_id",children:(0,i.jsx)(S.Qr,{name:"user_id",control:X,render:e=>{let{field:l}=e;return(0,i.jsx)(C.L,{filter:!0,value:b,onChange:e=>{y(e.value),P("user_id",e.value.id)},optionLabel:"full_name",options:T,placeholder:"Doktor se\xe7in",invalid:!!V.user_id})}})}),B("service.variable.service_type_id")&&(0,i.jsx)(f.Wi,{label:"Xidmət:",htmlFor:"service_types",children:(0,i.jsx)(S.Qr,{name:"service_types",control:X,render:()=>(0,i.jsx)(H.N,{filter:!0,value:x,onChange:U,options:M,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full",invalid:!!V.service_types})})}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Toplam:"}),(0,i.jsx)(R.R,{disabled:!0,value:w,mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Depozit:"}),(0,i.jsx)(R.R,{disabled:!0,value:(null==c?void 0:c.advance_amount)||0,mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3"})]})]}),(0,i.jsxs)("div",{className:"form-row",children:[!A&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Alınacaq məbləğ:"}),(0,i.jsx)(R.R,{disabled:!0,value:w-((null==c?void 0:c.advance_amount)||0),mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{children:[A?"Alınacaq":"Alındı",":"]}),(0,i.jsx)(S.Qr,{name:"amount",control:X,render:e=>{let{field:l}=e;return(0,i.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onValueChange:e=>l.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3",invalid:!!V.amount})}})]})]}),B("service.variable.reject_comment")&&(0,i.jsx)(f.Wi,{label:"Comment:",htmlFor:"comment",children:(0,i.jsx)(S.Qr,{name:"comment",control:X,render:e=>{var l;let{field:a}=e;return(0,i.jsx)(g.o,{id:"comment",...a,value:null!==(l=a.value)&&void 0!==l?l:""})}})}),B("service.variable.reject_comment")&&(null==Z?void 0:Z.id)===2&&(0,i.jsx)(f.Wi,{label:"Reject comment:",htmlFor:"reject_comment",children:(0,i.jsx)(S.Qr,{name:"reject_comment",control:X,rules:{required:!0},render:e=>{var l;let{field:a}=e;return(0,i.jsx)(g.o,{id:"reject_comment",invalid:!!V.reject_comment,...a,value:null!==(l=a.value)&&void 0!==l?l:""})}})}),B("service.variable.status")&&(null==c?void 0:c.id)&&!A&&(0,i.jsx)("div",{className:"flex mb-3",children:j.au.map(e=>(null==e?void 0:e.id)!==0&&(0,i.jsxs)("div",{className:"flex align-center mr-3",children:[(0,i.jsx)(Q.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{E(e.value),P("status",e.value.id)},checked:(null==Z?void 0:Z.id)===(null==e?void 0:e.id)}),(0,i.jsx)("label",{htmlFor:null==e?void 0:e.name,className:"ml-2",children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,i.jsx)("div",{className:"dialog-footer",children:(0,i.jsx)(r.z,{label:"Saxla",disabled:z,type:"submit"})})]})})},X=e=>{let{visible:l,onHide:a}=e,[s,n]=(0,t.useState)(new Date),d=(0,t.useCallback)(()=>{s&&u.Z.getDailyReportExcel((0,v.p6)(s))},[s]);return(0,i.jsx)(_.V,{header:"Hesabatlar",visible:l,onHide:a,style:{minWidth:"400px"},children:(0,i.jsx)("div",{className:"flex flex-column gap-4",children:(0,i.jsxs)("div",{className:"flex justify-between align-center gap-4",children:[(0,i.jsx)(A.f,{value:s,onChange:e=>n(e.value),showIcon:!0,dateFormat:"dd/mm/yy"}),(0,i.jsx)(r.z,{severity:"success",label:"Export",icon:"pi pi-upload",onClick:d})]})})})},L=e=>{let{visible:l,onHide:a,service:s,onSuccess:n,getServices:r}=e,d=(0,t.useCallback)(async()=>{if(null==s?void 0:s.id)try{await u.Z.deleteService(s.id),a(),r(1),n("Xidmət uğurla silindi")}catch(e){console.error("Failed to delete service:",e)}},[null==s?void 0:s.id,a,r,n]);return(0,i.jsx)(f.QH,{visible:l,onHide:a,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==s?void 0:s.client_name,'" xidmətini silmək istədiyinizə əminsiniz?')})},V=e=>{let{userPermissions:l,role:a}=e,[s,n]=(0,t.useState)([]),[d,o]=(0,t.useState)(null),[m,b]=(0,t.useState)(),[y,w]=(0,t.useState)(),[S,N]=(0,t.useState)(),[F,Z]=(0,t.useState)(),[E,D]=(0,t.useState)(),[z,O]=(0,t.useState)(!1),[M,W]=(0,t.useState)(!1),[Q,V]=(0,t.useState)(!1),[P,K]=(0,t.useState)(!1),[Y,G]=(0,t.useState)(!1),[U,J]=(0,t.useState)(!1),[$,ee,el]=(0,T.Nr)("",400),[ea,ei,et]=(0,T.Nr)(null,400),[es,en]=(0,t.useState)([new Date,new Date]),[er,ed]=(0,t.useState)(1),[eo,ec]=(0,t.useState)(0),[eu,ev]=(0,t.useState)(0),[em]=(0,t.useState)(10),[eh,ex]=(0,t.useState)(!1),[ep,eb]=(0,t.useState)(),[ej,ef]=(0,t.useState)(),[ey,e_]=(0,t.useState)(!1),[eg,ew]=(0,t.useState)(),eC=(0,t.useRef)(null),ek=(0,t.useRef)(null),eS=(null==a?void 0:a.id)===4,eN=2===es.length&&(0,v.KC)(new Date(es[0]),new Date(es[1])),eF=(0,v.zk)(new Date(es[0])),eZ=(0,t.useCallback)(e=>l.includes(e),[l]),eE=(0,t.useCallback)(e=>{var l;null===(l=eC.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),eR=(0,t.useCallback)(async function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ex(!0);try{let{data:l,meta:a}=await u.Z.getServices({page:e,size:em,status:null==d?void 0:d.id,from_date:(0,v.p6)(es[0]),to_date:(0,v.p6)(es[1]),client_name:ee,client_phone:ei,service_types:null==E?void 0:E.map(e=>e.id),user_id:null==F?void 0:F.id});if(n(l),ev(null==a?void 0:a.total),eZ("service.get_all.total_amount")){let{data:e}=await u.Z.getAdvanceInfo((0,v.p6)(es[0]));ef(e)}if(eZ("service.advance.info")){let e=await u.Z.getTotalAmount({status:null==d?void 0:d.id,from_date:(0,v.p6)(es[0]),to_date:(0,v.p6)(es[1]),client_name:ee,client_phone:ei,service_types:null==E?void 0:E.map(e=>e.id),user_id:null==F?void 0:F.id});eb(e)}let i=await u.Z.getTimeZone();e_(!(0,v.Yu)(i.date_time))}catch(e){console.error("Failed to fetch services:",e)}finally{if(ex(!1),l){var a;null===(a=ek.current)||void 0===a||a.scrollIntoView({behavior:"smooth"})}}},[em,null==d?void 0:d.id,es,ee,ei,E,null==F?void 0:F.id,eZ]);(0,t.useEffect)(()=>{es[1]&&eR(er)},[null==d?void 0:d.name,es,ee,ei,null==E?void 0:E.length,F]),(0,t.useEffect)(()=>{(async()=>{if(eZ("user.input_search")){let{data:e}=await u.Z.getDoctors();w(e)}if(eZ("service_type.input_search")){let{data:e}=await u.Z.getInputServices();b(e)}})()},[eZ]);let eT=(0,t.useCallback)(e=>{ec(e.first),eR(e.page+1,!0),ed(e.page+1)},[eR]),eD=(0,t.useCallback)(e=>{N(e),O(!0)},[]),ez=(0,t.useCallback)(e=>{N(e),K(!0)},[]),eO=(0,t.useCallback)(()=>{u.Z.getAllReportsExcel({status:null==d?void 0:d.id,from_date:(0,v.p6)(es[0]),to_date:(0,v.p6)(es[1]),client_name:ee,client_phone:ei,service_types:null==E?void 0:E.map(e=>e.id),user_id:null==F?void 0:F.id})},[null==d?void 0:d.id,es,ee,ei,E,null==F?void 0:F.id]),eM=(0,t.useCallback)(async()=>{try{await u.Z.advanceTransfer(),G(!1);let{data:e}=await u.Z.getAdvanceInfo((0,v.p6)(es[0]));ef(e),eE("N\xf6vbə bağlandı")}catch(e){console.error("Failed to transfer advance:",e)}},[es,eE]),eI=(0,t.useCallback)(async()=>{try{await u.Z.advanceCancel((0,v.p6)(es[0]));let{data:e}=await u.Z.getAdvanceInfo((0,v.p6)(es[0]));ef(e),eE("N\xf6vbə yenidən a\xe7ıldı")}catch(e){console.error("Failed to cancel advance:",e)}},[es,eE]),eA=(0,t.useCallback)((e,l)=>eh?(0,i.jsx)(B.O,{width:"20px"}):(0,i.jsx)("div",{children:eu-l.rowIndex-eo}),[eh,eu,eo]),eH=(0,t.useCallback)(e=>eh?(0,i.jsx)(B.O,{width:"100px"}):e.created_at.slice(0,-3),[eh]),eB=(0,t.useCallback)(e=>eh?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.client_name}),[eh]),eW=(0,t.useCallback)(e=>eh?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:(0,v.CN)(e.client_phone)}),[eh]),eQ=(0,t.useCallback)(e=>{var l,a;return eh?(0,i.jsx)(B.O,{width:"150px"}):"".concat(null===(l=e.user)||void 0===l?void 0:l.name," ").concat(null===(a=e.user)||void 0===a?void 0:a.surname)},[eh]),eq=(0,t.useCallback)(e=>{let l=+(null==e?void 0:e.amount)?+e.amount+e.advance_amount:+e.services_total;return eh?(0,i.jsx)(B.O,{width:"100px"}):(0,v.T4)(l)},[eh]),eX=(0,t.useCallback)(e=>eh?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.service_types.map(e=>(0,i.jsx)("div",{children:e.name},e.id))}),[eh]),eL=(0,t.useCallback)(e=>{switch(e){case"Rejected":return"danger";case"Accepted":return"success";case"New":return"info";default:return}},[]),eV=(0,t.useCallback)(e=>{var l;let a=null===(l=j.au.find(l=>(null==l?void 0:l.id)===e.status))||void 0===l?void 0:l.name;return eh?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)(I.V,{onClick:()=>{"Rejected"===a&&(ew(e.reject_comment),V(!0))},icon:"Rejected"===a?"pi pi-info-circle":void 0,value:a,severity:eL(a),className:"status-badge"})},[eh,eL]),eP=(0,t.useCallback)(e=>eh?(0,i.jsx)(B.O,{width:"60px"}):(0,i.jsxs)(i.Fragment,{children:[((null==e?void 0:e.status)===0&&eS||!eS)&&(0,i.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>eD(e)}),eZ("service.delete")&&(0,i.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>ez(e)})]}),[eh,eS,eZ,eD,ez]),eK=(0,t.useCallback)(()=>eZ("service.filter.status")?(0,i.jsx)(C.L,{value:d,options:j.au,onChange:e=>o(e.value),itemTemplate:e=>(0,i.jsx)(I.V,{value:e.name,severity:eL(e.name)}),placeholder:"Status",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"}):null,[eZ,d,eL]),eY=(0,t.useCallback)(()=>eZ("service.filter.date")?(0,i.jsx)(A.f,{value:es,onChange:e=>en(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[eZ,es]),eG=(0,t.useCallback)(()=>eZ("service.filter.client_name")?(0,i.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:$,onChange:e=>el(e.target.value)}):null,[eZ,$,el]),eU=(0,t.useCallback)(()=>eZ("service.filter.client_phone")?(0,i.jsx)(R.R,{className:"input-phone-filter",id:"client_phone",placeholder:"+994 99 999-99-99",value:ea,onChange:e=>et(e.value),prefix:"+",useGrouping:!1}):null,[eZ,ea,et]),eJ=(0,t.useCallback)(()=>eZ("service.filter.service_type")?(0,i.jsx)(H.N,{filter:!0,value:E,onChange:e=>D(e.value),options:m,placeholder:"Xidmət se\xe7in",optionLabel:"name",showClear:!0}):null,[eZ,E,m]),e$=(0,t.useCallback)(()=>eZ("service.filter.doctor")?(0,i.jsx)(C.L,{filter:!0,value:F,onChange:e=>Z(e.value),options:y,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}):null,[eZ,F,y]),e0=(0,t.useMemo)(()=>(0,i.jsxs)("div",{className:"total-info-content",children:[(0,i.jsxs)("div",{className:"ml-2",children:["Depozit: ",null==ep?void 0:ep.advance," AZN"]}),(0,i.jsxs)("div",{className:"ml-2",children:["Xidmətlər: ",null==ep?void 0:ep.amount," AZN"]}),(0,i.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==ep?void 0:ep.total," AZN"]})]}),[ep]),e1=(0,t.useMemo)(()=>{var e,l;return(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"ml-2",children:"N\xf6vbə bağlanıb"}),(0,i.jsxs)("div",{className:"ml-2",children:[null==ej?void 0:null===(e=ej.user)||void 0===e?void 0:e.name," ",null==ej?void 0:null===(l=ej.user)||void 0===l?void 0:l.surname]}),(0,i.jsx)("div",{className:"ml-2",children:null==ej?void 0:ej.transferred_at})]}),eZ("reservation.next_day_transfer.cancel")&&(0,i.jsx)(r.z,{icon:"pi pi-undo",tooltip:"N\xf6vbəni yenidən a\xe7",onClick:eI,disabled:!eF})]})},[ej,eZ,eI,eF]),e9=(0,t.useMemo)(()=>(0,i.jsx)(f.xD,{onFilterToggle:(0,v.Bv)(l)?()=>J(e=>!e):void 0,onRefresh:()=>eR(er),rightContent:(0,i.jsxs)(i.Fragment,{children:[eZ("service.all_reports")&&!!s.length&&(0,i.jsx)(r.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:eO}),eZ("service.daily_report")&&(0,i.jsx)(r.z,{label:"G\xfcn sonu",icon:"pi pi-file-excel",severity:"success",onClick:()=>W(!0)}),eZ("service.create")&&(0,i.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>O(!0)})]})}),[l,er,s.length,eZ,eO,eR]);return ey?(0,i.jsx)("div",{children:"Ağıllısanda\uD83D\uDE02"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:s,dataKey:"id",header:e9,tableStyle:{minWidth:"50rem"},className:"table-container",filterDisplay:U?"row":void 0,children:[(0,i.jsx)(h.s,{body:eA,header:"#",style:{width:"2%"}}),(0,i.jsx)(h.s,{dataType:"date",header:"Tarix",body:eH,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:eY}),(0,i.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:eG,showFilterMenu:!1,body:eB}),eZ("service.variable.select_phone")&&(0,i.jsx)(h.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:eU,showFilterMenu:!1,body:eW}),(0,i.jsx)(h.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,filter:eZ("service.variable.service_type_id"),filterElement:eJ,body:eX}),(0,i.jsx)(h.s,{header:"Həkim",body:eQ,style:{width:"10%"},showFilterMenu:!1,filter:eZ("service.variable.user_id"),filterElement:e$}),(0,i.jsx)(h.s,{header:"Məbləğ",body:eq,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Status",body:eV,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:eK}),(0,i.jsx)(h.s,{body:eP,exportable:!1,style:{width:"10%"}})]})}),(0,i.jsx)("div",{ref:ek,children:(0,i.jsx)(p.D,{first:eo,rows:em,totalRecords:eu,onPageChange:eT})}),eZ("service.get_all.total_amount")&&(0,i.jsxs)("div",{className:"total-info",children:[(0,i.jsx)(k.v,{className:"info-message mr-5",severity:"info",content:e0}),eN&&!eh&&((null==ej?void 0:ej.id)&&eZ("service.advance.info")?(0,i.jsx)(k.v,{content:e1}):eZ("reservation.next_day_transfer")&&(0,i.jsx)(r.z,{onClick:()=>G(!0),disabled:!eF,children:"N\xf6vbəni bağla"}))]}),(0,i.jsx)(c.F,{ref:eC}),(0,i.jsx)(q,{userPermissions:l,visible:z,onHide:()=>{O(!1),N(void 0)},onSuccess:eE,service:S,setService:N,getServices:eR,role:a,page:er}),(0,i.jsx)(X,{visible:M,onHide:()=>W(!1)}),(0,i.jsx)(_.V,{header:"Reject comment",visible:Q,style:{width:"50vw"},onHide:()=>{V(!1),ew("")},children:(0,i.jsx)("p",{className:"m-0",children:eg})}),(0,i.jsx)(f.QH,{visible:Y,onHide:()=>G(!1),onConfirm:eM,header:"N\xf6vbəni bağla",message:"N\xf6vbənin bağlanılmasına əminsiniz?"}),(0,i.jsx)(L,{service:S,visible:P,onHide:()=>K(!1),onSuccess:eE,getServices:eR})]})},P=()=>{let[e,l]=(0,t.useState)(),[a,s]=(0,t.useState)([new Date,new Date]),[n,d]=(0,t.useState)(),[o,c]=(0,t.useState)(),[m,p]=(0,t.useState)({}),[b,j]=(0,t.useState)(),y=(0,t.useCallback)(async()=>{try{let{data:e}=await u.Z.getBonuses({from_date:(0,v.p6)(a[0]),to_date:(0,v.p6)(a[1]),user_id:null==o?void 0:o.id}),{data:i}=await u.Z.getBonusesCoefficient();l(e),j(null==i?void 0:i.coefficient)}catch(e){console.error("Failed to fetch bonuses:",e)}},[a,null==o?void 0:o.id]);(0,t.useEffect)(()=>{a[1]&&y()},[y]),(0,t.useEffect)(()=>{b&&u.Z.patchBonusCoefficient(b)},[b]),(0,t.useEffect)(()=>{(async()=>{let{data:e}=await u.Z.getDoctors();d(e)})()},[]);let _=(0,t.useCallback)(e=>{let l=b||1;return(0,v.T4)(+e/l)},[b]),g=(0,t.useCallback)(e=>{var l,a;return"".concat(null===(l=e.user)||void 0===l?void 0:l.name," ").concat(null===(a=e.user)||void 0===a?void 0:a.surname)},[]),w=(0,t.useCallback)(e=>(0,v.T4)(e.total_amount),[]),k=(0,t.useCallback)(e=>_(e.total_amount),[_]),S=(0,t.useCallback)(e=>(0,v.T4)(e.bonus_per_days),[]),N=(0,t.useCallback)(e=>_(e.bonus_per_days),[_]),F=(0,t.useCallback)(()=>{u.Z.getBonusesExcel({from_date:(0,v.p6)(a[0]),to_date:(0,v.p6)(a[1]),user_id:null==o?void 0:o.id})},[a,null==o?void 0:o.id]),Z=(0,t.useCallback)(e=>{var l;return(null===(l=e.bonus_per_days)||void 0===l?void 0:l.length)>0},[]),E=(0,t.useCallback)(e=>(0,i.jsx)("div",{children:(0,i.jsxs)(x.w,{value:e.bonus_per_days,children:[(0,i.jsx)(h.s,{field:"date",header:"Tarix",style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"bonus_per_days",header:"Məbləğ",body:S,style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"bonus_per_days",header:"Bonus",body:N,style:{width:"90%"}})]})}),[S,N]),T=(0,t.useMemo)(()=>(0,i.jsx)(f.xD,{leftContent:(0,i.jsxs)("div",{className:"flex align-center gap-3",children:[(0,i.jsx)(A.f,{value:a,onChange:e=>s(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}),(0,i.jsx)(C.L,{filter:!0,value:o,onChange:e=>c(e.value),options:n,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}),(0,i.jsx)(R.R,{style:{maxWidth:"80px"},value:b,onValueChange:e=>j(e.value||0)})]}),rightContent:(0,i.jsx)(r.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:F})}),[a,o,n,b,F]);return(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:e,editMode:"row",dataKey:"user.id",className:"table-container",header:T,expandedRows:m,onRowToggle:e=>p(e.data),rowExpansionTemplate:E,children:[(0,i.jsx)(h.s,{expander:Z}),(0,i.jsx)(h.s,{body:g,header:"Həkim",style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"total_amount",header:"Toplam məbləğ",body:w,style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"total_amount",header:"Bonus",body:k,style:{width:"60%"}})]})})})},K=e=>{let{visible:l,onHide:a,onSuccess:s,setBookingTimes:n}=e,{control:d,handleSubmit:o,formState:{errors:c},reset:v}=(0,S.cI)(),m=(0,t.useCallback)(()=>{a(),v()},[a,v]),h=(0,t.useCallback)(async e=>{let{time:l,reservation_count:a=0}=e;try{let{data:e}=await u.Z.createBookingTime({reservation_count:a,time:l});n(l=>[...l,e]),s("Rezervasiya saatı uğurla yaradıldı"),m()}catch(e){console.error("Failed to create booking time:",e)}},[n,s,m]);return(0,i.jsx)(_.V,{visible:l,style:{width:"25rem"},header:"Rezerv saatı",modal:!0,onHide:m,children:(0,i.jsxs)("form",{onSubmit:o(h),className:"dialog-form",children:[(0,i.jsx)(f.Wi,{label:"Saat:",htmlFor:"time",children:(0,i.jsx)(S.Qr,{name:"time",control:d,rules:{required:!0},render:e=>{let{field:l}=e;return(0,i.jsx)(W.v,{id:"time",mask:"99:99",invalid:!!c.time,...l})}})}),(0,i.jsx)(f.Wi,{label:"Limit:",htmlFor:"reservation_count",children:(0,i.jsx)(S.Qr,{name:"reservation_count",control:d,render:e=>{let{field:l}=e;return(0,i.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onValueChange:e=>l.onChange(e),invalid:!!c.reservation_count})}})}),(0,i.jsx)("div",{className:"dialog-footer",children:(0,i.jsx)(r.z,{label:"Saxla",type:"submit"})})]})})},Y=e=>{let{bookingTime:l,visible:a,onHide:s,setBookingTimes:n,onSuccess:r}=e,d=(0,t.useCallback)(async()=>{if(null==l?void 0:l.id)try{await u.Z.deleteBookingTime(l.id),n(e=>e.filter(e=>e.id!==l.id)),s(),r("Rezerv saatı uğurla silindi")}catch(e){console.error("Failed to delete booking time:",e)}},[null==l?void 0:l.id,n,s,r]);return(0,i.jsx)(f.QH,{visible:a,onHide:s,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==l?void 0:l.time,'" saatını silmək istədiyinizə əminsiniz?')})},G=e=>{let{userPermissions:l=[]}=e,[a,s]=(0,t.useState)(),[n,d]=(0,t.useState)([]),[o,v]=(0,t.useState)(0),[m]=(0,t.useState)(10),[b,j]=(0,t.useState)(0),[y,_]=(0,t.useState)(!1),[g,w]=(0,t.useState)(!1),C=(0,t.useRef)(null),k=(0,t.useCallback)(e=>l.includes(e),[l]),S=(0,t.useCallback)(e=>{var l;null===(l=C.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),N=(0,t.useCallback)(e=>null==e?void 0:e.sort((e,l)=>{let a=e.time.split(":").map(Number),i=l.time.split(":").map(Number);return a[0]!==i[0]?a[0]-i[0]:a[1]-i[1]}),[]),F=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:l,meta:a}=await u.Z.getBookingTimes({page:e,size:m});d(N(l)),v(null==a?void 0:a.total)}catch(e){console.error("Failed to fetch booking times:",e)}},[m,N]);(0,t.useEffect)(()=>{F()},[F]);let Z=(0,t.useCallback)(e=>{j(e.first),F(e.page+1)},[F]),E=(0,t.useCallback)(async e=>{let{newData:l}=e,{id:a,time:i,reservation_count:t=0}=l;try{await u.Z.updateBookingTime({id:a,time:i,reservation_count:t}),d(e=>e.map(e=>e.id===a?{...l,time:i,reservation_count:t,id:a}:e)),S("Rezerv saatı uğurla yeniləndi")}catch(e){console.error("Failed to update booking time:",e)}},[S]),T=(0,t.useCallback)(e=>{s(e),w(!0)},[]),D=(0,t.useCallback)(e=>(0,i.jsx)(W.v,{mask:"99:99",value:e.value,onChange:l=>e.editorCallback(l.target.value)}),[]),z=(0,t.useCallback)(e=>(0,i.jsx)(R.R,{value:e.value,onValueChange:l=>e.editorCallback(l.value)}),[]),O=(0,t.useCallback)(e=>(null==e?void 0:e.time)!=="Blue Band",[]),M=(0,t.useCallback)(e=>(0,i.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>T(e)}),[T]),I=k("reservation_time.create")?(0,i.jsx)(f.xD,{rightContent:(0,i.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>_(!0)})}):null;return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:n,editMode:"row",dataKey:"id",onRowEditComplete:E,tableStyle:{minWidth:"50rem"},header:I,className:"table-container",children:[(0,i.jsx)(h.s,{field:"time",header:"Saat",editor:D,style:{width:"40%"}}),(0,i.jsx)(h.s,{field:"reservation_count",header:"Limit",editor:z,style:{width:"40%"}}),k("reservation_time.update")&&(0,i.jsx)(h.s,{rowEditor:O,headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),k("reservation_time.delete")&&(0,i.jsx)(h.s,{body:M,exportable:!1,style:{width:"1%"}})]})}),(0,i.jsx)(p.D,{first:b,rows:m,totalRecords:o,onPageChange:Z}),(0,i.jsx)(c.F,{ref:C}),(0,i.jsx)(K,{visible:y,onHide:()=>_(!1),onSuccess:S,setBookingTimes:d}),(0,i.jsx)(Y,{bookingTime:a,visible:g,onHide:()=>w(!1),setBookingTimes:d,onSuccess:S})]})},U=e=>{var l,a;let{visible:s,onHide:n,userPermissions:d,onSuccess:o,getBookings:c,booking:m,setBooking:h}=e,[x,p]=(0,t.useState)(),[y,w]=(0,t.useState)(!1),[Z,E]=(0,t.useState)(),[T,D]=(0,t.useState)(!1),[z,O]=(0,t.useState)(),[M,I]=(0,t.useState)(),[B,q]=(0,t.useState)([]),[X,L]=(0,t.useState)(),[V,P]=(0,t.useState)(!1),[K,Y]=(0,t.useState)(),[G,U]=(0,t.useState)(null),J=(0,t.useCallback)(e=>d.includes(e),[d]),$=N.Ry().shape({service_types:(null==M?void 0:M.id)===3?N.IX().of(N.Ry().shape({id:N.Rx().required()})).min(1).required():N.IX(),client_name:N.Z_().matches(/^[A-Za-z ]+$/,"Yalnız ingilis şrifti").required("M\xfcştəri adı m\xfctləqdir"),client_phone:J("service.variable.phone")?N.Z_().required():N.Z_(),doctor_id:(null==M?void 0:M.id)===3?N.Rx().required():N.Rx(),hour:N.Z_().required()}),{control:ee,handleSubmit:el,formState:{errors:ea},setValue:ei,getValues:et,reset:es}=(0,S.cI)({resolver:(0,F.X)($)}),en=(0,t.useCallback)(()=>{n(),es(),h(void 0),p(void 0),E(void 0),I(void 0),O(void 0),U(null),q([]),D(!1),w(!1)},[n,es,h]),er=(0,t.useCallback)(async e=>{P(!0);let l=(null==e?void 0:e.advance_amount)||0;try{var a;let i={...e,advance_amount:l,client_name:e.client_name,doctor_id:e.doctor_id,client_phone:null===(a=e.client_phone)||void 0===a?void 0:a.toString().replace(/[\s-]/g,"")};(null==m?void 0:m.id)?await u.Z.updateBooking({...i,id:m.id,reservation_date:(null==M?void 0:M.id)===2?"".concat((0,v.p6)(G)," ").concat(null==z?void 0:z.time):null==m?void 0:m.reservation_date,status:e.status}):await u.Z.createBooking({...i,reservation_date:"".concat((0,v.p6)(G)," ").concat(null==z?void 0:z.time)}),o("Rezerv uğurla saxlanıldı"),c(),en()}catch(e){console.error("Failed to save booking:",e)}finally{P(!1)}},[null==m?void 0:m.id,null==m?void 0:m.reservation_date,null==M?void 0:M.id,G,null==z?void 0:z.time,o,c,en]);(0,t.useEffect)(()=>{if(null==m?void 0:m.id){ei("client_name",m.client_name),ei("client_phone",m.client_phone),ei("is_out_of_turn",m.is_out_of_turn),D(m.is_out_of_turn);let[e,l,a]=m.reservation_date.split("-"),[i,t]=a.split(" "),s=new Date("".concat(i,"-").concat(l,"-").concat(e,"T").concat(t));ei("reservation_date",s),U(s),ei("status",m.status),ei("advance_amount",m.advance_amount),I(j.Yr.find(e=>(null==e?void 0:e.id)===m.status))}},[m,ei]),(0,t.useEffect)(()=>{var e;(null==m?void 0:m.id)&&(null==m?void 0:null===(e=m.doctor)||void 0===e?void 0:e.id)&&(async()=>{var e;let{data:l}=await u.Z.getDoctorById(m.doctor.id);ei("doctor_id",null===(e=m.doctor)||void 0===e?void 0:e.id),E({id:l.id,full_name:"".concat(null==l?void 0:l.name," ").concat(null==l?void 0:l.surname)}),(null==B?void 0:B.map(e=>null==e?void 0:e.id).includes((null==Z?void 0:Z.id)||0))||q(e=>[...e,{id:l.id,full_name:"".concat(null==l?void 0:l.name," ").concat(null==l?void 0:l.surname)}])})()},[null==m?void 0:m.id,null==m?void 0:null===(l=m.doctor)||void 0===l?void 0:l.id,null==z?void 0:z.time]),(0,t.useEffect)(()=>{(async()=>{if(J("user.input_search")&&(null==z?void 0:z.time)&&!(null==B?void 0:B.map(e=>null==e?void 0:e.id).includes((null==Z?void 0:Z.id)||0))){let{data:e}=T?await u.Z.getDoctors():await u.Z.getBookingDoctors("".concat((0,v.p6)(G)," ").concat(null==z?void 0:z.time));q(e)}else{let{data:e}=await u.Z.getDoctors();q(e),!(null==B?void 0:B.map(e=>null==e?void 0:e.id).includes((null==Z?void 0:Z.id)||0))&&(null==Z?void 0:Z.id)&&q(e=>[...e,{id:Z.id,full_name:null==Z?void 0:Z.full_name}])}})()},[null==z?void 0:z.time,T]),(0,t.useEffect)(()=>{(async()=>{if(J("service_type.input_search")){let{data:e}=await u.Z.getInputServices();Y(e)}})()},[J]),(0,t.useEffect)(()=>{var e;(null==K?void 0:K.length)&&(null==m?void 0:null===(e=m.service_types)||void 0===e?void 0:e.length)&&(p(m.service_types.map(e=>K.find(l=>l.id===e.id)).filter(Boolean)),ei("service_types",m.service_types.map(e=>({id:e.id}))))},[K,null==m?void 0:m.service_types,ei]),(0,t.useEffect)(()=>{(async()=>{if(G){let{data:l}=await u.Z.getHours((0,v.p6)(G));if(L(l),null==m?void 0:m.id){var e;O(null==l?void 0:l.find(e=>{var l;return e.time===(null==m?void 0:null===(l=m.real_reservation_date)||void 0===l?void 0:l.split(" ")[1].slice(0,-3))})),ei("hour",null==m?void 0:null===(e=m.real_reservation_date)||void 0===e?void 0:e.split(" ")[1].slice(0,-3))}}})()},[G,null==m?void 0:m.id,null==m?void 0:m.real_reservation_date,ei]);let ed=(0,t.useCallback)(e=>{let l=e.value;p(l),ei("service_types",null==l?void 0:l.map(e=>({id:e.id})))},[ei]),eo=void 0===et().status||2===et().status;return(0,i.jsx)(_.V,{visible:s,modal:!0,onHide:en,header:"Rezerv",style:{maxWidth:"500px",width:"100%"},children:(0,i.jsxs)("form",{onSubmit:el(er),className:"dialog-form",children:[(0,i.jsx)(f.Wi,{label:"M\xfcştəri adı:",htmlFor:"client_name",error:null===(a=ea.client_name)||void 0===a?void 0:a.message,children:(0,i.jsx)(S.Qr,{name:"client_name",control:ee,render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"client_name",invalid:!!ea.client_name,...l})}})}),(0,i.jsx)(f.Wi,{label:"Telefon:",htmlFor:"client_phone",children:(0,i.jsx)(S.Qr,{name:"client_phone",control:ee,render:e=>{let{field:l}=e;return(0,i.jsx)(W.v,{id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!ea.client_phone,...l})}})}),(0,i.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,i.jsx)("label",{children:"Həkim:"}),(0,i.jsxs)("div",{className:"flex align-center gap-2",children:[(0,i.jsx)("label",{children:"N\xf6vbədən kənar:"}),(0,i.jsx)(S.Qr,{name:"is_out_of_turn",control:ee,render:()=>(0,i.jsx)(b.X,{checked:T,onChange:e=>{D(e=>!e),ei("is_out_of_turn",e.target.checked)}})})]})]}),(0,i.jsx)(S.Qr,{name:"doctor_id",control:ee,render:()=>(0,i.jsx)(C.L,{disabled:!z&&((null==M?void 0:M.id)===2||void 0===(null==M?void 0:M.id)),filter:!0,className:"mb-3",value:Z,onChange:e=>{E(e.value),ei("doctor_id",e.value.id)},optionLabel:"full_name",options:B,placeholder:"Doktor se\xe7in",invalid:!!ea.doctor_id})}),J("service.variable.service_type_id")&&(0,i.jsx)(f.Wi,{label:"Xidmət:",htmlFor:"service_types",children:(0,i.jsx)(S.Qr,{name:"service_types",control:ee,render:()=>(0,i.jsx)(H.N,{filter:!0,value:x,onChange:ed,options:K,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full",invalid:!!ea.service_types})})}),eo&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{className:"mb-2",children:"Tarix və saat:"}),(0,i.jsxs)("div",{className:"flex align-center gap-2 mb-3",children:[(0,i.jsx)(S.Qr,{name:"reservation_date",control:ee,render:()=>(0,i.jsx)(A.f,{dateFormat:"dd-mm-yy",invalid:!!ea.reservation_date,minDate:new Date,readOnlyInput:!0,value:G,onChange:e=>{U(e.value),ei("reservation_date",e.value)}})}),(0,i.jsx)(S.Qr,{name:"hour",control:ee,rules:{required:!0},render:()=>(0,i.jsx)(C.L,{disabled:!G,value:z,onChange:e=>{O(e.value),ei("hour",e.value.time)},optionLabel:"time",options:X,optionDisabled:e=>!e.active,placeholder:"Saat se\xe7in",invalid:!z})}),(null==z?void 0:z.remaining_space)&&(0,i.jsx)(k.v,{severity:"info",content:(0,i.jsxs)("span",{style:{color:"white"},children:["Yer: ",z.remaining_space]})})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Depozit:"}),(0,i.jsx)(S.Qr,{name:"advance_amount",control:ee,render:e=>{let{field:l}=e;return(0,i.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onClick:()=>w(!0),onValueChange:e=>l.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",className:"mt-2 mb-3 w-full",invalid:!y})}})]}),(null==m?void 0:m.id)&&(0,i.jsx)("div",{className:"flex mb-3 flex-wrap gap-2",children:null===j.Yr||void 0===j.Yr?void 0:j.Yr.map(e=>(0,i.jsxs)("div",{className:"flex align-center",children:[(0,i.jsx)(Q.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{I(e.value),ei("status",e.value.id)},checked:(null==M?void 0:M.id)===(null==e?void 0:e.id)}),(0,i.jsx)("label",{htmlFor:null==e?void 0:e.name,className:"ml-2",children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,i.jsx)("div",{className:"dialog-footer",children:(0,i.jsx)(r.z,{label:"Saxla",disabled:V||!y,type:"submit"})})]})})},J=e=>{let{visible:l,onHide:a,booking:s,onSuccess:n,getBookings:r}=e,d=(0,t.useCallback)(async()=>{if(null==s?void 0:s.id)try{await u.Z.deleteBooking(s.id),a(),r(),n("Rezerv uğurla silindi")}catch(e){console.error("Failed to delete booking:",e)}},[null==s?void 0:s.id,a,r,n]);return(0,i.jsx)(f.QH,{visible:l,onHide:a,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==s?void 0:s.client_name,'" rezervini silmək istədiyinizə əminsiniz?')})},$=e=>{let{userPermissions:l}=e,[a,s]=(0,t.useState)([]),[n,d]=(0,t.useState)(null),[o,m]=(0,t.useState)(),[p,b]=(0,t.useState)(!1),[y,w]=(0,t.useState)(!1),[k,S]=(0,t.useState)(!1),[N,F]=(0,t.useState)(!1),[Z,E,D]=(0,T.Nr)("",400),[z,O,M]=(0,T.Nr)(null,400),[H,W]=(0,t.useState)(),[Q,q]=(0,t.useState)([new Date,new Date]),[X,L]=(0,t.useState)(!1),[V,P]=(0,t.useState)(),K=(0,t.useRef)(null),Y=(0,t.useRef)(null),G=(0,t.useCallback)(e=>l.includes(e),[l]),$=(0,t.useCallback)(e=>{var l;null===(l=K.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),ee=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];L(!0);try{let{data:e}=await u.Z.getBookings({status:null==n?void 0:n.id,from_date:(0,v.p6)(Q[0]),to_date:(0,v.p6)(Q[1]),client_name:E,client_phone:O});s(e)}catch(e){console.error("Failed to fetch bookings:",e)}finally{if(L(!1),e){var l;null===(l=Y.current)||void 0===l||l.scrollIntoView({behavior:"smooth"})}}},[null==n?void 0:n.id,Q,E,O]);(0,t.useEffect)(()=>{Q[1]&&ee()},[null==n?void 0:n.name,Q,E,O,null==H?void 0:H.length]);let el=(0,t.useCallback)(e=>{m(e),b(!0)},[]),ea=(0,t.useCallback)(e=>{m(e),S(!0)},[]),ei=(0,t.useCallback)((e,l)=>X?(0,i.jsx)(B.O,{width:"20px"}):(0,i.jsx)("div",{children:n?l.rowIndex+1:a.length-l.rowIndex}),[X,n,a.length]),et=(0,t.useCallback)(e=>X?(0,i.jsx)(B.O,{width:"100px"}):e.reservation_date.slice(0,-3),[X]),es=(0,t.useCallback)(e=>X?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.client_name}),[X]),en=(0,t.useCallback)(e=>X?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:(0,v.CN)(e.client_phone)}),[X]),er=(0,t.useCallback)(e=>{var l;return X?(0,i.jsx)(B.O,{width:"150px"}):(null===(l=e.doctor)||void 0===l?void 0:l.name)&&"".concat(e.doctor.name," ").concat(e.doctor.surname)},[X]),ed=(0,t.useCallback)(e=>X?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.service_types.map(e=>(0,i.jsx)("div",{children:e.name},e.id))}),[X]),eo=(0,t.useCallback)(e=>X?(0,i.jsx)(B.O,{width:"100px"}):(0,v.T4)(e.advance_amount),[X]),ec=(0,t.useCallback)(e=>{switch(e){case"Ləğv":return"danger";case"Gəldi":return"warning";case"Qəbul edildi":return"success";case"G\xf6zlənilir":case"Online":return"info";default:return}},[]),eu=(0,t.useCallback)(e=>{var l;let a=null===(l=j.Yr.find(l=>(null==l?void 0:l.id)===e.status))||void 0===l?void 0:l.name;return X?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)(I.V,{value:a,severity:ec(a)})},[X,ec]),ev=(0,t.useCallback)(e=>X?(0,i.jsx)(B.O,{width:"60px"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>el(e)}),G("reservation.delete")&&(0,i.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>ea(e)})]}),[X,G,el,ea]),em=(0,t.useCallback)(()=>G("reservation.filter.status")?(0,i.jsx)(C.L,{value:n,options:[...j.Yr],onChange:e=>d(e.value),itemTemplate:e=>(0,i.jsx)(I.V,{value:e.name,severity:ec(e.name)}),placeholder:"Status",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"}):null,[G,n,ec]),eh=(0,t.useCallback)(()=>G("reservation.filter.date")?(0,i.jsx)(A.f,{minDate:G("reservation.get_past_data")?void 0:new Date,value:Q,onChange:e=>q(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[G,Q]),ex=(0,t.useCallback)(()=>G("reservation.filter.client_name")?(0,i.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:Z,onChange:e=>D(e.target.value)}):null,[G,Z,D]),ep=(0,t.useCallback)(()=>G("reservation.filter.client_phone")?(0,i.jsx)(R.R,{className:"input-phone-filter",id:"client_phone",placeholder:"+994 99 999-99-99",value:z,onChange:e=>M(e.value),prefix:"+",useGrouping:!1}):null,[G,z,M]),eb=(0,t.useMemo)(()=>(0,i.jsx)(f.xD,{onFilterToggle:(0,v.Bv)(l)?()=>F(e=>!e):void 0,onRefresh:()=>ee(),rightContent:(0,i.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>b(!0)})}),[l,ee]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:a,dataKey:"id",header:eb,tableStyle:{minWidth:"50rem"},className:"table-container",filterDisplay:N?"row":void 0,paginator:!0,rows:10,children:[(0,i.jsx)(h.s,{body:ei,header:"#",style:{width:"2%"}}),(0,i.jsx)(h.s,{dataType:"date",header:"Tarix",body:et,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:eh}),(0,i.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:ex,showFilterMenu:!1,body:es}),(0,i.jsx)(h.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:ep,showFilterMenu:!1,body:en}),(0,i.jsx)(h.s,{header:"Status",body:eu,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:em}),(0,i.jsx)(h.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,body:ed}),(0,i.jsx)(h.s,{header:"Həkim",body:er,style:{width:"10%"},showFilterMenu:!1}),(0,i.jsx)(h.s,{header:"Depozit",body:eo,style:{width:"10%"}}),G("reservation.update")&&(0,i.jsx)(h.s,{body:ev,exportable:!1,style:{width:"10%"}})]})}),(0,i.jsx)(c.F,{ref:K}),(0,i.jsx)(U,{userPermissions:l,visible:p,onHide:()=>{b(!1),m(void 0)},onSuccess:$,booking:o,setBooking:m,getBookings:ee}),(0,i.jsx)(_.V,{header:"Reject comment",visible:y,style:{width:"50vw"},onHide:()=>{w(!1),P("")},children:(0,i.jsx)("p",{className:"m-0",children:V})}),(0,i.jsx)(J,{booking:o,visible:k,onHide:()=>S(!1),onSuccess:$,getBookings:ee})]})},ee=a(4427),el=e=>{let{userPermissions:l}=e,[a,s]=(0,t.useState)(),[n,d]=(0,t.useState)(),[o,c]=(0,t.useState)(!1),[m,b]=(0,t.useState)(!1),[j,y]=(0,t.useState)([new Date,new Date]),[g,w]=(0,t.useState)(0),[C,k]=(0,t.useState)(0),S=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;c(!0);try{let{data:l,meta:a}=await u.Z.getLogs({from_date:(0,v.p6)(j[0]),to_date:(0,v.p6)(j[1]),page:e});s(l),w(null==a?void 0:a.total)}catch(e){console.error("Failed to fetch logs:",e)}finally{c(!1)}},[j]);(0,t.useEffect)(()=>{j[1]&&S()},[S]);let N=(0,t.useCallback)(e=>{k(e.first),S(e.page+1)},[S]),F=(0,t.useCallback)(e=>{d(e),b(!0)},[]),Z=(0,t.useCallback)((e,l)=>o?(0,i.jsx)(B.O,{width:"20px"}):(0,i.jsx)("div",{children:g-l.rowIndex-C}),[o,g,C]),E=(0,t.useCallback)(e=>o?(0,i.jsx)(B.O,{width:"100px"}):e.service.created_at.slice(0,-3),[o]),R=(0,t.useCallback)(e=>o?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.service.client_name}),[o]),T=(0,t.useCallback)(e=>{var l,a,t,s;return o?(0,i.jsx)(B.O,{width:"150px"}):"".concat(null===(a=e.service)||void 0===a?void 0:null===(l=a.user)||void 0===l?void 0:l.name," ").concat(null===(s=e.service)||void 0===s?void 0:null===(t=s.user)||void 0===t?void 0:t.surname)},[o]),D=(0,t.useCallback)(e=>{var l,a,t;return o?(0,i.jsx)(B.O,{width:"150px"}):"".concat(null===(l=e.price_difference.causer)||void 0===l?void 0:l.name," ").concat(null===(t=e.price_difference)||void 0===t?void 0:null===(a=t.causer)||void 0===a?void 0:a.surname)},[o]),z=(0,t.useCallback)(e=>o?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.service.service_types.map(e=>(0,i.jsx)("div",{children:e.name},e.id))}),[o]),O=(0,t.useCallback)(e=>{var l;return o?(0,i.jsx)(B.O,{width:"100px"}):(0,v.T4)(null===(l=e.price_difference)||void 0===l?void 0:l.service_types_price_sum)},[o]),M=(0,t.useCallback)(e=>{var l;return o?(0,i.jsx)(B.O,{width:"100px"}):(0,v.T4)(null===(l=e.price_difference)||void 0===l?void 0:l.service_price_sum)},[o]),I=(0,t.useCallback)(e=>{var l;return o?(0,i.jsx)(B.O,{width:"100px"}):(0,v.T4)(null===(l=e.service)||void 0===l?void 0:l.advance_amount)},[o]),H=(0,t.useCallback)(e=>o?(0,i.jsx)(B.O,{width:"60px"}):(0,i.jsx)(r.z,{icon:"pi pi-question",rounded:!0,text:!0,severity:"secondary",onClick:()=>F(e)}),[o,F]),W=(0,t.useMemo)(()=>(0,i.jsx)(f.xD,{leftContent:(0,i.jsx)(A.f,{value:j,onChange:e=>y(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"})}),[j]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:a,dataKey:"id",tableStyle:{minWidth:"50rem"},className:"table-container",header:W,children:[(0,i.jsx)(h.s,{body:Z,header:"#",style:{width:"2%"}}),(0,i.jsx)(h.s,{dataType:"date",header:"Tarix",body:E,style:{width:"10%"}}),(0,i.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",body:R,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Xidmət",body:z,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Doktor",body:T,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Səbəbkar",body:D,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Faktiki məbləğ",body:O,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Alınan məbləğ",body:M,style:{width:"10%"}}),(0,i.jsx)(h.s,{header:"Depozit",body:I,style:{width:"10%"}}),(0,i.jsx)(h.s,{body:H,exportable:!1,style:{width:"10%"}})]})}),(0,i.jsx)(p.D,{first:C,rows:10,totalRecords:g,onPageChange:N}),(0,i.jsx)(_.V,{header:"Activity logs",visible:m,style:{width:"50vw"},onHide:()=>b(!1),children:(0,i.jsx)("div",{className:"m-0",children:(0,i.jsx)(ee.L,{data:null==n?void 0:n.activity_logs})})})]})},ea=e=>{let{userPermissions:l}=e,[a,s]=(0,t.useState)([]),[n,r]=(0,t.useState)(0),[d,o]=(0,t.useState)(0),[m]=(0,t.useState)(10),[b,j]=(0,t.useState)(1),[y,_]=(0,t.useState)(!1),[g,w]=(0,t.useState)([(0,v.Ur)(10),new Date]),C=(0,t.useRef)(null),k=(0,t.useCallback)(e=>l.includes(e),[l]),S=(0,t.useCallback)(async e=>{try{let{data:l,meta:a}=await u.Z.getAdvances({page:e,size:m,from_date:(0,v.p6)(g[0]),to_date:(0,v.p6)(g[1])});s(l),o(null==a?void 0:a.total)}catch(e){console.error("Failed to fetch advance transfers:",e)}},[m,g]);(0,t.useEffect)(()=>{g[1]&&S(b)},[S,g,b]);let N=(0,t.useCallback)(e=>{S(e.page+1),j(e.page+1),r(e.first)},[S]),F=(0,t.useCallback)(e=>(0,i.jsx)("div",{children:(null==e?void 0:e.user)?"".concat(e.user.name," ").concat(e.user.surname):"sistem"}),[]),Z=(0,t.useCallback)(e=>{var l,a;return(0,i.jsx)("div",{children:(0,v.O2)(null==e?void 0:null===(a=e.user)||void 0===a?void 0:null===(l=a.role)||void 0===l?void 0:l.id)})},[]),E=(0,t.useCallback)(()=>k("service.filter.date")?(0,i.jsx)(A.f,{value:g,onChange:e=>w(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[k,g]),R=(0,t.useMemo)(()=>(0,i.jsx)(f.xD,{onFilterToggle:(0,v.Bv)(l)?()=>_(e=>!e):void 0}),[l]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:a,editMode:"row",dataKey:"id",tableStyle:{minWidth:"50rem"},className:"table-container",header:R,filterDisplay:y?"row":void 0,children:[(0,i.jsx)(h.s,{field:"transferred_at",header:"Tarix və saat",style:{width:"20%"},filter:!0,filterElement:E}),(0,i.jsx)(h.s,{field:"user",header:"Bağlayan şəxs",body:F,style:{width:"20%"}}),(0,i.jsx)(h.s,{field:"role",body:Z,header:"Rol",style:{width:"20%"}})]})}),(0,i.jsx)(p.D,{first:n,rows:m,totalRecords:d,onPageChange:N}),(0,i.jsx)(c.F,{ref:C})]})},ei=e=>{let{userPermissions:l}=e,[a,s]=(0,t.useState)([]),[n,r]=(0,t.useState)(!1),[d,o]=(0,t.useState)(!1),[m,p]=(0,t.useState)(),[b,j]=(0,t.useState)([new Date,new Date]),[y,_]=(0,t.useState)(),[w,S,N]=(0,T.Nr)("",400),[F,Z,E]=(0,T.Nr)(null,400),[D,z]=(0,t.useState)(),[O,M]=(0,t.useState)(),I=(0,t.useRef)(null),H=(0,t.useCallback)(e=>l.includes(e),[l]),W=(0,t.useCallback)(async()=>{o(!0);try{let{data:e}=await u.Z.getReports({from_date:(0,v.p6)(b[0]),to_date:(0,v.p6)(b[1]),client_name:S,client_phone:Z,user_id:null==O?void 0:O.id});if(s(e),H("service.advance.info")){let e=await u.Z.getTotalAmount({from_date:(0,v.p6)(b[0]),to_date:(0,v.p6)(b[1]),client_name:S,client_phone:Z,user_id:null==O?void 0:O.id});p(e)}}catch(e){console.error("Failed to fetch reports:",e)}finally{o(!1)}},[b,S,Z,null==O?void 0:O.id,H]);(0,t.useEffect)(()=>{b[1]&&W()},[W]),(0,t.useEffect)(()=>{(async()=>{if(H("user.input_search")){let{data:e}=await u.Z.getDoctors();z(e)}})()},[H]);let Q=(0,t.useCallback)((e,l)=>d?(0,i.jsx)(B.O,{width:"20px"}):(0,i.jsx)("div",{children:l.rowIndex+1}),[d]),q=(0,t.useCallback)(e=>d?(0,i.jsx)(B.O,{width:"100px"}):e.date_time.slice(0,-3),[d]),X=(0,t.useCallback)(e=>d?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.client_name}),[d]),L=(0,t.useCallback)(e=>d?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:(0,v.CN)(e.client_phone)}),[d]),V=(0,t.useCallback)(e=>{var l,a;return d?(0,i.jsx)(B.O,{width:"150px"}):"".concat(null===(l=e.user)||void 0===l?void 0:l.name," ").concat(null===(a=e.user)||void 0===a?void 0:a.surname)},[d]),P=(0,t.useCallback)(e=>d?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:"service"===e.service_type?"xidmət":"depozit"}),[d]),K=(0,t.useCallback)(e=>d?(0,i.jsx)(B.O,{width:"100px"}):(0,v.T4)(e.amount),[d]),Y=(0,t.useCallback)(()=>H("service.filter.date")?(0,i.jsx)(A.f,{value:b,onChange:e=>j(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[H,b]),G=(0,t.useCallback)(()=>H("service.filter.client_name")?(0,i.jsx)(g.o,{placeholder:"Ad ilə axtarış",className:"filter-input",value:w,onChange:e=>N(e.target.value)}):null,[H,w,N]),U=(0,t.useCallback)(()=>H("service.filter.client_phone")?(0,i.jsx)(R.R,{className:"input-phone-filter",id:"client_phone",placeholder:"+994 99 999-99-99",value:F,onChange:e=>E(e.value),prefix:"+",useGrouping:!1}):null,[H,F,E]),J=(0,t.useCallback)(()=>H("service.filter.doctor")?(0,i.jsx)(C.L,{filter:!0,value:O,onChange:e=>M(e.value),options:D,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0}):null,[H,O,D]),$=(0,t.useCallback)(e=>{var l,a;return(null!==(a=null===(l=e.amount_change_history)||void 0===l?void 0:l.length)&&void 0!==a?a:0)>1},[]),ee=(0,t.useCallback)(e=>d?(0,i.jsx)(B.O,{width:"100px"}):e.created_at.slice(0,-3),[d]),el=(0,t.useCallback)(e=>{var l,a;return d?(0,i.jsx)(B.O,{width:"150px"}):"".concat(null===(l=e.causer)||void 0===l?void 0:l.name," ").concat(null===(a=e.causer)||void 0===a?void 0:a.surname)},[d]),ea=(0,t.useCallback)(e=>(0,i.jsx)("div",{className:"p-3",children:(0,i.jsxs)(x.w,{value:e.amount_change_history,children:[(0,i.jsx)(h.s,{field:"date",header:"Tarix",body:ee}),(0,i.jsx)(h.s,{field:"amount",header:"Məbləğ",body:K}),(0,i.jsx)(h.s,{field:"status",header:"Qəbul edən",body:el})]})}),[ee,K,el]),ei=(0,t.useMemo)(()=>(0,i.jsxs)("div",{className:"total-info-content",children:[(0,i.jsxs)("div",{className:"ml-2",children:["Depozit: ",null==m?void 0:m.advance," AZN"]}),(0,i.jsxs)("div",{className:"ml-2",children:["Xidmətlər: ",null==m?void 0:m.amount," AZN"]}),(0,i.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==m?void 0:m.total," AZN"]})]}),[m]),et=(0,t.useMemo)(()=>(0,i.jsx)(f.xD,{onFilterToggle:(0,v.Bv)(l)?()=>r(e=>!e):void 0,onRefresh:W}),[l,W]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:a,dataKey:"id",header:et,tableStyle:{minWidth:"50rem"},className:"table-container",filterDisplay:n?"row":void 0,paginator:!0,rows:10,expandedRows:y,onRowToggle:e=>_(e.data),rowExpansionTemplate:ea,children:[(0,i.jsx)(h.s,{expander:$,style:{width:"2%"}}),(0,i.jsx)(h.s,{body:Q,header:"#",style:{width:"2%"}}),(0,i.jsx)(h.s,{dataType:"date",header:"Tarix",body:q,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:Y}),(0,i.jsx)(h.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:G,showFilterMenu:!1,body:X}),H("service.variable.select_phone")&&(0,i.jsx)(h.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:U,showFilterMenu:!1,body:L}),(0,i.jsx)(h.s,{header:"Mənbə",style:{width:"10%"},showFilterMenu:!1,body:P}),(0,i.jsx)(h.s,{header:"Qəbul edən",body:V,style:{width:"10%"},filter:H("service.variable.user_id"),filterElement:J,showFilterMenu:!1}),(0,i.jsx)(h.s,{header:"Məbləğ",body:K,style:{width:"10%"}})]})}),H("service.get_all.total_amount")&&(0,i.jsx)("div",{className:"total-info",children:(0,i.jsx)(k.v,{className:"info-message",severity:"info",content:ei})}),(0,i.jsx)(c.F,{ref:I})]})},et=e=>{let{expense:l,visible:a,onHide:s,onSuccess:n,getExpenses:d}=e,{control:o,setValue:c,handleSubmit:v,formState:{errors:m},reset:h}=(0,S.cI)(),x=(0,t.useCallback)(()=>{s(),h()},[s,h]),p=(0,t.useCallback)(async e=>{let{name:a,amount:i=0,description:t}=e;try{(null==l?void 0:l.id)?await u.Z.updateExpense({name:a,amount:i,description:t,id:l.id}):await u.Z.createExpense({name:a,amount:i,description:t}),d(1),n("Xərc ".concat((null==l?void 0:l.id)?"yeniləndi":"əlavə olundu")),x()}catch(e){console.error("Failed to save expense:",e)}},[null==l?void 0:l.id,d,n,x]);return(0,t.useEffect)(()=>{(null==l?void 0:l.id)&&(c("name",l.name),c("amount",l.amount),c("description",l.description))},[l,c]),(0,i.jsx)(_.V,{visible:a,style:{width:"25rem"},header:"Xərc",modal:!0,onHide:x,children:(0,i.jsxs)("form",{onSubmit:v(p),className:"dialog-form",children:[(0,i.jsx)(f.Wi,{label:"Ad:",htmlFor:"name",children:(0,i.jsx)(S.Qr,{name:"name",control:o,rules:{required:!0},render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"name",invalid:!!(null==m?void 0:m.name),...l})}})}),(0,i.jsx)(f.Wi,{label:"İzah:",htmlFor:"description",children:(0,i.jsx)(S.Qr,{name:"description",control:o,rules:{required:!0},render:e=>{let{field:l}=e;return(0,i.jsx)(g.o,{id:"description",invalid:!!(null==m?void 0:m.description),...l})}})}),(0,i.jsx)(f.Wi,{label:"Qiymət:",htmlFor:"amount",children:(0,i.jsx)(S.Qr,{name:"amount",control:o,render:e=>{let{field:l}=e;return(0,i.jsx)(R.R,{onBlur:l.onBlur,ref:l.ref,value:(null==l?void 0:l.value)||0,onValueChange:e=>l.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",invalid:!!m.amount})}})}),(0,i.jsx)("div",{className:"dialog-footer",children:(0,i.jsx)(r.z,{label:"Saxla",type:"submit"})})]})})},es=e=>{let{expense:l,visible:a,onHide:s,setExpenses:n,onSuccess:r}=e,d=(0,t.useCallback)(async()=>{if(null==l?void 0:l.id)try{await u.Z.deleteExpense(l.id),n(e=>e.filter(e=>e.id!==l.id)),s(),r("Xərc uğurla silindi")}catch(e){console.error("Failed to delete expense:",e)}},[null==l?void 0:l.id,n,s,r]);return(0,i.jsx)(f.QH,{visible:a,onHide:s,onConfirm:d,header:"Silmə təsdiqi",message:'"'.concat(null==l?void 0:l.name,'" xərcini silmək istədiyinizə əminsiniz?')})},en=e=>{let{userPermissions:l}=e,[a,s]=(0,t.useState)(),[n,d]=(0,t.useState)([]),[o,m]=(0,t.useState)(0),[b]=(0,t.useState)(10),[j,y]=(0,t.useState)(0),[_,g]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),[S,N]=(0,t.useState)("0"),[F,Z]=(0,t.useState)([new Date,new Date]),[E,R]=(0,t.useState)(!1),[T,D]=(0,t.useState)(!1),z=(0,t.useRef)(null),O=(0,t.useCallback)(e=>l.includes(e),[l]),M=(0,t.useCallback)(e=>{var l;null===(l=z.current)||void 0===l||l.show({severity:"success",summary:"Success",detail:e,life:3e3})},[]),I=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;C(!0);try{let{data:l,meta:a}=await u.Z.getExpenses({page:e,size:b,from_date:(0,v.p6)(F[0]),to_date:(0,v.p6)(F[1])}),{amount:i}=await u.Z.getExpensesTotal({from_date:(0,v.p6)(F[0]),to_date:(0,v.p6)(F[1])});N(i),d(l),m(null==a?void 0:a.total)}catch(e){console.error("Failed to fetch expenses:",e)}finally{C(!1)}},[b,F]);(0,t.useEffect)(()=>{F[1]&&I()},[I]);let H=(0,t.useCallback)(e=>{I(e.page+1),y(e.first)},[I]),W=(0,t.useCallback)(e=>{s(e),R(!0)},[]),Q=(0,t.useCallback)(e=>{s(e),D(!0)},[]),q=(0,t.useCallback)(e=>{var l;return w?(0,i.jsx)(B.O,{width:"100px"}):null===(l=e.created_at)||void 0===l?void 0:l.slice(0,-3)},[w]),X=(0,t.useCallback)(e=>w?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.name}),[w]),L=(0,t.useCallback)(e=>w?(0,i.jsx)(B.O,{width:"100px"}):(0,i.jsx)("div",{children:e.description}),[w]),V=(0,t.useCallback)(e=>(0,v.T4)(e.amount),[]),P=(0,t.useCallback)(e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",className:"btn-icon-right",onClick:()=>W(e)}),(0,i.jsx)(r.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>Q(e)})]}),[W,Q]),K=(0,t.useCallback)(()=>O("service.filter.date")?(0,i.jsx)(A.f,{value:F,onChange:e=>Z(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,className:"filter-calendar",dateFormat:"dd/mm/yy"}):null,[O,F]),Y=(0,t.useMemo)(()=>O("expense.create")?(0,i.jsx)(f.xD,{onFilterToggle:()=>g(e=>!e),onRefresh:()=>I(),leftContent:(0,i.jsx)(k.v,{className:"info-message",severity:"info",content:(0,i.jsxs)("div",{children:[S," AZN"]})}),rightContent:(0,i.jsx)(r.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>R(!0)})}):null,[O,I,S]);return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)(x.w,{value:n,dataKey:"id",tableStyle:{minWidth:"50rem"},header:Y,className:"table-container",filterDisplay:_?"row":void 0,children:[(0,i.jsx)(h.s,{dataType:"date",header:"Tarix",body:q,style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:K}),(0,i.jsx)(h.s,{header:"Ad",body:X,style:{width:"10%"},showFilterMenu:!1}),(0,i.jsx)(h.s,{header:"Izah",body:L,style:{width:"10%"},showFilterMenu:!1}),(0,i.jsx)(h.s,{field:"price",header:"Məbləğ",body:V,style:{width:"10%"}}),O("expense.delete")&&(0,i.jsx)(h.s,{body:P,exportable:!1,style:{width:"10%"}})]})}),(0,i.jsx)(p.D,{first:j,rows:b,totalRecords:o,onPageChange:H}),(0,i.jsx)(c.F,{ref:z}),(0,i.jsx)(et,{expense:a,visible:E,onHide:()=>{R(!1),s(void 0)},onSuccess:M,getExpenses:I}),(0,i.jsx)(es,{expense:a,visible:T,onHide:()=>D(!1),setExpenses:d,onSuccess:M})]})};let er={TOKEN:"token",ACTIVE_TAB:"activeTabIndex"};var ed=function(){var e,l;let[a,h]=(0,t.useState)(),[x,p]=(0,t.useState)(()=>{{let e=localStorage.getItem(er.ACTIVE_TAB);return e?parseInt(e,10):0}}),b=(0,o.useRouter)(),j=(0,t.useRef)(null),f=(0,t.useMemo)(()=>{var e;return null!==(e=null==a?void 0:a.role.permissions.map(e=>null==e?void 0:e.name))&&void 0!==e?e:[]},[null==a?void 0:a.role.permissions]),y=(0,t.useCallback)(()=>{localStorage.clear(),b.push("/login")},[b]),_=(0,t.useCallback)(e=>{p(e),localStorage.setItem(er.ACTIVE_TAB,e.toString())},[]);(0,t.useEffect)(()=>{localStorage.getItem(er.TOKEN)||b.push("/login")},[b]),(0,t.useEffect)(()=>{(async()=>{try{var e;let{data:l}=await u.Z.getSelfInfo();(null==l?void 0:null===(e=l.role)||void 0===e?void 0:e.id)!==5||localStorage.getItem(er.ACTIVE_TAB)||(p(1),localStorage.setItem(er.ACTIVE_TAB,"1")),h(l)}catch(e){console.error("Failed to fetch user data:",e)}})()},[]),(0,t.useEffect)(()=>{j.current&&(0,m.x)(j.current)},[]);let g=(0,t.useCallback)(e=>f.includes(e),[f]);return(null==a?void 0:a.name)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("header",{className:"app-header",children:[(0,i.jsxs)("div",{className:"app-header-info",children:[(0,i.jsx)(n.q,{shape:"circle",label:null===(e=a.name[0])||void 0===e?void 0:e.toUpperCase(),className:"avatar-primary"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:"".concat(a.name," ").concat(a.surname)}),(0,i.jsx)("small",{children:(0,v.O2)(null===(l=a.role)||void 0===l?void 0:l.id)})]})]}),(0,i.jsx)(r.z,{icon:"pi pi-sign-out",severity:"info","aria-label":"Выход",onClick:y})]}),(0,i.jsx)(s.i,{}),(0,i.jsx)("main",{className:"app-main",children:(0,i.jsxs)(d.f,{activeIndex:x,onTabChange:e=>_(e.index),children:[g("service.get_all")&&(0,i.jsx)(d.x,{header:"Xidmətlər",children:(0,i.jsx)(V,{userPermissions:f,role:a.role})}),g("reservation.get_all")&&(0,i.jsx)(d.x,{header:"Rezervlər",children:(0,i.jsx)($,{userPermissions:f})}),g("report.get_all")&&(0,i.jsx)(d.x,{header:"Kassa",children:(0,i.jsx)(ei,{userPermissions:f,role:a.role})}),g("reservation_time.get_all")&&(0,i.jsx)(d.x,{header:"Rezerv saatları",children:(0,i.jsx)(G,{userPermissions:f})}),g("expense.get_all")&&(0,i.jsx)(d.x,{header:"Xərclər",children:(0,i.jsx)(en,{userPermissions:f})}),g("advance_transfer.get_all")&&(0,i.jsx)(d.x,{header:"N\xf6vbələr",children:(0,i.jsx)(ea,{userPermissions:f})}),g("service_type.get_all")&&(0,i.jsx)(d.x,{header:"Xidmət n\xf6vləri",children:(0,i.jsx)(M,{userPermissions:f})}),g("user.get_all")&&(0,i.jsx)(d.x,{header:"İstifadə\xe7ilər",children:(0,i.jsx)(E,{userPermissions:f})}),g("service.bonus_reports")&&(0,i.jsx)(d.x,{header:"Bonuslar",children:(0,i.jsx)(P,{})}),g("action_log.get_all")&&(0,i.jsx)(d.x,{header:"Loglar",children:(0,i.jsx)(el,{userPermissions:f})})]})}),(0,i.jsx)(c.F,{ref:j})]}):null}}},function(e){e.O(0,[651,754,580,83,39,971,23,744],function(){return e(e.s=1542)}),_N_E=e.O()}]);