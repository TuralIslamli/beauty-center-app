(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1542:function(e,t,i){Promise.resolve().then(i.bind(i,8895))},2959:function(e,t,i){"use strict";var l=i(1398);t.Z={postLogin:e=>l.W.post("login",e),getSelfInfo:()=>l.W.get("users/self-info"),getServiceTypes:e=>{let{page:t,size:i}=e;return l.W.get("service-types?page=".concat(t,"&size=").concat(i))},getBookingTimes:e=>{let{page:t,size:i}=e;return l.W.get("reservation-times?page=".concat(t,"&size=").concat(i))},createBookingTime:e=>{let{time:t,reservation_count:i}=e;return l.W.post("reservation-times",{time:t,reservation_count:i})},updateBookingTime:e=>{let{id:t,time:i,reservation_count:n}=e;return l.W.put("reservation-times/".concat(t),{time:i,reservation_count:n})},deleteBookingTime:e=>l.W.delete("reservation-times/".concat(e)),deleteUser:e=>l.W.delete("users/".concat(e)),createUser:e=>l.W.post("users",e),updateUser:e=>{let{name:t,surname:i,email:n,roleId:r,password:s,password_repeat:a,id:o}=e;return l.W.put("users/".concat(o),{name:t,surname:i,email:n,role_id:r,password:s,password_repeat:a})},updateServiceType:e=>{let{id:t,name:i,price:n}=e;return l.W.put("service-types/".concat(t),{name:i,price:n})},createServiceType:e=>{let{name:t,price:i}=e;return l.W.post("service-types",{name:t,price:i})},deleteServiceType:e=>l.W.delete("service-types/".concat(e)),getUsers:e=>{let{page:t,size:i}=e;return l.W.get("users?page=".concat(t,"&size=").concat(i))},getBookings:e=>{let{page:t,size:i,status:n,from_date:r,to_date:s,client_name:a,client_phone:o,service_types:d,doctor_id:c}=e;return l.W.get("reservations?&sort=asc&sorted_column=date_time",{params:{status:n,from_date:r,to_date:s,client_name:a,client_phone:o,service_types:d,doctor_id:c}})},getServices:e=>{let{page:t,size:i,status:n,from_date:r,to_date:s,client_name:a,client_phone:o,service_types:d,user_id:c}=e;return l.W.get("services?page=".concat(t,"&size=").concat(i,"&sort=desc"),{params:{status:n,from_date:r,to_date:s,client_name:a,client_phone:o,service_types:d,user_id:c}})},deleteService:e=>l.W.delete("services/".concat(e)),deleteBooking:e=>l.W.delete("reservations/".concat(e)),getBookingDoctors:e=>l.W.get("reservations/users/input-search?date_time=".concat(e)),getTotalAmount:e=>{let{status:t,from_date:i,to_date:n,client_name:r,client_phone:s,service_types:a,user_id:o}=e;return l.W.get("services/total-amounts",{params:{status:t,from_date:i,to_date:n,client_name:r,client_phone:s,service_types:a,user_id:o}})},getDoctors:()=>l.W.get("users/input-search"),getHours:e=>l.W.get("reservation-times/input-search?date=".concat(e)),getInputServices:()=>l.W.get("service-types/input-search"),createService:e=>l.W.post("services",e),createBooking:e=>l.W.post("reservations",e),updateService:e=>l.W.put("services/".concat(e.id),e),updateBooking:e=>l.W.put("reservations/".concat(e.id),e),getDailyReportExcel:async e=>{try{await l.W.get("services/daily-report?excel_export=true&sorted_day=".concat(e),{responseType:"blob"}).then(t=>{{let i=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(i),n=document.createElement("a");n.href=l,n.setAttribute("download","daily_report_".concat(e,".xlsx")),document.body.appendChild(n),n.click(),document.body.removeChild(n)}})}catch(e){console.error("Error downloading the file",e)}},getAllReportsExcel:async e=>{let{status:t,from_date:i,to_date:n,client_name:r,client_phone:s,service_types:a,user_id:o}=e;try{await l.W.get("services/all-reports?excel_export=true&sort=desc",{responseType:"blob",params:{status:t,from_date:i,to_date:n,client_name:r,client_phone:s,service_types:a,user_id:o}}).then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(t),r=document.createElement("a");r.href=l,r.setAttribute("download","general_report_".concat(i,"/").concat(n,".xlsx")),document.body.appendChild(r),r.click(),document.body.removeChild(r)})}catch(e){console.error("Error downloading the file",e)}},getBonuses:e=>{let{from_date:t,to_date:i,user_id:n}=e;return l.W.get("services/bonus-reports",{params:{from_date:t,to_date:i,user_id:n}})},getBonusesExcel:async e=>{let{from_date:t,to_date:i,user_id:n}=e;try{await l.W.get("services/bonus-reports?excel_export=true",{responseType:"blob",params:{from_date:t,to_date:i,user_id:n}}).then(e=>{let l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.setAttribute("download","bonus_report_".concat(t,"/").concat(i,".xlsx")),document.body.appendChild(r),r.click(),document.body.removeChild(r)})}catch(e){console.error("Error downloading the file",e)}}}},8895:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return en}});var l=i(7437),n=i(2265),r=i(2102),s=i(2160),a=i(8708),o=i(5012),d=i(6463),c=i(2502),u=i(2959),m=i(8787),v=i(2193),p=i(5472),h=function(e){let{userDeleteDialog:t,setUserDeleteDialog:i,user:r,showSuccess:s,setUsers:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>i(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{o(e=>e.filter(e=>e.id!==(null==r?void 0:r.id)));try{u.Z.deleteUser(null==r?void 0:r.id),i(!1),s("Service type has been successfully deleted")}catch(e){console.error(e)}}})]});return(0,l.jsx)(p.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>i(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),r&&(0,l.jsxs)("span",{children:["Are you sure you want to delete"," ",(0,l.jsxs)("b",{children:[null==r?void 0:r.name," ",null==r?void 0:r.surname]}),"?"]})]})})},x=i(8861),y=i(9343),f=i(4245),j=i(7753),g=i(5313),w=i(6498),_=i(7039);let b=[{id:2,name:"Admin"},{id:3,name:"Cashier"},{id:4,name:"Doctor"},{id:5,name:"Reserver"}],S=[{id:0,name:"Cash"},{id:1,name:"Card"}],C=[{id:0,name:"New"},{id:1,name:"Accepted"},,{id:2,name:"Rejected"}],k=[{id:0,name:"Ləğv"},{id:1,name:"Gəldi"},,{id:2,name:"G\xf6zlənilir"}];var B=function(e){let{user:t,userEditDialog:i,setUserEditDialog:r,setUsers:s,showSuccess:o}=e,d=f.Ry().shape({name:f.Z_().required(),surname:f.Z_().required(),email:f.Z_().email("Invalid email").required(),roleId:f.Rx().required(),password:(null==t?void 0:t.id)?f.Z_():f.Z_().required(),password_repeat:f.Z_().oneOf([f.iH("password")],"Passwords must match")}),{control:c,handleSubmit:m,formState:{errors:v},setValue:h,reset:S}=(0,y.cI)({resolver:(0,j.X)(d),defaultValues:{name:void 0,surname:void 0,email:void 0,roleId:void 0,password:(null==t?void 0:t.id)?void 0:"",password_repeat:(null==t?void 0:t.id)?void 0:""}}),[C,k]=(0,n.useState)(void 0),B=async e=>{try{let{data:i}=(null==t?void 0:t.id)?await u.Z.updateUser({...e,id:t.id}):await u.Z.createUser(e);s(e=>[i,...e]),o("User has been successfully ".concat((null==t?void 0:t.id)?"created":"updated")),r(!1)}catch(e){console.error(e)}};return(0,n.useEffect)(()=>{if(null==t?void 0:t.id){var e;h("name",t.name),h("surname",t.surname),h("email",t.email),h("roleId",null===(e=t.role)||void 0===e?void 0:e.id),k(b.find(e=>{var i;return e.id===(null===(i=t.role)||void 0===i?void 0:i.id)}))}},[t,h]),(0,l.jsx)(p.V,{visible:i,style:{width:"328px"},header:"İstifadə\xe7i məlumatları",modal:!0,onHide:()=>{r(!1),S(),k(void 0)},children:t&&(0,l.jsxs)("form",{onSubmit:m(B),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,l.jsx)(y.Qr,{name:"name",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!v.name,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Soyad:"}),(0,l.jsx)(y.Qr,{name:"surname",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"surname",invalid:!!v.surname,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Email:"}),(0,l.jsx)(y.Qr,{name:"email",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"email",invalid:!!v.email,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Rol:"}),(0,l.jsx)(y.Qr,{name:"roleId",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{style:{marginBottom:"10px"},value:C,onChange:e=>{k(e.value),h("roleId",e.value.id)},options:b,optionLabel:"name",placeholder:"Rol se\xe7in",className:"w-full md:w-14rem",invalid:!!v.roleId})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"password",children:"Şifrə:"}),(0,l.jsx)(y.Qr,{name:"password",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(w.r,{style:{marginBottom:"10px",width:"200px"},id:"password",toggleMask:!0,feedback:!1,invalid:!!v.password,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"password_repeat",children:"Şifrənin təstiqi:"}),(0,l.jsx)(y.Qr,{name:"password_repeat",control:c,render:e=>{let{field:t}=e;return(0,l.jsx)(w.r,{style:{marginBottom:"10px",width:"200px"},toggleMask:!0,feedback:!1,id:"password_repeat",invalid:!!v.password_repeat,...t})}}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)("div",{children:v.password_repeat&&(0,l.jsx)(g.v,{style:{maxWidth:"180px",height:"45px"},severity:"error",text:"Şifrələr eyni deyil"})}),(0,l.jsx)(a.z,{label:"Save",type:"submit",style:{display:"flex"}})]})]})})},R=i(5565);let F=e=>{var t;return null===(t=b.find(t=>t.id===e))||void 0===t?void 0:t.name},Z=e=>{let t=null==e?void 0:e.getFullYear(),i=String((null==e?void 0:e.getMonth())+1).padStart(2,"0"),l=String(null==e?void 0:e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(i,"-").concat(l)},z=e=>{for(let t of["service.filter.status","service.filter.date","service.filter.client_name","service.filter.client_phone","service.filter.service_type","service.filter.doctor","reservation.filter.status","reservation.filter.date","reservation.filter.client_name","reservation.filter.client_phone","reservation.filter.service_type","reservation.filter.doctor"])if(e.includes(t))return!0;return!1};var D=function(e){let{userPermissions:t}=e,[i,r]=(0,n.useState)([]),[s,o]=(0,n.useState)({}),[d,p]=(0,n.useState)(!1),[x,y]=(0,n.useState)(!1),[f,j]=(0,n.useState)(0),[g,w]=(0,n.useState)(10),_=(0,n.useRef)(null),b=e=>{var t;null===(t=_.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},S=e=>{o(e),p(!0)},C=e=>{o(e),y(!0)},k=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:i}=await u.Z.getUsers({page:e,size:g});r(t),j(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{k()},[]);let Z=(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(null==t?void 0:t.includes("user.create"))&&(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>p(!0)})});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(v.w,{value:i,editMode:"row",dataKey:"id",header:Z,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},children:[(0,l.jsx)(m.s,{field:"name",header:"Ad",style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"surname",header:"Soyad",style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"email",header:"Mail",style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"role",body:e=>(0,l.jsx)("div",{children:F(e.role.id)}),header:"Rol",style:{width:"20%"}}),(0,l.jsx)(m.s,{body:e=>(0,l.jsxs)(n.Fragment,{children:[(null==t?void 0:t.includes("user.update"))&&(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>S(e)}),(null==t?void 0:t.includes("user.delete"))&&(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>C(e)})]}),exportable:!1,style:{width:"20%"}})]}),(0,l.jsx)(R.D,{rows:g,totalRecords:f,onPageChange:e=>{k(e.page+1)}}),(0,l.jsx)(c.F,{ref:_}),(0,l.jsx)(h,{user:s,userDeleteDialog:x,setUserDeleteDialog:y,setUsers:r,showSuccess:b}),(0,l.jsx)(B,{user:s,setUsers:r,userEditDialog:d,setUserEditDialog:p,showSuccess:b})]})},N=i(8518),E=i.n(N),T=i(891),A=function(e){let{dialog:t,setDialog:i,showSuccess:n,setServicesTypes:r}=e,{control:s,handleSubmit:o,formState:{errors:d},reset:c}=(0,y.cI)(),m=async e=>{let{name:t,price:l}=e;l=l||0;try{let{data:e}=await u.Z.createServiceType({name:t,price:l});r(t=>[...t,e]),n("Service type has been successfully created"),i(!1),c()}catch(e){console.error(e)}};return(0,l.jsx)(p.V,{visible:t,style:{width:"25rem"},header:"Xidmət n\xf6v\xfc",modal:!0,onHide:()=>i(!1),children:(0,l.jsxs)("form",{onSubmit:o(m),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Ad:"}),(0,l.jsx)(y.Qr,{name:"name",control:s,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!(null==d?void 0:d.name),...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Qiymət:"}),(0,l.jsx)(y.Qr,{name:"price",control:s,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px"},invalid:!!d.price})}}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",type:"submit"})})]})})},W=function(e){let{serviceType:t,deleteDialog:i,setDeleteDialog:r,setServicesTypes:s,showSuccess:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>r(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{s(e=>e.filter(e=>e.id!==(null==t?void 0:t.id)));try{u.Z.deleteServiceType(null==t?void 0:t.id),r(!1),o("Service type has been successfully deleted")}catch(e){console.error(e)}}})]});return(0,l.jsx)(p.V,{visible:i,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>r(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),t&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==t?void 0:t.name}),"?"]})]})})},I=function(e){let{userPermissions:t}=e,[i,r]=(0,n.useState)(),[s,o]=(0,n.useState)(!1),[d,p]=(0,n.useState)([]),[h,y]=(0,n.useState)(0),[f,j]=(0,n.useState)(10),[g,w]=(0,n.useState)(!1),_=(0,n.useRef)(null),b=e=>{var t;null===(t=_.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},S=e=>(0,l.jsx)(T.R,{value:e.value,onValueChange:t=>e.editorCallback(t.value),mode:"currency",currency:"AZN",locale:"de-DE"}),C=e=>(0,l.jsx)(x.o,{type:"text",value:e.value,onChange:t=>e.editorCallback(t.target.value)}),k=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:i}=await u.Z.getServiceTypes({page:e,size:f});p(t),y(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{k()},[]);let B=e=>{r(e),o(!0)},F=(null==t?void 0:t.includes("service_type.create"))&&(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>w(!0)})});return(0,l.jsxs)("div",{children:[(0,l.jsxs)(v.w,{value:d,editMode:"row",dataKey:"id",onRowEditComplete:e=>{let{newData:t}=e,{id:i,name:l,price:n}=t;n=n||0;try{u.Z.updateServiceType({id:i,name:l,price:n});let e={...t,name:l,price:n,id:i},r=d.map(t=>t.id===e.id?e:t);p(r),b("Service type has been successfully updated")}catch(e){console.error(e)}},tableStyle:{minWidth:"50rem"},header:F,style:{marginBottom:"10px"},children:[(0,l.jsx)(m.s,{field:"name",header:"Ad",editor:e=>C(e),style:{width:"40%"}}),(0,l.jsx)(m.s,{field:"price",header:"Qiymət",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.price),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(n)},editor:e=>S(e),style:{width:"40%"}}),(null==t?void 0:t.includes("service_type.update"))&&(0,l.jsx)(m.s,{rowEditor:e=>(null==e?void 0:e.name)!=="Blue Band",headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),(null==t?void 0:t.includes("service_type.delete"))&&(0,l.jsx)(m.s,{body:e=>(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>B(e)})}),exportable:!1,style:{width:"1%"}})]}),(0,l.jsx)(R.D,{rows:f,totalRecords:h,onPageChange:e=>{k(e.page+1)}}),(0,l.jsx)(c.F,{ref:_}),(0,l.jsx)(A,{dialog:g,setDialog:w,showSuccess:b,setServicesTypes:p}),(0,l.jsx)(W,{serviceType:i,deleteDialog:s,setDeleteDialog:o,setServicesTypes:p,showSuccess:b})]})},L=i(9749),O=i(686),M=i(1572),V=i(1395),H=e=>{let{dialog:t,setDialog:i,userPermissions:r,showSuccess:s,getServices:o,service:d,setService:c}=e,[m,v]=(0,n.useState)(),[h,g]=(0,n.useState)(),[w,b]=(0,n.useState)(S.find(e=>0===e.id)),[k,B]=(0,n.useState)(),[R,F]=(0,n.useState)(),[Z,z]=(0,n.useState)(!1),[D,N]=(0,n.useState)(),E=f.Ry().shape({service_types:f.IX().of(f.Ry().shape({id:f.Rx().required()})).required(),client_name:f.Z_().required(),client_phone:r.includes("service.variable.phone")?f.Z_().required():f.Z_(),user_id:r.includes("service.variable.user_id")?f.Rx().required():f.Rx(),reject_comment:(null==k?void 0:k.id)===2&&r.includes("service.variable.reject_comment")?f.Z_().required():f.Z_().nullable()}),{control:A,handleSubmit:W,formState:{errors:I},setValue:L,reset:H}=(0,y.cI)({resolver:(0,j.X)(E)}),Q=async e=>{console.log(e,"payload"),z(!0);try{var t,l;(null==d?void 0:d.id)?await u.Z.updateService({...e,id:d.id,client_phone:null===(t=e.client_phone)||void 0===t?void 0:t.toString().replace(/[\s-]/g,"")}):await u.Z.createService({...e,client_phone:null===(l=e.client_phone)||void 0===l?void 0:l.toString().replace(/[\s-]/g,"")}),s("Service has been successfull created"),o(1),i(!1)}catch(e){console.error(e)}finally{z(!1)}};(0,n.useEffect)(()=>{if(null==d?void 0:d.id){var e,t,i;L("client_name",d.client_name),L("client_phone",d.client_phone),L("user_id",null===(e=d.user)||void 0===e?void 0:e.id),L("service_types",null===(t=d.service_types)||void 0===t?void 0:t.map(e=>({id:e.id}))),L("cash_amount",+d.cash_amount),L("card_amount",+d.card_amount),L("reject_comment",d.reject_comment);let l=()=>0!==d.status?C.find(e=>(null==e?void 0:e.id)===d.status):{id:1,name:"Accepted"};L("status",null===(i=l())||void 0===i?void 0:i.id),B(l),g(null==R?void 0:R.find(e=>{var t;return e.id===(null===(t=d.user)||void 0===t?void 0:t.id)})),v(d.service_types)}},[d,L,R]),(0,n.useEffect)(()=>{(async()=>{if(r.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();F(e)}if(r.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();N(e)}})()},[]);let U=e=>{let t=e.value;v(t),L("service_types",t.map(e=>({id:e.id}))),L("cash_amount",t.reduce((e,t)=>e+ +t.price,0))};return(0,l.jsx)(p.V,{visible:t,modal:!0,onHide:()=>{i(!1),H(),c(void 0),v(void 0),g(void 0),b(S.find(e=>0===e.id)),B(void 0)},header:"Xidmət",style:{maxWidth:"500px",width:"100%"},children:(0,l.jsxs)("form",{onSubmit:W(Q),style:{display:"flex",flexDirection:"column"},children:[r.includes("service.variable.client_name")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"M\xfcştəri adı:"}),(0,l.jsx)(y.Qr,{name:"client_name",control:A,render:e=>{let{field:t}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!I.client_name,...t})}})]}),r.includes("service.variable.phone")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Telefon:"}),(0,l.jsx)(y.Qr,{name:"client_phone",control:A,rules:{minLength:12},render:e=>{let{field:t}=e;return(0,l.jsx)(O.v,{style:{marginBottom:"10px"},id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!I.client_phone,...t})}})]}),r.includes("service.variable.user_id")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Həkim:"}),(0,l.jsx)(y.Qr,{name:"user_id",control:A,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{filter:!0,style:{marginBottom:"10px"},value:h,onChange:e=>{g(e.value),L("user_id",e.value.id)},optionLabel:"full_name",options:R,placeholder:"Doktor se\xe7in",invalid:!!I.user_id})}})]}),r.includes("service.variable.service_type_id")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Xidmət:"}),(0,l.jsx)(y.Qr,{name:"service_types",control:A,render:e=>{let{field:t}=e;return(0,l.jsx)(V.N,{style:{marginBottom:"10px"},value:m,onChange:U,options:D,optionLabel:"name",placeholder:"Xidmət se\xe7in",className:"w-full md:w-20rem",invalid:!!I.service_types})}})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",children:"Nağd:"}),(0,l.jsx)(y.Qr,{name:"cash_amount",control:A,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"},invalid:!!I.cash_amount})}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Pos terminal:"}),(0,l.jsx)(y.Qr,{name:"card_amount",control:A,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),mode:"currency",currency:"AZN",locale:"de-DE",style:{marginBottom:"10px",marginTop:"5px"},invalid:!!I.card_amount})}})]})]}),r.includes("service.variable.reject_comment")&&(null==k?void 0:k.id)===2&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Reject comment:"}),(0,l.jsx)(y.Qr,{name:"reject_comment",control:A,rules:{required:!0},render:e=>{var t;let{field:i}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!I.reject_comment,...i,value:null!==(t=i.value)&&void 0!==t?t:""})}})]}),r.includes("service.variable.status")&&(null==d?void 0:d.id)&&(0,l.jsx)("div",{style:{display:"flex",marginBottom:"10px"},children:C.map(e=>(null==e?void 0:e.id)!==0&&(0,l.jsxs)("div",{children:[(0,l.jsx)(M.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{B(e.value),L("status",e.value.id)},checked:(null==k?void 0:k.id)===(null==e?void 0:e.id)}),(0,l.jsx)("label",{htmlFor:null==e?void 0:e.name,style:{marginRight:"10px",marginLeft:"4px"},children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",disabled:Z,type:"submit"})})]})})},Q=i(7332),U=e=>{let{dialog:t,setDialog:i}=e,[r,s]=(0,n.useState)(new Date),[o,d]=(0,n.useState)([new Date,new Date]),[c,m]=(0,n.useState)([new Date,new Date]);return(0,l.jsx)(p.V,{header:"Reports",visible:t,onHide:()=>{t&&i(!1)},children:(0,l.jsx)("div",{style:{minWidth:"40vw",display:"flex",flexDirection:"column"},children:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:[(0,l.jsx)(Q.f,{value:r,onChange:e=>s(e.value),style:{width:"170px"},showIcon:!0,dateFormat:"dd/mm/yy"}),(0,l.jsx)(a.z,{severity:"success",label:"Export",icon:"pi pi-upload",style:{width:"180px"},onClick:()=>u.Z.getDailyReportExcel(Z(r))})]})})})},P=i(8541),q=i(1857),X=function(e){let{deleteDialog:t,setDeleteDialog:i,service:r,showSuccess:s,getServices:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>i(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{u.Z.deleteService(null==r?void 0:r.id).then(()=>{i(!1),o(1),s("Service has been successfully deleted")}).catch(e=>{console.error(e)})}})]});return(0,l.jsx)(p.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>i(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),r&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==r?void 0:r.client_name}),"?"]})]})})},G=function(e){let{userPermissions:t}=e,[i,r]=(0,n.useState)([]),[s,o]=(0,n.useState)(null),[d,h]=(0,n.useState)(),[y,f]=(0,n.useState)(),[j,w]=(0,n.useState)(),[b,S]=(0,n.useState)(),[k,B]=(0,n.useState)(!1),[F,D]=(0,n.useState)(!1),[N,E]=(0,n.useState)(!1),[A,W]=(0,n.useState)(!1),[I,O]=(0,n.useState)(!1),[M,G,K]=(0,q.Nr)("",400),[Y,J]=(0,n.useState)(1),[$,ee]=(0,n.useState)(),[et,ei,el]=(0,q.Nr)(null,400),[en,er]=(0,n.useState)(),[es,ea]=(0,n.useState)(0),[eo,ed]=(0,n.useState)(0),[ec,eu]=(0,n.useState)(10),[em,ev]=(0,n.useState)(!1),[ep,eh]=(0,n.useState)(),[ex,ey]=(0,n.useState)([new Date,new Date]),ef=(0,n.useRef)(null),ej=(0,n.useRef)(null),eg=e=>{var t;null===(t=ef.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},ew=e=>{w(e),B(!0)},e_=async(e,i)=>{ev(!0);try{let{data:i,meta:l}=await u.Z.getServices({page:e,size:ec,status:null==s?void 0:s.id,from_date:Z(ex[0]),to_date:Z(ex[1]),client_name:G,client_phone:ei,service_types:null==$?void 0:$.map(e=>e.id),user_id:null==b?void 0:b.id});if(r(i),ed(null==l?void 0:l.total),t.includes("service.get_all.total_amount")){let e=await u.Z.getTotalAmount({status:null==s?void 0:s.id,from_date:Z(ex[0]),to_date:Z(ex[1]),client_name:G,client_phone:ei,service_types:null==$?void 0:$.map(e=>e.id),user_id:null==b?void 0:b.id});eh(e)}}catch(e){console.error(e)}finally{var l;ev(!1),i&&(null===(l=ej.current)||void 0===l||l.scrollIntoView({behavior:"smooth"}))}};(0,n.useEffect)(()=>{ex[1]&&e_(Y)},[null==s?void 0:s.name,ex[1],G,ei,null==$?void 0:$.length,b]),(0,n.useEffect)(()=>{(async()=>{if(t.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();f(e)}if(t.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();h(e)}})()},[]);let eb=e=>{w(e),O(!0)},eS=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsxs)("div",{children:[z(t)&&(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>D(e=>!e),style:{marginRight:"20px"}}),(0,l.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>e_(Y)})]}),(0,l.jsxs)("div",{children:[t.includes("service.all_reports")&&!!i.length&&(0,l.jsx)(a.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:()=>{u.Z.getAllReportsExcel({status:null==s?void 0:s.id,from_date:Z(ex[0]),to_date:Z(ex[1]),client_name:G,client_phone:ei,service_types:null==$?void 0:$.map(e=>e.id),user_id:null==b?void 0:b.id})},style:{marginRight:"10px"}}),t.includes("service.daily_report")&&(0,l.jsx)(a.z,{label:"G\xfcn sonu",icon:"pi pi-file-excel",severity:"success",onClick:()=>E(!0),style:{marginRight:"10px"}}),(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>B(!0)})]})]}),eC=e=>{switch(e){case"Rejected":return"danger";case"Accepted":return"success";case"New":return"info"}},ek=e=>(0,l.jsx)(L.V,{value:e.name,severity:eC(e.name)}),eB=(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"ml-2",children:["Nağd: ",null==ep?void 0:ep.cash," AZN"]}),(0,l.jsxs)("div",{className:"ml-2",children:["Kart: ",null==ep?void 0:ep.pos," AZN"]}),(0,l.jsxs)("div",{className:"ml-2",children:["Toplam: ",null==ep?void 0:ep.total," AZN"]})]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(v.w,{value:i,dataKey:"id",header:eS,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},filterDisplay:F?"row":void 0,children:[(0,l.jsx)(m.s,{body:(e,t)=>em?(0,l.jsx)(P.O,{width:"20px"}):(0,l.jsx)("div",{children:eo-t.rowIndex-es}),header:"#",style:{width:"2%"}}),(0,l.jsx)(m.s,{dataType:"date",header:"Tarix",body:e=>em?(0,l.jsx)(P.O,{width:"100px"}):e.created_at.slice(0,-3),style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("service.filter.date")&&(0,l.jsx)(Q.f,{value:ex,onChange:e=>ey(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(m.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("service.filter.client_name")&&(0,l.jsx)(x.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:M,onChange:e=>K(e.target.value)}),showFilterMenu:!1,body:e=>em?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_name})}),t.includes("service.variable.select_phone")&&(0,l.jsx)(m.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("service.filter.client_phone")&&(0,l.jsx)(T.R,{style:{width:"180px"},id:"client_phone",placeholder:"+994 99 999-99-99",value:et,onChange:e=>el(e.value),prefix:"+",useGrouping:!1}),showFilterMenu:!1,body:e=>em?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_phone})}),(0,l.jsx)(m.s,{header:"Xidmət",style:{width:"10%"},showFilterMenu:!1,filter:t.includes("service.variable.service_type_id"),filterElement:()=>t.includes("service.filter.service_type")&&(0,l.jsx)(V.N,{filter:!0,value:$,onChange:e=>{ee(e.value)},options:d,placeholder:"Xidmət se\xe7in",optionLabel:"name",showClear:!0}),body:e=>em?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)("div",{children:e.service_types.map(e=>(0,l.jsx)("div",{children:e.name},e.id))})}),(0,l.jsx)(m.s,{header:"Həkim",body:e=>{var t,i;return em?(0,l.jsx)(P.O,{width:"150px"}):"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},style:{width:"10%"},showFilterMenu:!1,filter:t.includes("service.variable.user_id"),filterElement:()=>t.includes("service.filter.doctor")&&(0,l.jsx)(_.L,{filter:!0,value:b,onChange:e=>{S(e.value)},options:y,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0})}),(0,l.jsx)(m.s,{header:"Məbləğ",body:e=>{var t,i;let n=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.amount),r=null!==(i=null===(t=n.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",s=n.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return em?(0,l.jsx)(P.O,{width:"100px"}):"".concat(s," ").concat(r)},style:{width:"10%"}}),(0,l.jsx)(m.s,{header:"Status",body:e=>{var t;let i=null===(t=C.find(t=>(null==t?void 0:t.id)===e.status))||void 0===t?void 0:t.name;return em?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)(L.V,{onClick:()=>{"Rejected"===i&&(er(e.reject_comment),W(!0))},icon:"Rejected"===i&&"pi pi-info-circle",value:i,severity:eC(i)})},style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("service.filter.status")&&(0,l.jsx)(_.L,{value:s,options:C,onChange:e=>{o(e.value)},itemTemplate:ek,placeholder:"Select one",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"})}),t.includes("service.update")&&(0,l.jsx)(m.s,{body:e=>em?(0,l.jsx)(P.O,{width:"60px"}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>ew(e)}),(null==t?void 0:t.includes("service.delete"))&&(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>eb(e)})]}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)("div",{ref:ej,children:(0,l.jsx)(R.D,{first:es,rows:ec,totalRecords:eo,onPageChange:e=>{ea(e.first),e_(e.page+1,!0),J(e.page+1)}})}),t.includes("service.get_all.total_amount")&&(0,l.jsx)(g.v,{style:{border:"solid #696cff",borderWidth:"0 0 0 6px",marginTop:"20px"},severity:"info",content:eB}),(0,l.jsx)(c.F,{ref:ef}),(0,l.jsx)(H,{userPermissions:t,dialog:k,setDialog:B,showSuccess:eg,service:j,setService:w,getServices:e_}),(0,l.jsx)(U,{dialog:N,setDialog:E}),(0,l.jsx)(p.V,{header:"Reject comment",visible:A,style:{width:"50vw"},onHide:()=>{A&&(W(!1),er(""))},children:(0,l.jsx)("p",{className:"m-0",children:en})}),(0,l.jsx)(X,{service:j,deleteDialog:I,setDeleteDialog:O,showSuccess:eg,getServices:e_})]})},K=i(1398),Y=function(){let[e,t]=(0,n.useState)(),[i,r]=(0,n.useState)([new Date,new Date]),[s,o]=(0,n.useState)(),[d,c]=(0,n.useState)(),[p,h]=(0,n.useState)({}),x=e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.bonus_per_days),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(n)},y=e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.bonus_per_days/150),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(n)},f=async()=>{try{let{data:e}=await u.Z.getBonuses({from_date:Z(i[0]),to_date:Z(i[1]),user_id:null==d?void 0:d.id});t(e)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{i[1]&&f()},[i[1],d]),(0,n.useEffect)(()=>{(async()=>{let{data:e}=await u.Z.getDoctors();o(e)})()},[]);let j=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(Q.f,{value:i,onChange:e=>r(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px",marginRight:"10px"},dateFormat:"dd/mm/yy"}),(0,l.jsx)(_.L,{filter:!0,style:{marginBottom:"10px"},value:d,onChange:e=>{c(e.value)},options:s,placeholder:"Həkim se\xe7in",optionLabel:"full_name",showClear:!0})]}),(0,l.jsx)(a.z,{label:"Export",icon:"pi pi-upload",severity:"success",onClick:()=>{u.Z.getBonusesExcel({from_date:Z(i[0]),to_date:Z(i[1]),user_id:null==d?void 0:d.id})},style:{marginRight:"10px"}})]});return(0,l.jsx)("div",{children:(0,l.jsxs)(v.w,{value:e,editMode:"row",dataKey:"date",style:{marginBottom:"10px"},header:j,expandedRows:p,onRowToggle:e=>{h(e.data)},rowExpansionTemplate:e=>(0,l.jsx)("div",{children:(0,l.jsxs)(v.w,{value:e.bonus_per_days,children:[(0,l.jsx)(m.s,{field:"date",header:"Tarix",style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"bonus_per_days",header:"Məbləğ",body:x,style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"bonus_per_days",header:"Bonus",body:y,style:{width:"90%"}})]})}),children:[(0,l.jsx)(m.s,{expander:e=>e.bonus_per_days.length>0}),(0,l.jsx)(m.s,{body:e=>{var t,i;return"".concat(null===(t=e.user)||void 0===t?void 0:t.name," ").concat(null===(i=e.user)||void 0===i?void 0:i.surname)},header:"Həkim",style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"total_amount",header:"Toplam məbləğ",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.total_amount),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(n)},style:{width:"20%"}}),(0,l.jsx)(m.s,{field:"total_amount",header:"Bonus",body:e=>{var t,i;let l=new Intl.NumberFormat("az-AZ",{style:"currency",currency:"AZN"}).formatToParts(+e.total_amount/150),n=null!==(i=null===(t=l.find(e=>"currency"===e.type))||void 0===t?void 0:t.value)&&void 0!==i?i:"AZN",r=l.filter(e=>"currency"!==e.type).map(e=>e.value).join("");return"".concat(r," ").concat(n)},style:{width:"60%"}})]})})},J=function(e){let{dialog:t,setDialog:i,showSuccess:n,setBookingTimes:r}=e,{control:s,handleSubmit:o,formState:{errors:d},reset:c}=(0,y.cI)(),m=async e=>{let{time:t,reservation_count:l}=e;try{l=l||0;let{data:e}=await u.Z.createBookingTime({reservation_count:l,time:t});r(t=>[...t,e]),n("Rezervasiya saatı uğurla yaradıldı"),i(!1),c()}catch(e){console.error(e)}};return(0,l.jsx)(p.V,{visible:t,style:{width:"25rem"},header:"Rezerv saatı",modal:!0,onHide:()=>i(!1),children:(0,l.jsxs)("form",{onSubmit:o(m),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Saat:"}),(0,l.jsx)(y.Qr,{name:"time",control:s,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(O.v,{style:{marginBottom:"10px"},id:"time",mask:"99:99",invalid:!!d.time,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"surname",children:"Limit:"}),(0,l.jsx)(y.Qr,{name:"reservation_count",control:s,render:e=>{let{field:t}=e;return(0,l.jsx)(T.R,{onBlur:t.onBlur,ref:t.ref,value:(null==t?void 0:t.value)||0,onValueChange:e=>t.onChange(e),style:{marginBottom:"10px"},invalid:!!d.reservation_count})}}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",type:"submit"})})]})})},$=function(e){let{bookingTime:t,deleteDialog:i,setDeleteDialog:r,setBookingTimes:s,showSuccess:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>r(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{s(e=>e.filter(e=>e.id!==(null==t?void 0:t.id)));try{u.Z.deleteBookingTime(null==t?void 0:t.id),r(!1),o("Rezerv saatı silindi")}catch(e){console.error(e)}}})]});return(0,l.jsx)(p.V,{visible:i,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>r(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),t&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==t?void 0:t.time}),"?"]})]})})},ee=function(e){let{userPermissions:t}=e,[i,r]=(0,n.useState)(),[s,o]=(0,n.useState)(!1),[d,p]=(0,n.useState)([]),[h,x]=(0,n.useState)(0),[y,f]=(0,n.useState)(10),[j,g]=(0,n.useState)(!1),w=(0,n.useRef)(null),_=e=>{var t;null===(t=w.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},b=e=>(0,l.jsx)(T.R,{value:e.value,onValueChange:t=>e.editorCallback(t.value)}),S=e=>(0,l.jsx)(O.v,{mask:"99:99",value:e.value,onChange:t=>e.editorCallback(t.target.value)}),C=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{let{data:t,meta:i}=await u.Z.getBookingTimes({page:e,size:y});p(null==t?void 0:t.sort((e,t)=>{let i=e.time.split(":").map(Number),l=t.time.split(":").map(Number);return i[0]!==l[0]?i[0]-l[0]:i[1]-l[1]})),x(null==i?void 0:i.total)}catch(e){console.error(e)}};(0,n.useEffect)(()=>{C()},[]);let k=e=>{r(e),o(!0)},B=(null==t?void 0:t.includes("reservation_time.create"))&&(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>g(!0)})});return(0,l.jsxs)("div",{children:[(0,l.jsxs)(v.w,{value:d,editMode:"row",dataKey:"id",onRowEditComplete:e=>{let{newData:t}=e,{id:i,time:l,reservation_count:n}=t;n=n||0;try{u.Z.updateBookingTime({id:i,time:l,reservation_count:n});let e={...t,time:l,reservation_count:n,id:i},r=d.map(t=>t.id===e.id?e:t);p(r),_("Rezerv saatı yeniləndi")}catch(e){console.error(e)}},tableStyle:{minWidth:"50rem"},header:B,style:{marginBottom:"10px"},children:[(0,l.jsx)(m.s,{field:"time",header:"Saat",editor:e=>S(e),style:{width:"40%"}}),(0,l.jsx)(m.s,{field:"reservation_count",header:"Limit",editor:e=>b(e),style:{width:"40%"}}),(null==t?void 0:t.includes("reservation_time.update"))&&(0,l.jsx)(m.s,{rowEditor:e=>(null==e?void 0:e.time)!=="Blue Band",headerStyle:{width:"10%"},bodyStyle:{textAlign:"center"}}),(null==t?void 0:t.includes("reservation_time.delete"))&&(0,l.jsx)(m.s,{body:e=>(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,text:!0,severity:"danger",onClick:()=>k(e)})}),exportable:!1,style:{width:"1%"}})]}),(0,l.jsx)(R.D,{rows:y,totalRecords:h,onPageChange:e=>{C(e.page+1)}}),(0,l.jsx)(c.F,{ref:w}),(0,l.jsx)(J,{dialog:j,setDialog:g,showSuccess:_,setBookingTimes:p}),(0,l.jsx)($,{bookingTime:i,deleteDialog:s,setDeleteDialog:o,setBookingTimes:p,showSuccess:_})]})},et=e=>{let{dialog:t,setDialog:i,userPermissions:r,showSuccess:s,getBookings:o,booking:d,setBooking:c}=e,[m,v]=(0,n.useState)(),[h,f]=(0,n.useState)(),[j,w]=(0,n.useState)(),[b,S]=(0,n.useState)(),[B,R]=(0,n.useState)(),[F,z]=(0,n.useState)(),[D,N]=(0,n.useState)(!1),[E,T]=(0,n.useState)(),[A,W]=(0,n.useState)(null),{control:I,handleSubmit:L,formState:{errors:V},setValue:H,reset:U}=(0,y.cI)(),P=async e=>{N(!0);try{var t,l;(null==d?void 0:d.id)?await u.Z.updateBooking({client_name:e.client_name,doctor_id:e.doctor_id,id:d.id,client_phone:null===(t=e.client_phone)||void 0===t?void 0:t.toString().replace(/[\s-]/g,""),reservation_date:"".concat(Z(A)," ").concat(null==j?void 0:j.time),status:e.status}):await u.Z.createBooking({client_name:e.client_name,doctor_id:e.doctor_id,client_phone:null===(l=e.client_phone)||void 0===l?void 0:l.toString().replace(/[\s-]/g,""),reservation_date:"".concat(Z(A)," ").concat(null==j?void 0:j.time)}),s("Service has been successfull created"),o(),i(!1)}catch(e){console.error(e)}finally{N(!1)}};return(0,n.useEffect)(()=>{if(null==d?void 0:d.id){var e;H("client_name",d.client_name),H("client_phone",d.client_phone),H("doctor_id",null===(e=d.doctor)||void 0===e?void 0:e.id);let[t,i,l]=d.reservation_date.split("-"),[n,r]=l.split(" "),s=new Date("".concat(n,"-").concat(i,"-").concat(t,"T").concat(r));H("reservation_date",s),W(s),H("status",d.status),S(C.find(e=>(null==e?void 0:e.id)===d.status)),f(null==B?void 0:B.find(e=>{var t;return e.id===(null===(t=d.doctor)||void 0===t?void 0:t.id)}))}},[d,H,B]),(0,n.useEffect)(()=>{(async()=>{if(r.includes("user.input_search")&&(null==j?void 0:j.time)){let{data:e}=await u.Z.getBookingDoctors("".concat(Z(A)," ").concat(null==j?void 0:j.time));R(e)}})()},[null==j?void 0:j.time]),(0,n.useEffect)(()=>{(async()=>{if(r.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();T(e)}})()},[]),(0,n.useEffect)(()=>{(async()=>{if(A){let{data:e}=await u.Z.getHours(Z(A));z(e),(null==d?void 0:d.id)&&(w(null==e?void 0:e.find(e=>e.time===d.reservation_date.split(" ")[1].slice(0,-3))),H("hour",d.reservation_date.split(" ")[1].slice(0,-3)))}})()},[Z(A)]),(0,l.jsx)(p.V,{visible:t,modal:!0,onHide:()=>{i(!1),U(),c(void 0),v(void 0),f(void 0),S(void 0),w(void 0),W(void 0)},header:"Rezerv",style:{maxWidth:"500px",width:"100%"},children:(0,l.jsxs)("form",{onSubmit:L(P),style:{display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"M\xfcştəri adı:"}),(0,l.jsx)(y.Qr,{name:"client_name",control:I,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(x.o,{style:{marginBottom:"10px"},id:"name",invalid:!!V.client_name,...t})}})]}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Telefon:"}),(0,l.jsx)(y.Qr,{name:"client_phone",control:I,rules:{minLength:12,required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(O.v,{style:{marginBottom:"10px"},id:"client_phone",mask:"+999 99 999-99-99",placeholder:"+994 99 999-99-99",invalid:!!V.client_phone,...t})}}),(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"email",children:"Həkim:"}),(0,l.jsx)(y.Qr,{name:"doctor_id",control:I,render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{disabled:!j,filter:!0,style:{marginBottom:"10px"},value:h,onChange:e=>{f(e.value),H("doctor_id",e.value.id)},optionLabel:"full_name",options:B,placeholder:"Doktor se\xe7in",invalid:!!V.doctor_id})}}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("label",{style:{marginBottom:"5px"},htmlFor:"name",children:"Tarix və saat:"}),(0,l.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,l.jsx)(y.Qr,{name:"reservation_date",control:I,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(Q.f,{dateFormat:"dd-mm-yy",invalid:!!V.reservation_date,minDate:new Date,readOnlyInput:!0,value:A,onChange:e=>{W(e.value),H("reservation_date",e.value)}})}}),(0,l.jsx)(y.Qr,{name:"hour",control:I,rules:{required:!0},render:e=>{let{field:t}=e;return(0,l.jsx)(_.L,{disabled:!A,style:{marginBottom:"10px",marginLeft:"5px",marginRight:"10px"},value:j,onChange:e=>{w(e.value),H("hour",e.value.time)},optionLabel:"time",options:F,optionDisabled:e=>!e.active,placeholder:"Saat se\xe7in",invalid:!!V.hour})}}),(null==j?void 0:j.remaining_space)&&(0,l.jsx)(g.v,{style:{border:"solid #111827"},severity:"info",content:(0,l.jsxs)("div",{style:{color:"white"},children:["Yer: ",null==j?void 0:j.remaining_space]})})]})]}),(null==d?void 0:d.id)&&(0,l.jsx)("div",{style:{display:"flex",marginBottom:"10px"},children:null==k?void 0:k.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsx)(M.E,{inputId:null==e?void 0:e.name,name:"status",value:e,onChange:e=>{S(e.value),H("status",e.value.id)},checked:(null==b?void 0:b.id)===(null==e?void 0:e.id)}),(0,l.jsx)("label",{htmlFor:null==e?void 0:e.name,style:{marginRight:"10px",marginLeft:"4px"},children:null==e?void 0:e.name})]},null==e?void 0:e.id))}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,l.jsx)(a.z,{label:"Save",disabled:D,type:"submit"})})]})})},ei=function(e){let{deleteDialog:t,setDeleteDialog:i,booking:r,showSuccess:s,getBookings:o}=e,d=(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{label:"No",icon:"pi pi-times",outlined:!0,onClick:()=>i(!1)}),(0,l.jsx)(a.z,{label:"Yes",icon:"pi pi-check",severity:"danger",onClick:()=>{u.Z.deleteBooking(null==r?void 0:r.id).then(()=>{i(!1),o(),s("Rezerv silindi")}).catch(e=>{console.error(e)})}})]});return(0,l.jsx)(p.V,{visible:t,style:{width:"32rem"},breakpoints:{"960px":"75vw","641px":"90vw"},header:"Confirm",modal:!0,footer:d,onHide:()=>i(!1),children:(0,l.jsxs)("div",{className:"confirmation-content",children:[(0,l.jsx)("i",{className:"pi pi-exclamation-triangle",style:{fontSize:"2rem",marginRight:"10px"}}),r&&(0,l.jsxs)("span",{children:["Are you sure you want to delete ",(0,l.jsx)("b",{children:null==r?void 0:r.client_name}),"?"]})]})})},el=function(e){let{userPermissions:t}=e,[i,r]=(0,n.useState)([]),[s,o]=(0,n.useState)(null),[d,h]=(0,n.useState)(),[y,f]=(0,n.useState)(),[j,g]=(0,n.useState)(),[w,b]=(0,n.useState)(),[S,C]=(0,n.useState)(!1),[B,R]=(0,n.useState)(!1),[F,D]=(0,n.useState)(!1),[N,E]=(0,n.useState)(!1),[A,W,I]=(0,q.Nr)("",400),[O,M]=(0,n.useState)(),[V,H,U]=(0,q.Nr)(null,400),[X,G]=(0,n.useState)(),[K,Y]=(0,n.useState)(1),[J,$]=(0,n.useState)(!1),[ee,el]=(0,n.useState)(),[en,er]=(0,n.useState)([new Date,new Date]),es=(0,n.useRef)(null),ea=(0,n.useRef)(null),eo=e=>{var t;null===(t=es.current)||void 0===t||t.show({severity:"success",summary:"Success",detail:e,life:3e3})},ed=e=>{g(e),C(!0)},ec=async e=>{$(!0);try{let{data:e,meta:t}=await u.Z.getBookings({status:null==s?void 0:s.id,from_date:Z(en[0]),to_date:Z(en[1]),client_name:W,client_phone:H,doctor_id:null==w?void 0:w.id});r(e)}catch(e){console.error(e)}finally{var t;$(!1),e&&(null===(t=ea.current)||void 0===t||t.scrollIntoView({behavior:"smooth"}))}};(0,n.useEffect)(()=>{en[1]&&ec()},[null==s?void 0:s.name,en[1],W,H,null==O?void 0:O.length,w]),(0,n.useEffect)(()=>{(async()=>{if(t.includes("user.input_search")){let{data:e}=await u.Z.getDoctors();f(e)}if(t.includes("service_type.input_search")){let{data:e}=await u.Z.getInputServices();h(e)}})()},[]);let eu=e=>{g(e),E(!0)},em=(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsxs)("div",{children:[z(t)&&(0,l.jsx)(a.z,{type:"button",icon:"pi pi-filter-slash",label:"Filter",onClick:()=>R(e=>!e),style:{marginRight:"20px"}}),(0,l.jsx)(a.z,{icon:"pi pi-refresh",rounded:!0,raised:!0,onClick:()=>ec()})]}),(0,l.jsx)(a.z,{label:"Əlavə et",icon:"pi pi-plus",onClick:()=>C(!0)})]}),ev=e=>{switch(e){case"Ləğv":return"danger";case"Gəldi":return"success";case"G\xf6zlənilir":return"info"}},ep=e=>(0,l.jsx)(L.V,{value:e.name,severity:ev(e.name)});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(v.w,{value:i,dataKey:"id",header:em,tableStyle:{minWidth:"50rem"},style:{marginBottom:"10px"},filterDisplay:B?"row":void 0,paginator:!0,rows:10,children:[(0,l.jsx)(m.s,{body:(e,t)=>J?(0,l.jsx)(P.O,{width:"20px"}):(0,l.jsx)("div",{children:(null==i?void 0:i.length)-(null==t?void 0:t.rowIndex)}),header:"#",style:{width:"2%"}}),(0,l.jsx)(m.s,{dataType:"date",header:"Tarix",body:e=>J?(0,l.jsx)(P.O,{width:"100px"}):e.reservation_date.slice(0,-3),style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("reservation.filter.date")&&(0,l.jsx)(Q.f,{value:en,onChange:e=>er(e.value),selectionMode:"range",readOnlyInput:!0,hideOnRangeSelection:!0,style:{width:"220px"},dateFormat:"dd/mm/yy"})}),(0,l.jsx)(m.s,{field:"client_name",header:"M\xfcştəri",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("reservation.filter.client_name")&&(0,l.jsx)(x.o,{placeholder:"Ad ilə axtarış",style:{width:"160px"},value:A,onChange:e=>I(e.target.value)}),showFilterMenu:!1,body:e=>J?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_name})}),(0,l.jsx)(m.s,{field:"client_phone",header:"Telefon",style:{width:"10%"},filter:!0,filterElement:()=>t.includes("reservation.filter.client_phone")&&(0,l.jsx)(T.R,{style:{width:"180px"},id:"client_phone",placeholder:"+994 99 999-99-99",value:V,onChange:e=>U(e.value),prefix:"+",useGrouping:!1}),showFilterMenu:!1,body:e=>J?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)("div",{children:e.client_phone})}),(0,l.jsx)(m.s,{header:"Status",body:e=>{var t;let i=null===(t=k.find(t=>(null==t?void 0:t.id)===e.status))||void 0===t?void 0:t.name;return J?(0,l.jsx)(P.O,{width:"100px"}):(0,l.jsx)(L.V,{value:i,severity:ev(i)})},style:{width:"10%"},showFilterMenu:!1,filter:!0,filterElement:()=>t.includes("reservation.filter.status")&&(0,l.jsx)(_.L,{value:s,options:k,onChange:e=>{o(e.value)},itemTemplate:ep,placeholder:"Select one",className:"p-column-filter",showClear:!0,style:{minWidth:"10rem"},optionLabel:"name"})}),(0,l.jsx)(m.s,{header:"Həkim",body:e=>{var t,i,n;return J?(0,l.jsx)(P.O,{width:"150px"}):(null===(t=e.doctor)||void 0===t?void 0:t.name)&&"".concat(null===(i=e.doctor)||void 0===i?void 0:i.name," ").concat(null===(n=e.doctor)||void 0===n?void 0:n.surname)},style:{width:"10%"},showFilterMenu:!1}),t.includes("reservation.update")&&(0,l.jsx)(m.s,{body:e=>J?(0,l.jsx)(P.O,{width:"60px"}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(a.z,{icon:"pi pi-pencil",rounded:!0,text:!0,severity:"secondary",style:{marginRight:"10px"},onClick:()=>ed(e)}),(null==t?void 0:t.includes("reservation.delete"))&&(0,l.jsx)(a.z,{icon:"pi pi-trash",rounded:!0,outlined:!0,text:!0,severity:"danger",onClick:()=>eu(e)})]}),exportable:!1,style:{width:"10%"}})]}),(0,l.jsx)(c.F,{ref:es}),(0,l.jsx)(et,{userPermissions:t,dialog:S,setDialog:C,showSuccess:eo,booking:j,setBooking:g,getBookings:ec}),(0,l.jsx)(p.V,{header:"Reject comment",visible:F,style:{width:"50vw"},onHide:()=>{F&&(D(!1),G(""))},children:(0,l.jsx)("p",{className:"m-0",children:X})}),(0,l.jsx)(ei,{booking:j,deleteDialog:N,setDeleteDialog:E,showSuccess:eo,getBookings:ec})]})},en=function(){var e,t;let[i,m]=(0,n.useState)(),[v,p]=(0,n.useState)(0),h=(0,d.useRouter)(),x=null==i?void 0:i.role.permissions.map(e=>null==e?void 0:e.name);(0,n.useEffect)(()=>{localStorage.getItem("token")||h.push("/login")},[h]),(0,n.useEffect)(()=>{(async()=>{try{var e;let{data:t}=await u.Z.getSelfInfo();(null==t?void 0:null===(e=t.role)||void 0===e?void 0:e.id)===5&&p(1),m(t)}catch(e){console.error(e)}})()},[]);let y=(0,n.useRef)(null);return(0,n.useEffect)(()=>{y.current&&(0,K.x)(y.current)}),(null==i?void 0:i.name)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("header",{className:E().header,children:[(0,l.jsxs)("div",{className:E().info,children:[(0,l.jsx)(s.q,{shape:"circle",label:null==i?void 0:null===(e=i.name[0])||void 0===e?void 0:e.toUpperCase(),style:{backgroundColor:"#60A5FA"}}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{children:"".concat(null==i?void 0:i.name," ").concat(null==i?void 0:i.surname)}),(0,l.jsx)("small",{children:F(null==i?void 0:null===(t=i.role)||void 0===t?void 0:t.id)})]})]}),(0,l.jsx)(a.z,{icon:"pi pi-sign-out",severity:"info","aria-label":"User",onClick:()=>{localStorage.clear(),h.push("/login")}})]}),(0,l.jsx)(r.i,{}),(0,l.jsx)("main",{className:E().main,children:(0,l.jsxs)(o.f,{activeIndex:v,children:[(null==x?void 0:x.includes("service.get_all"))&&(0,l.jsx)(o.x,{header:"Xidmətlər",children:(0,l.jsx)(G,{userPermissions:x})}),(null==x?void 0:x.includes("reservation.get_all"))&&(0,l.jsx)(o.x,{header:"Rezervlər",children:(0,l.jsx)(el,{userPermissions:x})}),(null==x?void 0:x.includes("reservation_time.get_all"))&&(0,l.jsx)(o.x,{header:"Rezerv saatları",children:(0,l.jsx)(ee,{userPermissions:x})}),(null==x?void 0:x.includes("service_type.get_all"))&&(0,l.jsx)(o.x,{header:"Xidmət n\xf6vləri",children:(0,l.jsx)(I,{userPermissions:x})}),(null==x?void 0:x.includes("user.get_all"))&&(0,l.jsx)(o.x,{header:"İstifadə\xe7ilər",children:(0,l.jsx)(D,{userPermissions:x})}),(null==x?void 0:x.includes("service.bonus_reports"))&&(0,l.jsx)(o.x,{header:"Bonuslar",children:(0,l.jsx)(Y,{})})]})}),(0,l.jsx)(c.F,{ref:y})]}):(0,l.jsx)(l.Fragment,{})}},1398:function(e,t,i){"use strict";i.d(t,{W:function(){return o},x:function(){return s}});var l=i(2126),n=i(6463);let r=null,s=e=>{r=e},a=l.Z.create({baseURL:"https://api.nargizestetik.az/api"});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),e}),a.interceptors.response.use(e=>null==e?void 0:e.data,async e=>{var t,i,l;return(e.response&&(null===(t=e.response)||void 0===t?void 0:t.data.message)==="USER_NOT_AUTHORIZED"?(localStorage.clear(),(0,n.redirect)("/login")):(e.response&&(null===(i=e.response)||void 0===i?void 0:i.data.message)||e.message)&&r&&r.show({severity:"error",summary:"Error",detail:(null===(l=e.response)||void 0===l?void 0:l.data.message)||e.message,life:3e3}),e&&e.response)?Promise.reject(e):Promise.reject()});let o=a},8518:function(e){e.exports={header:"page_header__oRW75",info:"page_info__8WZDv",main:"page_main__nw1Wk"}}},function(e){e.O(0,[851,651,754,567,891,971,23,744],function(){return e(e.s=1542)}),_N_E=e.O()}]);